hacer instructivo arquitectura
control shift r eclipse
alt shift r nb

estandares bd D:\Willy\tools\oracle
Estándares_base_de_datos_ V_ 1 1
Estándares Java_v2

D:\Willy\estandares arquitectura\sunafil

D:\Willy\aplicativos\$_LibroReclamaciones\WS_LIBRORECLAM\si.libroReclamaciones\WebContent\WEB-INF\lib


4 canales hasta 220 rele 20 soles
http://www.electrotec.pe/categoria/modulos/producto/modulo-rele-de-4-canales/
ethernet shield 40 soles
http://peruelectronico.com/index.php?id_product=65&controller=product
servo futaba 12 soles
http://peruelectronico.com/index.php?id_product=9&controller=product
dallas temperatura 5 soles
http://peruelectronico.com/index.php?id_product=25&controller=product
PIR 12 soles
http://peruelectronico.com/index.php?id_product=54&controller=product


eclipse plugin MyBatis generator
http://mybatis.googlecode.com/svn/sub-projects/generator/trunk/eclipse/UpdateSite
download with htttrack and put into droppins ide folder

hacer un post acerca de mybatis generator

download MBG with htttrack and put into droppins eclipse ide folder
new dinamic web project
new other mybatis generator configuration file
modify config file
include log4j, mybatis and driver into the project
generate mybatis artifact with right click on generatorConfig.xml
create mybatisfactory java file, properties file with cnx and mybatis-config.xml including properties vars
or integrate copying model, map and client packages into an existing project 
to do an unit test:

package com.demo.unitest;

import java.io.Reader;
import java.io.Serializable;
import java.util.Iterator;
import java.util.List;

import org.apache.ibatis.io.Resources;
import org.apache.ibatis.session.SqlSession;
import org.apache.ibatis.session.SqlSessionFactory;
import org.apache.ibatis.session.SqlSessionFactoryBuilder;

import com.demo.client.SitbTdocideMapper;
import pe.gob.sunafil.libroreclam.mybatis.comun.MyBatisConnectionFactory;
import com.demo.model.SitbTdocide;
import com.demo.model.SitbTdocideExample;

public class test  {

	public test()
	{		
	}

	public static void main (String [] args) throws Exception {
		
		SqlSession sqlSession = MyBatisConnectionFactory.getSqlSessionFactory().openSession();
		  
		SitbTdocideExample example = new SitbTdocideExample();
		example.createCriteria().andDescripcionIsNotNull();
		try {
			SitbTdocideMapper mapper = sqlSession.getMapper (SitbTdocideMapper. class);
		List <SitbTdocide> allRecords = mapper.selectByExample(example);
		for (SitbTdocide s: allRecords){
		System.out.println (":::"+s.getDescripcion());}
		} finally {
		sqlSession.close ();
		}
	}
		
}



http://mybatis.github.io/generator/running/running.html
http://mybatis.github.io/generator/afterRunning.html
http://mybatis.github.io/generator/generatedobjects/results.html
http://mybatis.github.io/generator/generatedobjects/exampleClassUsage.html
http://mybatis.github.io/generator/generatedobjects/extendingExampleClass.html




MARCADORES DESARROLLO

http://stackoverflow.com/questions/10028770/html5-websocket-vs-long-polling-vs-ajax-vs-webrtc-vs-server-sent-events
https://www.quora.com/Long-polling-versus-WebSocket-over-unreliable-connection-which-one-is-better
https://www.websocket.org/quantum.html
https://www.pubnub.com/blog/2015-01-05-websockets-vs-rest-api-understanding-the-difference/
http://www.html5rocks.com/en/tutorials/websockets/basics/
http://socket.io/
http://ahoj.io/nodejs-and-websocket-simple-chat-tutorial
http://code.tutsplus.com/tutorials/using-nodejs-and-websockets-to-build-a-chat-service--net-34482
http://mybatis.github.io/generator/
http://mybatis.github.io/generator/running/running.html
http://mybatis.github.io/generator/afterRunning.html
http://mybatis.github.io/generator/generatedobjects/results.html
http://stackoverflow.com/questions/5482554/how-to-install-plugin-for-eclipse-from-zip
http://stackoverflow.com/questions/19720102/mybatis-generator-whats-the-best-way-to-separate-out-auto-generated-and-han
http://www.javacodegeeks.com/2012/11/mybatis-tutorial-crud-operations-and-mapping-relationships-part-1.html
http://www.javawebdevelop.com/2717684/
http://stackoverflow.com/questions/192456/setting-a-log-file-name-to-include-current-date-in-log4j



http://jexcelapi.sourceforge.net/
https://poi.apache.org/spreadsheet/quick-guide.html#CellContents
http://stackoverflow.com/questions/192456/setting-a-log-file-name-to-include-current-date-in-log4j
http://stackoverflow.com/questions/6358836/log4j-how-to-configure-simplest-possible-file-logging


Recuperar fecha actual de la bd
Definir reglas de validación para cada campo
Verificar existencia de archivos
Verificar numero de libros disponibles en cada archivo
Verificar numero de columnas minimas para convertir
Verificar si el valor de cada celda es el indicado

Hacer UI web incluyendo login
Hacer log por dia
Definir si los archivos origen o destino estarán en un FTP o en carpetas del mismo webserver

cacevedo@sunafil.gob.pe

http://www.codejava.net/java-se/networking/ftp/java-ftp-file-download-tutorial-and-example
http://www.codejava.net/java-se/networking/ftp/java-ftp-file-upload-tutorial-and-example

logueo consideraciones
la nueva pass no debe ser ninguna de las 3 anteriores
pass caduca cada 4 meses
5 dias antes de q caduque el sistema visa al loguear
link cambiar pass

sunafil
trabajo$123

paso 1 subir (controles fileupload)
paso 2 generar trama para BN (controles en vez de convertir generar trama y en vez de dos botones download uno solo para archivo unificado)

--obtener ruta absoluta del faces context, ya no se usara pues resouces mantiene cache
--borrar cache al bajar archivo, se mantuvo la carpeta import y export fuera del proyecto
--usar fecha de oracle
--Conectar a la base de datos con NOTIFSYS
--Utilizar el código de sistema del Sistema de Notificaciones
tomar en cuenta estado de xls

simintra1
simintra1$

10444362851

administrador de perfiles (entrar con IE)

en prod
http://inspecciones.mintra.gob.pe:8080/inspecciones/ 
http://seguridad.mintra.gob.pe:8080/si.seguridad/ ESTE NO! DEL MINTRA
http://appweb.sunafil.gob.pe/si.seguridad/  SIIT clave 123
con usuario SIIT trabajo$123

en pruebas
http://sol.trabajo.gob.pe/si.seguridad/

SIIT
123


Z:\Documentos\Levantamiento de Información\PIDE

para enviar mensaje no automatizado
chat id fraternidad -17115412
fakelicious -1003072
https://api.telegram.org/bot132272285:AAEKchLpqpPvo7oewm8ogKEY_R9cpk1N07o/sendMessage?chat_id=-17115412&text=patx es gaytorade
https://api.telegram.org/bot132272285:AAEKchLpqpPvo7oewm8ogKEY_R9cpk1N07o/sendMessage?chat_id=-1003072&text=culpa%20de%20tom



https://api.telegram.org/bot132272285:AAEKchLpqpPvo7oewm8ogKEY_R9cpk1N07o/setWebhook?url=https://c4-python-bot.appspot.com/webhook
https://api.telegram.org/bot132272285:AAEKchLpqpPvo7oewm8ogKEY_R9cpk1N07o/setWebhook?url=https://patxbot-1125.appspot.com/webhook



para ver los chat id primero limpiar webhook y luego consultar get updates
https://api.telegram.org/bot132272285:AAEKchLpqpPvo7oewm8ogKEY_R9cpk1N07o/setWebhook?url=
https://api.telegram.org/bot132272285:AAEKchLpqpPvo7oewm8ogKEY_R9cpk1N07o/getUpdates



patxbot id
72534512:AAHPPf3Z1TZQIrIDfshdsdq6EEfzp-z3q3w
https://api.telegram.org/bot72534512:AAHPPf3Z1TZQIrIDfshdsdq6EEfzp-z3q3w/sendMessage?chat_id=-17115412&text=necesito%20cambio%20de%20aceite

chatid de trivia sin tot -578673
https://api.telegram.org/bot72534512:AAHPPf3Z1TZQIrIDfshdsdq6EEfzp-z3q3w/sendMessage?chat_id=-578673&text=sajino juelix

trivia normal -43550284
alexa priv chat 150823524

https://api.telegram.org/bot72534512:AAHPPf3Z1TZQIrIDfshdsdq6EEfzp-z3q3w/sendMessage?chat_id=150823524&text=por q me escribes hija mia
https://api.telegram.org/bot72534512:AAHPPf3Z1TZQIrIDfshdsdq6EEfzp-z3q3w/sendMessage?chat_id=-43550284&text=saludos desde el mas alla caminantes

envio de sticker a trivia sin ot
https://api.telegram.org/bot72534512:AAHPPf3Z1TZQIrIDfshdsdq6EEfzp-z3q3w/sendSticker?chat_id=-578673&sticker=BQADAgADLgADiqODBf1jRZquJTPvAg


timestamp from telegram date to human readable
http://www.epochconverter.com/

www.telegram.me/IngressMemes
https://api.telegram.org/bot72534512:AAHPPf3Z1TZQIrIDfshdsdq6EEfzp-z3q3w/sendMessage?chat_id=-578673&text=borrego suscribete al canal de memes www.telegram.me/IngressMemes

enviar locacion a fraternidad
https://api.telegram.org/bot72534512:AAHPPf3Z1TZQIrIDfshdsdq6EEfzp-z3q3w/sendLocation?chat_id=-17115412&longitude=-77.213298&latitude=-12.081322
https://api.telegram.org/bot72534512:AAHPPf3Z1TZQIrIDfshdsdq6EEfzp-z3q3w/sendLocation?chat_id=-17115412&longitude=-77.213298&latitude=-12.081322

kike chat id 113627522 con patxbot
milenio oscuro chat id 107792137 con patxbot
tania mango as 122228914 con patxbot
alex fabian 127299894 con patxbot
dominic14 106951132 con patxbot
https://api.telegram.org/bot72534512:AAHPPf3Z1TZQIrIDfshdsdq6EEfzp-z3q3w/sendMessage?chat_id=107792137&text=hola milechi
https://api.telegram.org/bot72534512:AAHPPf3Z1TZQIrIDfshdsdq6EEfzp-z3q3w/sendSticker?chat_id=107792137&sticker=BQADAgADLgADiqODBf1jRZquJTPvAg
https://api.telegram.org/bot72534512:AAHPPf3Z1TZQIrIDfshdsdq6EEfzp-z3q3w/sendSticker?chat_id=107792137&sticker=BQADAgADVwoAAlOx9wP23-Wb3vQT2wI
https://api.telegram.org/bot72534512:AAHPPf3Z1TZQIrIDfshdsdq6EEfzp-z3q3w/sendMessage?chat_id=122228914&text=hola mango
https://api.telegram.org/bot72534512:AAHPPf3Z1TZQIrIDfshdsdq6EEfzp-z3q3w/sendSticker?chat_id=122228914&sticker=BQADAgADLgADiqODBf1jRZquJTPvAg
https://api.telegram.org/bot72534512:AAHPPf3Z1TZQIrIDfshdsdq6EEfzp-z3q3w/sendMessage?chat_id=106951132&text=hola dominic14

1701 ANEXO WILLIAM CALLE LLAMAR DESPUES DE CONFIRMACION DE INGRID BAJA DE MEF

programar solo tipos VENCIDO Y PENDIENTE

E10
importe en segundo
estado
tercer campo siempre con 10 digitos

cambiar nombre de app
cuando cierra sesion gracias por utilizar gen tramas en vez de adm de siit

content type application/json para un mismo dominio
http://www.mkyong.com/java/how-do-convert-java-object-to-from-json-format-gson-api/
content type application/javascript para crossdomain cubriendolo con un nombre de funcion js como getData(<json content>)
http://compscigradgirl.blogspot.pe/2011/11/json-versus-jsonp-with-gson-example.html



en local:
poner esp como server y consumir highcharts en modo embed remoto
en la pagina generada poner refresh 10 al menos

conectado a wifi:
esp como cliente que consuma cada cierto tiempo una pagina con var get psando la medicion de un sensor
la pagina get destino almacena la medicion en una bd
se lee la medicion guardada en bd en vez de usar random usar ajax con json p para leer cambios en bd

bot:
q bot se conecte a otro servicio rest al estilo simsimi para leer la ultima medicion de arduino

Estimado, sobre tu consulta tienes que coordinar con la Sra. Enma, PROFESIONAL ESPECIALISTA EN SERVICIOS SOCIAL de la ORH, ella te va a indicar sobre el procedimiento.



--por c mensaje un salto de linea
--intentar poner nombre desc de libro en msj, caso contrario poner numeracion correcta en msj
--validar repetidos por c libro y luego total (validacion actual)
--no mostrar el mensaje: "[archivo].xlsx fue subido." hasta validar todo ok (añadir flag boolean hayError en validator) si hay error mostrar msjs con salto de linea
--borrar  Correo electrónico contacto@sunafil.gob.pe de footer
--reemplazar pkg nombre siitadm por gentrama

http://ws1.pide.gob.pe/SMSService?wsdl
replace endpoind request by
http://ws1.pide.gob.pe/SMSService
Credenciales SMS service pide
Key: 01BEF2B50A686AAB1317B27BB77B86425F7A9DCF
Login: H8lEB3lWfaWk
response true indica confirmación

11 35
03 05

Everything I Own
Bread
Lady
Kenny Rogers
(Love Is) Thicker Than Water
Andy Gibb
If I Can't Have You
Yvonne Elliman
Love's Theme
Barry White
Stumblin' In
Suzi Quatro & Chris Norman
Reunited
Peaches And Herb
Magic
Olivia Newton John
When You're In Love With A Beautiful Woman
Dr. Hook
What A Fool Believes
The Doobie Brothers
Fallin' In Love In The Summertime
Tina Charles
Against All Odds (Take A Look At Me Now)
Phil Collins
(Our Love) Don't Throw It All Away
Andy Gibb
Girl You'll Be A Woman Soon
The Biddu Orchestra
Rock Your Baby
George McCrae


notificaciones
apunta a bd en vitual box
actas de 5 SIRES se notifican a empleador/trabajador
notif de acta (proc sancionador) y antes es proc inspectivo
regresa con resultado de la notif si lo han dejado bajo puerta, etc
si fue notificado en bd de siit el estado del acta se cambia a 4 q es notificado, si no es notificado se genera otra cedula(depende del acta como un detalle)
siit 123

TIPO RESOLUCION n.v_codtmov = '05'
SITBC_MULTA
CAMPOS 
N_NUMDEP
N_CODUA
V_FLAGACT




select rs.*,rs.v_anhoressanc, rs.n_numdepdes, m.n_numdep, m.n_codua,
substr(rs.v_anhoressanc,-2)||n_codua||'ZZ?'||substr(rs.v_numresolsanc,-4)
from siit.iltbc_resolucionsanc rs, sitbc_multaua m
where m.n_numdep=rs.n_numdepdes








identificar cedula de resolucion de primera instancia

((!$F{V_CODMULTA}.equals("0") && $F{N_NUMDEPCED}.equals("462")) ? Boolean.TRUE : Boolean.FALSE)





select rs.*, rs.v_numresolsanc,rs.v_anhoressanc, substr(rs.v_anhoressanc,-2)||m.n_codua||'00'||substr(rs.v_numresolsanc,-4)
from siit.iltbc_resolucionsanc rs, sitbc_multaua m
where m.n_numdep=rs.n_numdepdes and
rs.v_numresolsanc = '0000000010'
                    and rs.v_anhoressanc  = 2014
                    and rs.n_numdepdes    = 193
					


/***

select n.v_numced || '-' || n.v_anionot as v_numced,n.v_flgtipent as v_flgtipent,
       case 
           when n.v_codtmov ='04' then
                n.v_numexp || '-' || n.v_numanoexp
           when n.v_codtmov ='05' then
               (select aci.v_numordeninsp || '-' || aci.v_anho               
                  from siit.iltbc_resolucionsanc rs,
                       siit.iltbc_expsancionador es,
                       siit.iltbc_actainspecci aci
                 where es.v_numexpsanc       = rs.v_numexpsanc
                       and es.v_anho         = rs.v_anho
                       and es.n_numdep       = rs.n_numdep
                       and aci.v_numactinsp  = es.v_numactinsp
                       and aci.v_anhoacta    = es.v_anhoacta
                       and aci.n_numdep      = es.n_numdep
                       and rs.v_numresolsanc = n.v_codmov
                       and rs.v_anhoressanc  = n.v_anomov
                       and rs.n_numdepdes  = n.v_numdepmov--modif
                 ) 
                 
            when n.v_codtmov ='06' then               
                 (select t.v_numordeninsp|| '-' ||t.v_anhooi from SITB_PROVEIDOS t
                   WHERE T.V_NUMPROVEIDO=n.v_codmov
                         AND T.V_ANHO =n.v_anomov
                         AND T.N_NUMDEP=n.v_numdepmov 
                  )               
      
           else ' '
       end orden_insp,
       
       case
         when n.v_codtmov ='04' then
              n.v_codmov || '-' || n.v_anomov
         when n.v_codtmov ='05' then
            (select aci.v_numactinsp || '-' || aci.v_anhoacta
              from siit.iltbc_resolucionsanc rs,
                   siit.iltbc_expsancionador es,
                   siit.iltbc_actainspecci aci
             where es.v_numexpsanc       = rs.v_numexpsanc
                   and es.v_anho         = rs.v_anho
                   and es.n_numdep       = rs.n_numdep
                   and aci.v_numactinsp  = es.v_numactinsp
                   and aci.v_anhoacta    = es.v_anhoacta
                   and aci.n_numdep      = es.n_numdep
                   and rs.v_numresolsanc = n.v_codmov
                   and rs.v_anhoressanc  = n.v_anomov
                   and rs.n_numdepdes    = n.v_numdepmov --modif
             )
           when n.v_codtmov ='06' then   
             nvl((select a.v_numactinsp || '-' || a.v_anhoacta
                   from  sitb_proveidos p,
                     siit.iltbc_actainspecci  a
                     where p.v_numordeninsp=a.v_numordeninsp
                     and p.v_anhooi=a.v_anho
                     and p.n_numdepoi=a.n_numdep
                     and p.v_numproveido=n.v_codmov
                     and p.v_anho=n.v_anomov
                     and p.n_numdep=n.v_numdepmov
      ---PORQ SE SUPONE QUE TIENE EL ACTA
               and p.v_numactinsp=a.v_numactinsp
                     and p.v_anhoacta=a.v_anhoacta
                     and p.n_numdepacta=a.n_numdep
                     --and a.v_numactinsp='0000003136'
                     --and a.v_numactinsp='0000000423'
               --and a.v_numactinsp='0000001732'
               --and a.v_numactinsp='0000003395'
         --and a.v_numactinsp='0000001709'
                     ),' - ')
             
         else ' '
         
       end acta_inf,
       
       
       
       
       case
          when n.v_codtmov ='04' then
              '-'
          when n.v_codtmov ='05'  then
              n.v_numexp || '-' ||  n.v_numanoexp
          when n.v_codtmov ='06' then               
             (select t.v_numexpsanc|| '-' ||t.v_anhoexpsanc from SITB_PROVEIDOS t
               WHERE T.V_NUMPROVEIDO=n.v_codmov
               AND T.V_ANHO =n.v_anomov
               AND T.N_NUMDEP=n.v_numdepmov )  
          else ' '
       end expsanc,
       
       case
        when n.v_codtmov ='04' then
              '-'
         when n.v_codtmov ='05' then
              n.v_codmov  || '-' || n.v_anomov
         else ' '
       end resolsanc,
    
       case
              when n.v_codtmov ='01' then
              'MULTAS'
              when n.v_codtmov ='02' then
              'AUDIENCIA'
              when n.v_codtmov ='03' then
              'EXPEDIENTE POR TIPO DE DOCUMENTO'
              when n.v_codtmov ='04' then
              'ACTA DE INFRACCION'
              when n.v_codtmov ='05' then
              'RESOLUCIÓN'
              when n.v_codtmov ='06' then
              'PROVEIDO'
              else
              'Otros'
      end tipo_movimiento,
      
      case 
          when n.v_codemp is not null then e.v_razsoc --||' RUC:'||e.v_codemp
          when n.v_codtra is not null then t.v_apepattra||' '||t.v_apemattra||', '||t.v_nomtra --||' DNI:'||n.v_codtra
          else 'N/A'
      end nomb_dest,
      
      case                 
      
          when v_tipoemp = '2' and n.v_casilla is null then 
                 t1.v_abrvia||' '||c.v_dircentro||
                 ' NRO.'||c.v_numcentro ||                 
                 decode(c.v_numpiso,null,'','-','',', Piso. '||c.v_numpiso)||
                 decode(c.v_intcentro,null,'','-','',', INT. '||c.v_intcentro)||
                 decode(c.v_mancentro,null,'','-','',', MZ. '||c.v_mancentro)||
                 decode(c.v_lotcentro,null,'','-','',', LT. '||c.v_lotcentro)||
                 decode(c.v_urbcentro,null,'','-','','SIN ZONA','',', '||z.v_deszon||' '||c.v_urbcentro)||
                 decode(c.v_kimcentro,null,'','-','',', KM. '||c.v_kimcentro)||
                 ', '|| (select prov.v_despro||'-'||dis.v_desdis from sitb_distrito dis,sitb_provincia prov where dis.v_coddep = c.v_coddep and dis.v_codpro = c.v_codpro and dis.v_coddis = c.v_coddis and prov.v_coddep=dis.v_coddep and prov.v_codpro=dis.v_codpro)
      
         
          when v_tipoemp is null then 
            case 
              when t.v_codtra is not null and n.v_casilla is null then 
                     t3.v_abrvia||' '||td.v_dirtra||
                     --', NRO.'||td.v_nropuetra ||
                     decode(td.v_nropuetra,null,', NRO -',', NRO. '||td.v_nropuetra)||
         decode(td.v_nropistra,null,'','-','',', Piso. '||td.v_nropistra)||
                     decode(td.v_inttra,null,'','-','',', INT. '||td.v_inttra)||
                     decode(td.v_mantra,null,'','-','',', MZ. '||td.v_mantra)||
                     decode(td.v_lottra,null,'','-','',', LT. '||td.v_lottra)||
                     decode(td.v_urbtra,null,'','-','',', Urb. '||td.v_urbtra)||
                     decode(td.v_kimtra,null,'','-','',', KM. '||td.v_kimtra)||
          decode(td.v_grupo,null,'','-','',', Grupo. '||td.v_grupo)||
                     decode(td.v_sector,null,'','-','',', Sector. '||td.v_sector)||
                     decode(td.v_dirref,null,'','-','',', REF.: '||td.v_dirref)||
                     ', ' || (select prov.v_despro||'-'||dis.v_desdis from sitb_distrito dis,sitb_provincia prov where dis.v_coddep = td.v_coddep and dis.v_codpro = td.v_codpro and dis.v_coddis = td.v_coddis and prov.v_coddep=dis.v_coddep and prov.v_codpro=dis.v_codpro)

              else ''              
            end            
          else ''
      end direccion,
      
      case
                    when n.v_codresced is not null then n.v_codresced                   
                    else '00'
      end v_codresced,
       case              
                when n.v_codtmov ='04' then
                     case 
                          when (
                                select a.n_codtipact 
                                from siit.iltbc_actainspecci a 
                                where a.v_numactinsp=n.v_codmov 
                                AND a.v_anhoacta=n.v_anomov 
                                and a.n_numdep=n.v_numdepmov --modif
                                and a.v_codzon=n.v_codzon 
                                and a.v_codreg=n.v_codreg) = 1 then 'INFRACCION DE NORMAS SOCIOLABORALES'
                                
                          when (
                                select a.n_codtipact 
                                from siit.iltbc_actainspecci a 
                                where a.v_numactinsp=n.v_codmov 
                                AND a.v_anhoacta=n.v_anomov 
                                and a.n_numdep=n.v_numdepmov --modif
                                and a.v_codzon=n.v_codzon 
                                and a.v_codreg=n.v_codreg) = 2 then 'INFRACCION A LA LABOR INSPECTIVA'
                          else ''
                     end
                when n.v_codtmov ='05' then
                     case 
                          when (
                            select aci.n_codtipact
                              from siit.iltbc_resolucionsanc rs,
                                   siit.iltbc_expsancionador es,
                                   siit.iltbc_actainspecci aci
                             where es.v_numexpsanc       = rs.v_numexpsanc
                                   and es.v_anho         = rs.v_anho
                                   and es.n_numdep       = rs.n_numdep
                                   and aci.v_numactinsp  = es.v_numactinsp
                                   and aci.v_anhoacta    = es.v_anhoacta
                                   and aci.n_numdep      = es.n_numdep
                                   and rs.v_numresolsanc = n.v_codmov
                                   and rs.v_anhoressanc  = n.v_anomov
                                   and rs.n_numdepdes    = n.v_numdepmov --modif
                          ) = 1 then 'INFRACCION DE NORMAS SOCIOLABORALES'
                          when (
                            select aci.n_codtipact
                              from siit.iltbc_resolucionsanc rs,
                                   siit.iltbc_expsancionador es,
                                   siit.iltbc_actainspecci aci
                             where es.v_numexpsanc       = rs.v_numexpsanc
                                   and es.v_anho         = rs.v_anho
                                   and es.n_numdep       = rs.n_numdep
                                   and aci.v_numactinsp  = es.v_numactinsp
                                   and aci.v_anhoacta    = es.v_anhoacta
                                   and aci.n_numdep      = es.n_numdep
                                   and rs.v_numresolsanc = n.v_codmov
                                   and rs.v_anhoressanc  = n.v_anomov
                                   and rs.n_numdepdes    = n.v_numdepmov  --modif
                          ) = 2 then 'INFRACCION A LA LABOR INSPECTIVA'
                          else ''
                     end

                else '- '
       end tipo_acta,
       case
                when n.v_codtmov ='04' then
                     to_char(
                              (select a.d_fecacta 
                               from siit.iltbc_actainspecci a 
                               where a.v_numactinsp=n.v_codmov 
                               AND a.v_anhoacta=n.v_anomov 
                               and a.n_numdep=n.v_numdepmov --modif
                               and a.v_codzon=n.v_codzon 
                               and a.v_codreg=n.v_codreg),'dd/mm/yyyy')
                when n.v_codtmov ='05' then
                     to_char((
                             select rs.d_fecresol --modif
                              from siit.iltbc_resolucionsanc rs,
                                   siit.iltbc_expsancionador es
                             where es.v_numexpsanc       = rs.v_numexpsanc
                                   and es.v_anho         = rs.v_anho
                                   and es.n_numdep       = rs.n_numdep
                                   and rs.v_numresolsanc = n.v_codmov
                                   and rs.v_anhoressanc  = n.v_anomov
                                   and rs.n_numdepdes    = n.v_numdepmov
                     ),'dd/mm/yyyy')
                     
                when n.v_codtmov ='06' then     
                
                to_char((select t.d_fecproveido from sitb_proveidos t
                where T.V_NUMPROVEIDO=n.v_codmov
           AND T.V_ANHO =n.v_anomov
           AND T.N_NUMDEP=n.v_numdepmov),'dd/mm/yyyy')
                     
                     
                else ' '
       end fec_doc,
       
       n.v_codmov "nro_de_mov",
       n.v_anomov "anio_de_mov",
       n.n_numfol "nro_folios",

  case 
         when n.v_codtmov = 06 then 
       (SELECT t.v_numesc FROM
           SITB_PROVEIDOS T 
           WHERE T.V_NUMPROVEIDO=n.v_codmov
           AND T.V_ANHO =n.v_anomov
           AND T.N_NUMDEP=n.v_numdepmov)
         else  '' 
       end as  n_numesc,
       
        case 
         when n.v_codtmov = 06 then          
         (to_char((SELECT T.D_FECESC FROM
           SITB_PROVEIDOS T 
           WHERE T.V_NUMPROVEIDO=n.v_codmov
           AND T.V_ANHO =n.v_anomov
           AND T.N_NUMDEP=n.v_numdepmov),'dd/mm/yyyy') )
         else '' 
        end   as d_fecesc,  
       
  case when n.v_casilla is null then '-'
            when n.v_casilla is not null then  n.v_casilla
       end v_casilla,
  case when n.v_sede is null then '-'
            when n.v_sede is not null then  n.v_sede
       end v_sede,
   '- ' || n.v_docanexa "v_docanexa",
       dep.v_desdepabr "cod_dependencia",
               
       dep.n_numdep,
       --dep.v_coddep,-------------------------------------------
       --dep.v_desdep,

  case when to_char(n.d_fecreg,'YYYYMMDD') >= '20100826' then
                 dep.v_coddep
            ELSE dep.v_coddepant
       end as v_coddep,
       
       case when to_char(n.d_fecreg,'YYYYMMDD') >= '20100826' then
                 dep.v_desdep
            ELSE dep.v_desdepant
       end as v_desdep,  

       n.v_casilla,
       n.v_sede,
 case 
     when n.v_codtmov ='05' then
          (select substr(rs.v_anhoressanc,3)||''||lpad(rs.n_numdepdes,'4','0')||''||substr(rs.v_numresolsanc,7)
              from siit.iltbc_resolucionsanc rs
              where rs.v_numresolsanc = n.v_codmov
                    and rs.v_anhoressanc  = n.v_anomov
                    and rs.n_numdepdes    = n.v_numdepmov 
             )
      when n.v_codtmov='06'  and
          (SELECT t.v_codtprov FROM SITB_PROVEIDOS T 
           WHERE T.V_NUMPROVEIDO=n.v_codmov
           AND T.V_ANHO =n.v_anomov
           AND T.N_NUMDEP=n.v_numdepmov) ='05' then
           
       (select substr(rs.v_anhoressanc,3)||''||lpad(rs.n_numdepdes,'4','0')||''||substr(rs.v_numresolsanc,7)
        from siit.iltbc_resolucionsanc rs, SITB_PROVEIDOS t        
        where  rs.v_numresolsanc=t.v_numresolsanc
         and   rs.v_anhoressanc=t.v_anhoressanc
         and   rs.n_numdepdes=t.n_numdepressanc
         and   t.v_numproveido = n.v_codmov
         and   t.v_anho  = n.v_anomov
         and   t.n_numdep = n.v_numdepmov)
      else
       '0'
      end v_codmulta,
  n_numdepced,
  
  case

              when n.v_codtmov ='05' then
              (select substr(rs.v_anhoressanc,-2)||m.n_codua||'00'||substr(rs.v_numresolsanc,-4)
from siit.iltbc_resolucionsanc rs, sitbc_multaua m
where m.n_numdep=rs.n_numdepdes and
rs.v_numresolsanc = n.v_codmov
                    and rs.v_anhoressanc  = n.v_anomov
                    and rs.n_numdepdes    = n.v_numdepmov
)
              else
              ''
      end MULTASUNAFIL,n.v_codmov,n.v_anomov,n.v_numdepmov
       
  from simvd_notificacion n,
       sitb_empleador e,
       siit.iltbc_centrolaboral c,       
       sitb_tipvia t1,       
       sitb_trabajador t,
       sitb_trabdireccion td,
       sitb_tipvia t3,
       sitb_zona z,
       tdtbc_dependencia dep      --modif
 where n.v_codemp = c.v_codemp(+)
       and n.n_codsuc = c.n_numcorr(+)
       and c.v_codtvia = t1.v_codtvia(+)
       and c.v_codzona=z.v_codzona(+)
       and n.v_codtra = td.v_codtra(+)
       and n.n_correl = td.n_correl(+)
       and td.v_codtvia = t3.v_codtvia(+)
       
       and n.v_codemp = e.v_codemp(+)
       and n.v_codtra = t.v_codtra(+)
       and n.n_numdepdes = dep.n_numdep(+) --add       
       and n.v_codreg = $P{v_codregion}
       and n.v_codzon = $P{v_codzon}
       and n.v_codsis = $P{v_codsis}
       and n.n_numdepced = $P{n_numdepced}
       and n.v_numced = $P{v_numced}
       and n.v_anionot = $P{v_anionot}

***/					



It's never enough to say I'm sorry
It's never enough to say I care
But I'm caught between what you wanted from me
And knowing that if I give that to you
I might just disappear

Nobody wins when everyone's losing

[Chorus:]
It's like one step forward and two steps back
No matter what I do you're always mad
And I, I can't change your mind
I know it's like trying to turn around on a one way street
I can't give you what you want
And it's killing me
And I, I'm starting to see
Maybe we're not meant to be

It's never enough to say I love you
No, it's never enough to say I try
It's hard to believe
That's theres no way out for you and me
And it seems to be the story of our lives

Nobody wins when everyone's losing

[Chorus]

There's still time to turn this around
You could be building this up instead of tearing it down
But I keep thinking
Maybe it's too late

[Chorus]

It's like one step forward and two steps back
No matter what I do you're always mad
And I, baby I'm sorry to see
Maybe we're not meant to be


--
Mine, immaculate dream made breath and skin
I've been waiting for you
Signed, with a home tattoo,
Happy birthday to you was created for you

(can not forgive from falling apart at the seams
Can not believe you're taking my heart to pieces)

Oh, it'll take a little time,
Might take a little crime
To come undone now

[Prechorus:]
We'll try to stay blind
To the hope and fear outside
Hey child, stay wilder than the wind
And blow me into cry

[Chorus:]
Who do you need, who do you love
When you come undone?
Who do you need, who do you love
When you come undone?

Words, playing me deja vu
Like a radio tune I swear I've heard before
Chill, is it something real
Or the magic I'm feeding off your fingers?

(can not forgive from falling apart at the seams
Can not believe you're taking my heart to pieces)

Lost, in a snow filled sky,
we'll make it alright
To come undone now

[Prechorus]
[Chorus]

(can not forgive from falling apart)
Who do you need, who do you love
When you come undone?
(can not forgive from falling apart)
Who do you need, who do you love?
(can not forgive from falling apart)
Who do you love
When you come undone?
(can not forgive from falling apart)



para sistema de tramite 

sdelgado
sunafil$123(pass maestra o 123)

tdmvc_registro(cabecera)
tdmvd_registro(detalle buscar persona en esta tabla)
tdmvd_regtramite(acciones)

tdtbc_dependencia
tdtbc_perxdep(persona por dependencia)


select t.*, t.rowid from tdmvc_registro t where v_numhoja like '0000004683' and v_tiporigen in ('I')


select td.*,td.n_numperdest from tdmvc_registro t, tdmvd_registro td 
where t.v_numhoja like '0000004683' and t.v_tiporigen in ('I')
and t.v_numanoreg=td.v_numanoreg
and t.n_numdep=td.n_numdep
and t.n_numtipodoc=td.n_numtipodoc
and t.v_numreg=td.v_numreg


--consulta de documentos asignados de una persona entre rango de fechas raul la torre
--dias desde recepcion se calcula V_DIASASIGNADOS-V_DIASRECEP
select
                 v_desapepat || v_desapemat || v_desnombres,
                   to_char(tdmvd_registro.n_numperdest) as "N_NUMPERDEST",
                   tdtbc_dependencia.v_desdep as "V_DESDEPORI",
                   (prtbc_personal.v_desapepat||' '||
                   prtbc_personal.v_desapemat||' '||
                   prtbc_personal.v_desnombres) as "V_NOMPERSONAL",
                   to_char(tdmvd_registro.d_fectramite,'dd/mm/yyyy') as "D_FECTRAMITE",
                   to_char(tdmvd_registro.d_fecrecep,'dd/mm/yyyy') as "D_FECRECEP",
                   to_char(tdmvd_registro.d_fecatendido,'dd/mm/yyyy') as "D_FECATENDIDO",
                       to_char(
                       nvl(( SELECT
                       to_date(sysdate,'dd/mm/yyyy') - ADD_MONTHS(to_date(tdmvd_registro.d_fectramite,'dd/mm/yyyy'),
                       TRUNC( MONTHS_BETWEEN( to_date(tdmvd_registro.d_fectramite,'dd/mm/yyyy'),
                       to_date(sysdate,'dd/mm/yyyy') ) ))  V_DIA
                       FROM dual),0)) as "V_DIASASIGNADOS",
   to_char(to_number(trunc(to_date(tdmvd_registro.d_fecrecep,'dd/mm/yyyy'))- trunc(to_date(tdmvd_registro.d_fectramite,'dd/mm/yyyy')) )-
                     (select count(*) from simintra1.sitb_feriados t
       where t.d_fecfer 
       between to_date(tdmvd_registro.d_fectramite,'DD/MM/YYYY') 
       and to_date(tdmvd_registro.d_fecrecep,'DD/MM/YYYY')))
                      as "V_DIASRECEP", 
                    tdmvd_registro.v_flgasig as "V_FLGASIG",
                    tdtbc_tipodoctramite.v_codtipodoc||'-'||tdmvc_registro.v_numreg||'-'||tdmvc_registro.v_numanoreg||'-'||tdtbc_dependencia.v_coddep as "V_DOCUMENTO",
                    tdmvc_registro.v_numhoja ||' - '||tdmvc_registro.v_aniohoja as "V_NUMHOJA",
                    tdmvc_registro.v_desasunto as "V_DESASUNTO"
              from tdmvc_registro,
                   tdmvd_registro,
                   prtbc_personal,
                   tdtbc_dependencia,
                   tdtbc_tipodoctramite
              where tdmvc_registro.v_numanoreg = tdmvd_registro.v_numanoreg
                    and tdmvc_registro.n_numdep = tdmvd_registro.n_numdep
                    and tdmvc_registro.n_numtipodoc = tdmvd_registro.n_numtipodoc
                    and tdmvc_registro.v_numreg = tdmvd_registro.v_numreg
                    and prtbc_personal.v_codpersonal = lpad(tdmvd_registro.n_numperdest,'8','0')
                    and tdtbc_dependencia.n_numdep = tdmvc_registro.n_numdep
                    and tdtbc_tipodoctramite.n_numtipodoc = tdmvd_registro.n_numtipodoc
                    
                    and tdmvd_registro.n_numdep=458
                    and tdmvd_registro.v_flgasig = 'S'
                    and decode(N_NUMPERDEST,'-1','-1',tdmvd_registro.n_numperdest)='10300662'
                    and to_date(tdmvd_registro.d_fectramite,'dd/mm/yy') between to_date('30/11/15','dd/mm/yy') and to_date('16/12/15','dd/mm/yy')
                    and tdmvd_registro.d_fecatendido is null
               order by  tdmvd_registro.n_Numperdest,tdmvd_registro.v_numreg desc;
			   
			   
VST_DOCSASIGNADOS			   

VST_DOCSATENDIDOS



--CONSULTA DOCUMENTOS ATENDIDOS
select
						 v_desapepat || v_desapemat || v_desnombres,
                         to_char(tdmvd_registro.n_numperdest) as "N_NUMPERDEST",
                         tdtbc_dependencia.v_desdep as "V_DESDEPORI",
                         (prtbc_personal.v_desapepat||' '||  prtbc_personal.v_desapemat||' '||prtbc_personal.v_desnombres) as "V_NOMPERSONAL",
                         to_char(tdmvd_registro.d_fectramite,'dd/mm/yyyy hh24:mi:ss') as "D_FECTRAMITE",
                         to_char(tdmvd_registro.d_fecrecep,'dd/mm/yyyy hh24:mi:ss') as "D_FECRECEP",
                         to_char(tdmvd_registro.d_fecatendido,'dd/mm/yyyy hh24:mi:ss') as "D_FECATENDIDO",

                              to_char(to_date(tdmvd_registro.d_fecatendido,'dd/mm/yyyy')- to_date(tdmvd_registro.d_fectramite,'dd/mm/yyyy')
              -f_diasnohabiles(to_char(tdmvd_registro.d_fectramite,'dd/mm/yyyy'),to_char(tdmvd_registro.d_fecatendido,'dd/mm/yyyy')))
               as "V_DIASASIGNADOS",

                 to_char(to_date(tdmvd_registro.d_fecrecep,'dd/mm/yyyy')- to_date(tdmvd_registro.d_fectramite,'dd/mm/yyyy')
              -f_diasnohabiles(to_char(tdmvd_registro.d_fectramite,'dd/mm/yyyy'),to_char(tdmvd_registro.d_fecrecep,'dd/mm/yyyy')))
               as "V_DIASRECEP",

                         tdmvd_registro.v_flgasig as "V_FLGASIG",
                         tdtbc_tipodoctramite.v_codtipodoc||'-'||tdmvc_registro.v_numreg||'-'||tdmvc_registro.v_numanoreg||'-'||tdtbc_dependencia.v_coddep as "V_DOCUMENTO",
                         tdmvc_registro.v_numhoja ||' - '||tdmvc_registro.v_aniohoja as "V_NUMHOJA",
                         tdmvc_registro.v_desasunto as "V_DESASUNTO"
               from
                         tdmvc_registro,
                         tdmvd_registro,
                         prtbc_personal,
                         tdtbc_dependencia,
                         tdtbc_tipodoctramite

               where     tdmvc_registro.v_numanoreg = tdmvd_registro.v_numanoreg
                         and tdmvc_registro.n_numdep = tdmvd_registro.n_numdep
                         and tdmvc_registro.n_numtipodoc = tdmvd_registro.n_numtipodoc
                         and tdmvc_registro.v_numreg = tdmvd_registro.v_numreg
                         and prtbc_personal.v_codpersonal = lpad(tdmvd_registro.n_numperdest,'8','0')
                         and tdtbc_dependencia.n_numdep = tdmvc_registro.n_numdep
                         and tdtbc_tipodoctramite.n_numtipodoc = tdmvd_registro.n_numtipodoc

                         --and tdmvd_registro.n_numdep=P_N_NUMDEP
                         and tdmvd_registro.v_flgasig = 'S'
                         --and decode(N_NUMPERDEST,'-1','-1',tdmvd_registro.n_numperdest)='10300662'
                         and tdmvd_registro.d_fecatendido is not null

               order by  tdmvd_registro.n_Numperdest,tdmvd_registro.v_numreg desc;
			   
			   
			   
			   
-------------------------------------------			   
CREATE OR REPLACE VIEW VST_DOCSASIGNADOS AS
select
                 v_desapepat ||' '|| v_desapemat ||' '|| v_desnombres COLABORADOR,
                   to_char(tdmvd_registro.n_numperdest) as "N_NUMPERDEST",
                   tdtbc_dependencia.v_desdep as "V_DESDEPORI",
                   (prtbc_personal.v_desapepat||' '||
                   prtbc_personal.v_desapemat||' '||
                   prtbc_personal.v_desnombres) as "V_NOMPERSONAL",
                   to_char(tdmvd_registro.d_fectramite,'dd/mm/yyyy') as "D_FECTRAMITE",
                   to_char(tdmvd_registro.d_fecrecep,'dd/mm/yyyy') as "D_FECRECEP",
                   to_char(tdmvd_registro.d_fecatendido,'dd/mm/yyyy') as "D_FECATENDIDO",
                       to_char(
                       nvl(( SELECT
                       to_date(sysdate,'dd/mm/yyyy') - ADD_MONTHS(to_date(tdmvd_registro.d_fectramite,'dd/mm/yyyy'),
                       TRUNC( MONTHS_BETWEEN( to_date(tdmvd_registro.d_fectramite,'dd/mm/yyyy'),
                       to_date(sysdate,'dd/mm/yyyy') ) ))  V_DIA
                       FROM dual),0)) as "V_DIASASIGNADOS",
   to_char(to_number(trunc(to_date(tdmvd_registro.d_fecrecep,'dd/mm/yyyy'))- trunc(to_date(tdmvd_registro.d_fectramite,'dd/mm/yyyy')) )-
                     (select count(*) from simintra1.sitb_feriados t
       where t.d_fecfer
       between to_date(tdmvd_registro.d_fectramite,'DD/MM/YYYY')
       and to_date(tdmvd_registro.d_fecrecep,'DD/MM/YYYY')))
                      as "V_DIASRECEP",
                    tdmvd_registro.v_flgasig as "V_FLGASIG",
                    tdtbc_tipodoctramite.v_codtipodoc||'-'||tdmvc_registro.v_numreg||'-'||tdmvc_registro.v_numanoreg||'-'||tdtbc_dependencia.v_coddep as "V_DOCUMENTO",
                    tdmvc_registro.v_numhoja ||' - '||tdmvc_registro.v_aniohoja as "V_NUMHOJA",
                    tdmvc_registro.v_desasunto as "V_DESASUNTO"
              from tdmvc_registro,
                   tdmvd_registro,
                   prtbc_personal,
                   tdtbc_dependencia,
                   tdtbc_tipodoctramite
              where tdmvc_registro.v_numanoreg = tdmvd_registro.v_numanoreg
                    and tdmvc_registro.n_numdep = tdmvd_registro.n_numdep
                    and tdmvc_registro.n_numtipodoc = tdmvd_registro.n_numtipodoc
                    and tdmvc_registro.v_numreg = tdmvd_registro.v_numreg
                    and prtbc_personal.v_codpersonal = lpad(tdmvd_registro.n_numperdest,'8','0')
                    and tdtbc_dependencia.n_numdep = tdmvc_registro.n_numdep
                    and tdtbc_tipodoctramite.n_numtipodoc = tdmvd_registro.n_numtipodoc

                    --and tdmvd_registro.n_numdep=458
                    and tdmvd_registro.v_flgasig = 'S'
                    --and decode(N_NUMPERDEST,'-1','-1',tdmvd_registro.n_numperdest)='10300662'
                    --and to_date(tdmvd_registro.d_fectramite,'dd/mm/yy') between to_date('30/11/15','dd/mm/yy') and to_date('16/12/15','dd/mm/yy')
                    and tdmvd_registro.d_fecatendido is null
               order by  tdmvd_registro.n_Numperdest,tdmvd_registro.v_numreg desc;

-------------------------------------------
create or replace view vst_docsatendidos as
select
             v_desapepat ||' '|| v_desapemat ||' '|| v_desnombres COLABORADOR,
                         to_char(tdmvd_registro.n_numperdest) as "N_NUMPERDEST",
                         tdtbc_dependencia.v_desdep as "V_DESDEPORI",
                         (prtbc_personal.v_desapepat||' '||  prtbc_personal.v_desapemat||' '||prtbc_personal.v_desnombres) as "V_NOMPERSONAL",
                         to_char(tdmvd_registro.d_fectramite,'dd/mm/yyyy hh24:mi:ss') as "D_FECTRAMITE",
                         to_char(tdmvd_registro.d_fecrecep,'dd/mm/yyyy hh24:mi:ss') as "D_FECRECEP",
                         to_char(tdmvd_registro.d_fecatendido,'dd/mm/yyyy hh24:mi:ss') as "D_FECATENDIDO",

                              to_char(to_date(tdmvd_registro.d_fecatendido,'dd/mm/yyyy')- to_date(tdmvd_registro.d_fectramite,'dd/mm/yyyy')
              -f_diasnohabiles(to_char(tdmvd_registro.d_fectramite,'dd/mm/yyyy'),to_char(tdmvd_registro.d_fecatendido,'dd/mm/yyyy')))
               as "V_DIASASIGNADOS",

                 to_char(to_date(tdmvd_registro.d_fecrecep,'dd/mm/yyyy')- to_date(tdmvd_registro.d_fectramite,'dd/mm/yyyy')
              -f_diasnohabiles(to_char(tdmvd_registro.d_fectramite,'dd/mm/yyyy'),to_char(tdmvd_registro.d_fecrecep,'dd/mm/yyyy')))
               as "V_DIASRECEP",

                         tdmvd_registro.v_flgasig as "V_FLGASIG",
                         tdtbc_tipodoctramite.v_codtipodoc||'-'||tdmvc_registro.v_numreg||'-'||tdmvc_registro.v_numanoreg||'-'||tdtbc_dependencia.v_coddep as "V_DOCUMENTO",
                         tdmvc_registro.v_numhoja ||' - '||tdmvc_registro.v_aniohoja as "V_NUMHOJA",
                         tdmvc_registro.v_desasunto as "V_DESASUNTO"
               from
                         tdmvc_registro,
                         tdmvd_registro,
                         prtbc_personal,
                         tdtbc_dependencia,
                         tdtbc_tipodoctramite

               where     tdmvc_registro.v_numanoreg = tdmvd_registro.v_numanoreg
                         and tdmvc_registro.n_numdep = tdmvd_registro.n_numdep
                         and tdmvc_registro.n_numtipodoc = tdmvd_registro.n_numtipodoc
                         and tdmvc_registro.v_numreg = tdmvd_registro.v_numreg
                         and prtbc_personal.v_codpersonal = lpad(tdmvd_registro.n_numperdest,'8','0')
                         and tdtbc_dependencia.n_numdep = tdmvc_registro.n_numdep
                         and tdtbc_tipodoctramite.n_numtipodoc = tdmvd_registro.n_numtipodoc

                         --and tdmvd_registro.n_numdep=P_N_NUMDEP
                         and tdmvd_registro.v_flgasig = 'S'
                         --and decode(N_NUMPERDEST,'-1','-1',tdmvd_registro.n_numperdest)='10300662'
                         and tdmvd_registro.d_fecatendido is not null

               order by  tdmvd_registro.n_Numperdest,tdmvd_registro.v_numreg desc;


--resumen
select colaborador, d_fecatendido from
(select * from vst_docsasignados
union all
select * from vst_docsatendidos)
order by colaborador
--


--ASIGNADOS
select colaborador, count(*)||' asignados' des from
(select * from vst_docsasignados
union all
select * from vst_docsatendidos)
group by colaborador
order by colaborador


--RECEPCIONADOS
select colaborador, count(*)||' recepcionados' des from
(select * from vst_docsasignados
union all
select * from vst_docsatendidos)
where d_fecrecep is not null
group by colaborador
order by colaborador


--ATENDIDOS
select colaborador, count(*)||' atendidos' des from
(select * from vst_docsasignados
union all
select * from vst_docsatendidos)
where d_fecatendido is not null
-+
group by colaborador
order by colaborador



Z:\Documentos\Inventario
--TNS NAMES ORA LOCATION
D:\app\DESARROLLO\product\11.2.0\client_1\network\admin



--quitar check anexar
--alinear y estirar horizontal campos
--agregar textarea observaciones
--reducir tamaño txt tupa y txt año de documento y de pop up referenciar
--autocomplete de dependencias al estilo tramite interno
--centrar botones de accion
--quitar icono llave y puerta de menu principal para estandarizar

--0.- Estandarización de la pantalla de Login con fondo blanco con borde, logo y con el Nombre del Sistema de Tramite Documentario
--1.- Cuando ingresa TUPA 55, mostrar descripción,requisitos y dependencia
--2.- En Documento de Referencia, Richard proporcionar un ejemplo con un registro a fin de que seleccione y se muestre en la pantalla principal la referencia seleccionada.
--3.- Ejemplo de lista de requisitos
Solicitud según Formato
Copia de D.N.I
Declaración Jurada...
Entre el TUPA y la Dependencia
--4.- La estandarización de las imágenes de los botones (Richard pasar imágenes)
--5.- La caja de fecha poner un poco mas pequeno en las bandejas de Registradas, Observadas y No presentadas.

--1. Estandarizar login, imagen a la izquierda con logo, derecha nombre de aplicativo y usuario y contraseña.
--2. Cuando es DNI, PASAPORTE Y CE que se visualice Apellido Paterno, Apellido Materno y Nombres y que desaparezca Razón Social.
--3. Cuando es RUC que se visualice Razón Social y que desaparezca  Apellido Paterno, Apellido Materno y Nombres.
--4. Poner Requisito y ver como se ve con el fielset, si esa muy cargado no va.


--0.- Poner NUEVO REGISTRO Nro. de Folios, va arriba de asunto
--1.- Poner el botón imprimir en NUEVO REGISTRO y colocar el pdf de observado
--2.- En las bandejas Observado y No Presentado poner sólo Fecha
--3.- En la bandeja observados poner numero 0000000935-2016
--4.- En la bandeja observados poner fecha 28/12/2015
--5.- En la bandeja observados poner en la columna Opción: poner un icono pequeno de impresor y al dar clic q se muestre el pdf de observado
--6.- En la bandeja No presentados poner el mismo registro de la bandeja Observados solo que la fecha va ser 31/12/2015
--7.- En la bandeja No presentados poner en la columna Opción: poner un icono pequeño de impresor y al dar clic q se muestre el pdf de Acta de no presentado
--    Icono carpeta en menuitems




soporte 1804
arduino 300



--Reporte Por Procedimiento
--Fecha inicio, Fecha fin, Origen(Todos, 9 intendencias), Procedimiento(todos, 1, 2, 55, etc), Estado(todos, Registrado, Observado, No Presentado)
--Reporte Por Usuario
--Fecha inicio, Fecha fin, Origen(Todos, 9 intendencias)

--completar lista de origenes con data
--hacer funcionar boton subsanar de lista de observados
--cambiar por nuevas imagenes
--colocar la dependencia logueada

al 05/01/2016
BBVA
total tarj 3,326.21
total prestamo 18,539.22
______________
total 21865.43

post sobre json y jsonp y como hacer un ws rest con un servlet

declarar sunat

https://medium.com/startup-lesson-learned/5-reasons-why-my-iot-startup-failed-19c5537e61e1#.nkon0msqw
Lumos created smart electrical switches that used machine learning. It wanted the light and appliance switches to learn about the owner’s preferences — an IoT play. The founders said they “overestimated machine learning and underestimated efforts in converting a prototype to fully functional hardware product.” Toward the end the founders panicked and tried to pivot their way out of a crisis, which didn’t work. In the blog 5 Reasons Why My IoT Startup Failed founder Yash Kotak said: “Building a successful startup is hard. Building a hardware startup is 10 times harder.”
Learning: Work on something where you are either an expert or a top user. If not, become an expert/top user.
Try to be a drug for your customer instead of being a vitamin.
Building a prototype is the easiest part of building a hardware startup. The real challenge comes in product design, production engineering, manufacturing, distribution and marketing/sales. And you need to have friends in China.



--cambios primera reunión
--1. hacer caja de busqueda analoga a tramite interno (nro y año)
--2. cambiar anexar por asociar a una hoja de ruta 
--3. eliminar referenciar pero dejar el boton lupa de busqueda(como parte de asociar) y al seleccionar en pop up llenar hoja de ruta asociada y la dependencia(se asume q no va tupa)
--4. en campo tupa poner lupa y pop up con filtro codigo y descripcion de tupa, las columnas serian codigo, descripcion
--5. en remitente añadir 3 combos ubigeo mas la direccion
--6. añadir columna hoja de ruta en pop up de asociar, en encabezados completar palabra dep por dependencia
--7. en las 3 bandejas añadir campos de filtro: hoja de ruta, tipo doc remitente y nro de doc remitente
--8. caso cuando tenga todos los requisitos chekeados imprimir hoja de ruta
--9. en las tres bandejas la opción imprimir hoja de ruta
--10. en reporte por procedimiento incluir la intendencia como columna y todo en una sola tabla
--11. en las 3 bandejas añadir accion de adjuntar pdf scaneado












--1.- Poner el estilo blue Sky en las 02 cajas añadidas.
--2.- Hacer un ejemplo de búsqueda y que te lleve a la bandeja que le corresponda.
--3.- en el ejemplo de referencia poner los años a 2015
--4.- Cambiar Región por Departamento
--5.- En el combo hay que describir los departamentos
--6.- Reducir el tamaño vertical de campo dirección
--7.- Cambiar tipo de documento por Categoría de Documento 
--8.- Cuando la Categoría de Documento es <> a Trámite T.U.P.A, se debe mostrar el Nro de Documento.
--9.- Buscar poner al lado derecho de las bandejas
--10.- La opción de adjuntar hay que ampliar
--11.- Quitar la cabecera del pdf de Hoja de Ruta
--12.- En depedencia que diga en vez de SIRE Sub Intendencia de Actuación Inspectiva
--13.- Cuando se asocia a una hoja de ruta y selecciona la Hoja de Ruta 30, debe cargar la dependencia Intendencia de lima Metropolitana 
--14.- Descripción de Tupas
--Verificación de cierre de centro de trabajo.
--Verificación de despido arbitrario.
--Verificación de la disminución deliberada  y reiterada en el rendimiento de las labores
--Observación del trabajador a la liquidación de la compensación por tiempo de servicios
--Otorgamiento de la constancia de cese
--15.- En la ventana de búsqueda de TUPA, hay que poner Código en ves de Nro de Tupa y Descripción, primero debe ir la descripción y luego el código 
--16.- En Categoría de Documento añadir Trámite T.U.P.A y es ahi donde debe visualizarce los campos de TUPA





--1.- reducir caja de tupa el tamaño horizontal
--2.- Desaparecer los requisitos cuando no es Tramite Tupa
--3.- En categoria de documentos añadir
--- Sobre cerrado
--- Procesos de Selección
--- Información ORH
--- Queja por defecto de tramitación
--4.- PDF de hoja de ruta
--Observado
--EL DOCUMENTO TIENE REQUISITOS TUPA INCUMPLIDOS
--No Presentado
--EL DOCUMENTO SE ENCUENTRA EN ESTADO NO PRESENTADO.
--5.- en las bandejas cambiar origen por Destino:
--Registrados : Oficina de Recursos Humanos
--Observados y No presentados: Sub Intendencia de Actuación Inspectiva
--6.- En las bandejas 
--En tipo de documento hay q poner remitente: 
--Documento se unen con tipo de documento y solo se pondrá la sigla del tipo documento
--SL-0000000365-2015




--0.-añadir consulta/busqueda antes de reportes
--1.-alinear desde TUPA con Asociar hoja de ruta, solo se deja como esta categoria de documento
--2.-Borde requisitos




--1.- Debajo Asociar hoja de Ruta debe ir Tipo de Documento y las opciones son Oficio, Informe, Memorandum, carta, Solicitud, Invitación y Sobre cerrado.
--2.- al costado de Tipo de Documento debe ir el Nro. de Documento.
--3.- incorporar el combo Tramite, el cual va tener las siguientes opciones: T.U.P.A,Proceso de Selección de Adquisición de Bienes y Servicios,
--Convocatoria de Personal, Queja por Defecto de Tramitación, , Denuncia, Recurso Impugnatorio Inspección.
--4.- Incorporar un combo de Prioridad, con las siguientes opciones Normal, Urgente y Muy Urgente
--5.- Incorporar un combo de Clasificación, con las opciones de Confidencial y No Confidencial
--6.- En la bandeja Observados, cuando le da clic a opción SUBSANAR solo se habilita la opción de requisitos TUPA
--7.- Busqueda al dar clic al opción Button recién se muestre los campos.





Z:\Documentos\Contratos Web Services\RENIEC



--1.- Prioridad de documento, va después de observación
--2.- Eliminar clasificación
--3.-tramite va antes de tipo documento
--4.-en tramite añadir PETICION GENERICA
--5.-en tramite poner DENUNCIAS LABORALES
--6.- Cuando está observado, debe imprimir en un pdf primero el Acta de Observado y luego la hoja de ruta. (Funcionalidad en el registrar)
--7.- Poner en la búsqueda rápida la palabra hoja de ruta y el año seteado por defecto
--8.- Eliminar la confirmación de estar seguro de generar un cargo
--9.- En el reporte de Distribución poner, debajo del título de Relación de Documentos, alineado a la izquierda CARGO Nº : 00010-2016
--10.- En el reporte de distribución, añadir una columna donde como cabecera va ir USUARIO (CZEVALLOS, JPEREZ), y en la fila USUARIO DE DISTRIBUCIÓN: Sylvia Vasquez
--11.- Historico de Cargo
--             Rango de Fechas
--               Fecha Desde ------Fecha Hasta
--               Código de Cargo                Año 
--                   Buscar
--          Código de Cargo, Fecha y Hora de Distribucción     Cantidad de Documentos PDF, además q permita adjuntar
--12.- En el módulo Búsqueda
-- añadir un radio de Por Cargo
--                Fecha Desde ------Fecha Hasta
--               Código de Cargo                Año 
--13.- En REGISTRAR al dar enter en dirección automáticamente debe mostrar un PopUp con la siguiente información:
--En cabecera poner datos del remitente
--En las columnas debe ir lo siguiente
--Hoja de Ruta
--Tramite del combo
--Documento  
--Asunto
--Destino
--Fecha de Emisión
--Ver ejemplo de las bandejas 


<p:outputLabel value="Nro Documento" rendered="#{!menuBean.mostrarFieldsTupa}" />
    <p:inputText style="width: 90px" value="#{menuBean.nroDoc2}" rendered="#{!menuBean.mostrarFieldsTupa}" disabled="#{menuBean.formDisable}" />
	
<!-- <p:dialog widgetVar="dialogWidgetCargo" modal="true">
		   <h:form id="dlgRefFormCargo">
		   	<p:fieldset style="text-align: left;" legend="Confirmación">
		   	   <br />
		   	   <p:outputLabel value="Está seguro que desea generar el cargo de distribución?" />
	           <br /><br />
	           <h:panelGrid columns="3">	           
	           	   <p:outputLabel value="&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;" />	   	           	   
	               <p:commandButton icon="ui-icon-check" 
	                                 title="SI" value="SI" oncomplete="dialogWidgetCargo.hide();" process="@this" action="#{menuBean.imprimirCargo}" onclick="this.form.target = '_blank'" ajax="false" />  	                                           	               
				   <p:commandButton icon="ui-icon-bullet" 
	                                 title="NO" value="NO" oncomplete="dialogWidgetCargo.hide();" process="@this" />		                                 
	           </h:panelGrid>
	           
	        </p:fieldset>   	    
	        
	        
	                       	                
		   </h:form>
	</p:dialog>  -->
	
--0.- borde en HOJA de RUTA
--1.Destino de pop up de listado de documentos ingresados poner Sub Intedencia de Actuación Inspectiva
--2.- cambiar Referencias por Asociar
--3.- en historico de cargo y búsaqueda, bajar el código de cargo en la fila siguiete
--4.- en la grilla añadir una columna denominada Usuario de Distribución y poner SVASQUEZ
--5.- PDF de distribucion eliminar total de recursos
--6.- En búsqueda , seguimiento, iniciar seguimiento con SUNAFIL - UNIDAD DE TRAMITE DOCUMENTARIO Y ARCHIVO	



Elaborar modelo de casos de uso y de clases (orientado a objetos) o de datos y procesos (estructurados)
Realizar las especificaciones del entorno tecnologico de la aplicación (físico y lógico).
Definir los requisitos de operación, administración y seguridad del software, para completar los requisitos del software

1 Despues de screens
2 Diagrama de Arquitectura
3 No esta claro




--replace de ñ's y acentos
--validar nombre empresa vacío
--validar importe diferente de 0



En la posición de código de entidad consignar 0011.



------------------------------------------------------------
--DESDE AQUI SISTEMA DE TRÁMITE EXTERNO ETAPA PROGRAMACIÓN--
------------------------------------------------------------


--llenar combo tipo doc remitente (se añadio flag de mesa de partes)

		 <h:selectOneMenu style="width:120px" id="tipodoc" value="#{menuBean.tipoDoc}" disabled="#{menuBean.formDisable}">             
             <f:selectItem itemLabel="---" itemValue="#{null}" />
             <f:selectItem itemLabel="DNI" itemValue="#{1}" />
             <f:selectItem itemLabel="CE" itemValue="#{2}" />
             <f:selectItem itemLabel="PASAPORTE" itemValue="#{3}" />
             <f:selectItem itemLabel="RUC" itemValue="#{4}" />
         </h:selectOneMenu>

--llenar combos dependientes departamento/provincia/distrito (copiar de libro de reclamaciones)

		 <h:selectOneMenu style="width:120px" id="region" disabled="#{menuBean.formDisable}">             
                <f:selectItem itemLabel="---" itemValue="#{null}" />
                <f:selectItem itemLabel="Amazonas" itemValue="#{1}" />
				<f:selectItem itemLabel="Ancash" itemValue="#{2}" />
				<f:selectItem itemLabel="Apurimac" itemValue="#{3}" />
				<f:selectItem itemLabel="Arequipa" itemValue="#{4}" />
				<f:selectItem itemLabel="Ayacucho" itemValue="#{5}" />
				<f:selectItem itemLabel="Cajamarca" itemValue="#{6}" />
				<f:selectItem itemLabel="Callao" itemValue="#{7}" />
				<f:selectItem itemLabel="Cusco" itemValue="#{8}" />
				<f:selectItem itemLabel="Huancavelica" itemValue="#{9}" />
				<f:selectItem itemLabel="Huanuco" itemValue="#{10}" />
				<f:selectItem itemLabel="Ica" itemValue="#{11}" />
				<f:selectItem itemLabel="Junin" itemValue="#{12}" />
				<f:selectItem itemLabel="La Libertad" itemValue="#{13}" />
				<f:selectItem itemLabel="Lambayeque" itemValue="#{14}" />
				<f:selectItem itemLabel="Lima" itemValue="#{15}" />
				<f:selectItem itemLabel="Loreto" itemValue="#{16}" />
				<f:selectItem itemLabel="Madre de Dios" itemValue="#{17}" />
				<f:selectItem itemLabel="Moquegua" itemValue="#{18}" />
				<f:selectItem itemLabel="Pasco" itemValue="#{19}" />
				<f:selectItem itemLabel="Piura" itemValue="#{20}" />
				<f:selectItem itemLabel="Puno" itemValue="#{21}" />
				<f:selectItem itemLabel="San Martin" itemValue="#{22}" />
				<f:selectItem itemLabel="Tacna" itemValue="#{23}" />
				<f:selectItem itemLabel="Tumbes" itemValue="#{24}" />
				<f:selectItem itemLabel="Ucayali" itemValue="#{25}" />
         </h:selectOneMenu>
		 
		 <h:selectOneMenu style="width:120px" id="provincia" disabled="#{menuBean.formDisable}">             
                <f:selectItem itemLabel="---" itemValue="#{null}" />
                <f:selectItem itemLabel="Barranca" itemValue="#{1}" />
				<f:selectItem itemLabel="Cajatambo" itemValue="#{2}" />
				<f:selectItem itemLabel="Canta" itemValue="#{3}" />
				<f:selectItem itemLabel="Cañete" itemValue="#{4}" />
				<f:selectItem itemLabel="Huaral" itemValue="#{5}" />
				<f:selectItem itemLabel="Huarochiri" itemValue="#{6}" />
				<f:selectItem itemLabel="Huaura" itemValue="#{7}" />
				<f:selectItem itemLabel="Lima" itemValue="#{8}" />
				<f:selectItem itemLabel="Oyon" itemValue="#{9}" />
				<f:selectItem itemLabel="Yauyos" itemValue="#{10}" />
         </h:selectOneMenu>

		 <h:selectOneMenu style="width:120px" id="distrito" disabled="#{menuBean.formDisable}">             
                <f:selectItem itemLabel="---" itemValue="#{null}" />
                <f:selectItem itemLabel="Ancon" itemValue="#{1}" />
				<f:selectItem itemLabel="Ate" itemValue="#{2}" />
				<f:selectItem itemLabel="Barranco" itemValue="#{3}" />
				<f:selectItem itemLabel="Breña" itemValue="#{4}" />
				<f:selectItem itemLabel="Carabayllo" itemValue="#{5}" />
				<f:selectItem itemLabel="Chaclacayo" itemValue="#{6}" />
				<f:selectItem itemLabel="Chorrillos" itemValue="#{7}" />
				<f:selectItem itemLabel="Cieneguilla" itemValue="#{8}" />
				<f:selectItem itemLabel="Comas" itemValue="#{9}" />
				<f:selectItem itemLabel="El Agustino" itemValue="#{10}" />
				<f:selectItem itemLabel="Independencia" itemValue="#{11}" />
				<f:selectItem itemLabel="Jesus Maria" itemValue="#{12}" />
				<f:selectItem itemLabel="La Molina" itemValue="#{13}" />
				<f:selectItem itemLabel="La Victoria" itemValue="#{14}" />
				<f:selectItem itemLabel="Lima" itemValue="#{15}" />
				<f:selectItem itemLabel="Lince" itemValue="#{16}" />
				<f:selectItem itemLabel="Los Olivos" itemValue="#{17}" />
				<f:selectItem itemLabel="Lurigancho" itemValue="#{18}" />
				<f:selectItem itemLabel="Lurin" itemValue="#{19}" />
				<f:selectItem itemLabel="Magdalena del Mar" itemValue="#{20}" />
				<f:selectItem itemLabel="Miraflores" itemValue="#{21}" />
				<f:selectItem itemLabel="Pachacamac" itemValue="#{22}" />
				<f:selectItem itemLabel="Pucusana" itemValue="#{23}" />
				<f:selectItem itemLabel="Pueblo Libre" itemValue="#{24}" />
				<f:selectItem itemLabel="Puente Piedra" itemValue="#{25}" />
				<f:selectItem itemLabel="Punta Hermosa" itemValue="#{26}" />
				<f:selectItem itemLabel="Punta Negra" itemValue="#{27}" />
				<f:selectItem itemLabel="Rimac" itemValue="#{28}" />
				<f:selectItem itemLabel="San Bartolo" itemValue="#{29}" />
				<f:selectItem itemLabel="San Borja" itemValue="#{30}" />
				<f:selectItem itemLabel="San Isidro" itemValue="#{31}" />
				<f:selectItem itemLabel="San Juan de Lurigancho" itemValue="#{32}" />
				<f:selectItem itemLabel="San Juan de Miraflores" itemValue="#{33}" />
				<f:selectItem itemLabel="San Luis" itemValue="#{34}" />
				<f:selectItem itemLabel="San Martin de Porres" itemValue="#{35}" />
				<f:selectItem itemLabel="San Miguel" itemValue="#{36}" />
				<f:selectItem itemLabel="Santa Anita" itemValue="#{37}" />
				<f:selectItem itemLabel="Santa Maria del Mar" itemValue="#{38}" />
				<f:selectItem itemLabel="Santa Rosa" itemValue="#{39}" />
				<f:selectItem itemLabel="Santiago de Surco" itemValue="#{40}" />
				<f:selectItem itemLabel="Surquillo" itemValue="#{41}" />
				<f:selectItem itemLabel="Villa El Salvador" itemValue="#{42}" />
				<f:selectItem itemLabel="Villa Maria del Triunfo" itemValue="#{43}" />
         </h:selectOneMenu>		 

--llenar combo tramite ??? (se añadio tabla TDTBC_TRAMITE)		 
--llenar combo tipo de documento (se añadio flag)
--llenar autocompletar de dependencias
--llenar en duro combo prioridad
SE AÑADIO TABLA TDTBC_INTENDENCIA
SE AÑADIO UN CAMPO A LA TABLA DEPENDENCIA
GRANT EXECUTE ON SIMINTRA1.P_ACCESO TO TRAMITE;
Tabla tdtbc_grupotupa, se añadio el campo N_FLGACTIVO

SUNAFIL 123
IRHUANUCO 123
onblur="this.value = this.value.toUpperCase();"
requisitos en duro
<f:selectItem itemLabel="Solicitud según Formato" itemValue="#{1}" />
<f:selectItem itemLabel="Copia de D.N.I" itemValue="#{11}" />
<f:selectItem itemLabel="Declaración Jurada" itemValue="#{111}" />

<f:selectItems value="#{menuBean.cities}" />

CREAR DEP,PROV,DIST EN TABLA tdtbd_centrolab


BBVA
prestamo 711.32 vence 02/02 pagare 711.32
tarjeta total 2,112.43 minimo 1,333.24 vence 05/02 pagare 1500

preguntar en bcp si se puede retirar 2211 en cajero

cuarto 450

-2661.32
saldo 3,437.99

C:\Users\wcastro\Downloads\bootstrap-3.3.6\docs\examples

DNI DE PRUEBA Q SI ESTA EN TBL ENTIDAD 31477075
ruc de prueba 55555444441


SIGUIENTE EN FORMULARIO REGISTRAR/NUEVO

--SI ENTIDAD EXISTE EN LA TABLA RECUPERAR DATOS DE LA TABLA
--INTEGRAR CON WS RENIEC DNI (INCLUYE GRABAR EN TABLA ENTIDAD SI NO ESTA REGISTRADO)
--INTEGRAR CON WS RENIEC RUC (INCLUYE GRABAR EN TABLA ENTIDAD SI NO ESTA REGISTRADO)
RECUPERAR DIRECCIONES DE LA ENTIDAD SI YA ESTA GRABADO SINO REGISTRAR UNA NUEVA EN CENTROLAB--inicialmente grabar una direccion nueva al finalizar formulario
--CONSULTA DE ASOCIACION POR ENTIDAD
--CONSULTA DE ASOCIACION POR HR
--CONSULTA DE ASOCIACION POR INSPECCIÓN
GRABAR EN TABLA CABECERA REGISTRO (GUIARSE DE PKG GESTION_DOCUMENTO STORED PROCEDURE SPR_INS_REGCABECERA)
GRABAR EN TABLA REGREQTUPA LOS REQUISITOS (TANTO PRESENTADO COMO NO PRESENTADOS, DIFERENCIAR CON FLAG)
AL GRABAR IMPRIMIR JASPER DE HOJA DE RUTA
AL GRABAR IMPRIMIR JASPER DE ACTA OBSERVADA+HOJA DE RUTA

EN BANDEJA DE DOCUMENTOS

DEFINIR COD DE ESTADOS (REGISTRADO, OBSERVADO Y NO PRESENTADO)
DEFINIR CONSULTAR EN BASE A ESTADOS

DNI DE PRUEBA NUEVO WS 43942930 O 10526062
en caso de dni primero buscar en entidad si no esta en entidad buscar en SITB_PERSONA, si no esta en SITB_PERSONA recien consumir WS reniec
se copia xml's de persona, personaReniec y webService del proyecto del mintra hacia trámite externo
no copiar ws de libro de reclamaciones en tramite externo
fusionar cnx de simintra1 y tramite y crear una cnx nueva solo de SIIT? incialmente se planteo una cnx para siit y otra para tramite y simintra1 



select V_NUMHOJA,V_ANIOHOJA,N_CODTRAM, V_NUMDOCREF, V_ASUNTODETALLADO, N_NUMDEPDEST, D_FECREG  from tdmvc_registro t
where v_aniohoja=2015

select V_NUMHOJA,V_ANIOHOJA,N_CODTRAM, V_NUMDOCREF, V_ASUNTODETALLADO, N_NUMDEPDEST, D_FECREG, v_codentidad  from tdmvc_registro t
where v_aniohoja=2015

select t.*,t.rowid  from tdmvc_registro t
where v_aniohoja=2015


--CUANDO CONSULTA EN TDMV_REGISTRO SIEMPRE FILTRAR POR N_NUMTIPODOC=0 Y N_NUMDEP DEL USUARIO LOGUEADO
--usar tabla nueva tdbc_dependenciasiit para saber las equivalencias de dep entre siit y tramite para consulta de asociacion por inspeccion por campo n_numdepoic
--se creo tabla tdbc_dependenciasiit
--SI NO ENCUENTRA LOS CAMPOS SEPARADOS DE NOMBRE EN TABLA ENTIDAD IR A LOGICA WS-PERSONA DE MTPE
--RECUPERAR DE TABLA ENTIDAD CUANDO SEA CE O PASAPORTE
--RECUPERAR DEPENDENCIA DESTINO CUANDO SE SELECCIONA TUPA(tanto en lupa-popup como enter)
--RECUPERAR DIRECCIONES y listar en combo A LA HORA DE DIGITAR NRO DOC SI ES RUC O DNI DE TABLA CENTROLAB, tambien si es un CE o pasaporte registrado
--GUARDAR REQUISITOS CHEKEADOS EN CASO SEA TUPA

--definir de donde se genera correlativo de num hoja de ruta cuando no esta asociado(se tiene q cambiar el tramite interno para q apunte al correlativo del nuevo tipo doc hoja de ruta unificada EXT/INT 100)
--definir como obtener la dependencia destino

--FLUJO TUPA PROBADO
select * from tdmvc_registro t WHERE V_CODENTIDAD='43942930' AND V_NUMANOREG='2016'

para consultas complejas(left join, etc) crear vista, modificar MBG cnx y generar mbg artifacts
sys sunafil2016 as sysdba

SE AÑADIO CAMPO PARA ESTADO DE BANDEJAS EN TABLA tdmvc_registro y tdmvc_registro_log
ALTER TABLE TRAMITE.tdmvc_registro
  ADD N_FLGTREX NUMBER(1) DEFAULT 0;
  
ALTER TABLE TRAMITE.tdmvc_registro_log
  ADD N_FLGTREX NUMBER(1) DEFAULT 0;  
  
paquete gestion_documento se debe modificar pues hace un select * por lo que el campo nuevo se debe añadir en el log
update a campo N_FLGTREX por null


crear vista para bandejas

select 
t.v_numanoreg, 
t.n_numdep, 
t.n_numtipodoc, 
t.v_numreg, 
e.v_desnombre, 
t.V_NUMDOC, 
t.V_ASUNTODETALLADO, 
d.v_desdep, 
t.D_FECREG,
t.n_flgtrex 
from tdmvc_registro t, tdtbc_dependencia d, tdtbc_entidad e
where t.n_numdepdest=d.n_numdep and t.v_codentidad=e.v_codentidad
and t.V_CODENTIDAD='43942930' AND t.V_NUMANOREG='2016'

create or replace view vst_bandejastrex as
select
t.v_numanoreg,
t.n_numdep,
t.n_numtipodoc,
t.v_numreg,
e.v_codtipodocid,
e.v_codentidad,
e.v_desnombre,
t.V_NUMDOC,
t.V_ASUNTODETALLADO,
d.v_desdep,
t.D_FECREG,
t.v_aniohoja,
t.v_numhoja,
t.n_flgtrex,
t.n_codcenlab,
t.n_numfolios,
t.v_descdoc,
e.v_nombres,
e.v_apepat,
e.v_apemat,
t.n_codtram,
t.n_tipodoc,
t.n_numdepdest,
t.v_observacion,
t.n_tippriori,
t.n_numgrupo,
t.v_codtupa,
t.V_ANOCORTE,
t.V_CODCORTE,
t.v_nomusureg,
tdt.v_destipodoc,
tra.v_destram
from tdmvc_registro t
left join tdtbc_tipodoctramite tdt on t.n_tipodoc=tdt.n_numtipodoc
left join tdtbc_tramite tra on t.n_codtram=tra.n_codtram
, tdtbc_dependencia d, tdtbc_entidad e
where t.n_numdepdest=d.n_numdep and t.v_codentidad=e.v_codentidad
ORDER BY   TO_NUMBER(t.V_NUMANOREG) desc, TO_NUMBER(t.v_numreg) desc;--T.D_FECREG DESC,

--GUARDAR NUEVO CAMPO ESTADO SEGUN ESTEN CHEKEADOS LOS REQUISITOS

en TdmvcHojarutaExample al final de protected abstract static class GeneratedCriteria copiar siempre despues de generar

public Criteria andCorrelativoPorAnio(Short value) {
    	  StringBuffer sb = new StringBuffer("v_codhoja in (select max(to_number(v_codhoja)) from tdmvc_hojaruta where v_aniohoja="+value+")");    	  
    	  addCriterion(sb.toString());
    	  return (Criteria) this;
    	}
		
en TdmvcCorteExample al final de protected abstract static class GeneratedCriteria copiar siempre despues de generar		
		
public Criteria andCorrelativoPorAnio(String value) {
      	  StringBuffer sb = new StringBuffer("to_number(V_CODCORTE) in (select max(to_number(V_CODCORTE)) from tdmvc_corte where to_number(V_ANOCORTE)="+value+")");    	  
      	  addCriterion(sb.toString());
      	  return (Criteria) this;
      	}		
		
en TdmvcRegistroMapper.xml

insert into TRAMITE.TDMVC_REGISTRO (V_NUMANOREG, N_NUMDEP, N_NUMTIPODOC, 
      V_NUMREG, N_TIPPRIORI, D_FECEMISION, 
      V_NUMTICKET, V_NUMANOEXP, N_NUMDEPEXP, 
      V_NUMEXPREF, V_NUMANOREGREF, N_NUMDEPREF, 
      N_NUMTIPODOCREF, V_NUMREGREF, N_NUMITEMREF, 
      N_NUMENVIOREF, V_TIPORIGEN, V_CODENTIDAD, 
      N_CODCENLAB, D_FECRECEP, N_TIPODOC, 
      V_NUMDOC, D_FECDOC, V_NUMDOCREF, 
      N_NUMDEPDEST, N_NUMGRUPO, V_CODTUPA, 
      V_CODACCIONANTE, V_CODPERSONAL, N_NUMFOLIOS, 
      V_DESASUNTO, N_FLGANULADO, N_FLGCORRESP, 
      N_FLGGENERA, N_FLGENVIADO, V_CODCORTE, 
      V_OBSERVACION, V_DESTASAS, V_NOMUSUREG, 
      D_FECREG, V_NOMUSUMOD, D_FECMOD, 
      V_FLGPROANT, V_NOMUSUARIO, V_CODDIRECCION, 
      V_DIRORG, N_FLGTIPOTRA, V_CODPERDEST, 
      N_FLGATENDIDO, N_FLGHISTORICO, N_FLGPENDTUPA, 
      N_FLGCONGRESO, D_FECATENDIDO, D_FECHISTORICO, 
      N_NUMEVIOREF, D_FECREGULA, V_ASUNTODETALLADO, 
      V_NUMHOJA, V_ANIOHOJA, V_FLGCOM, 
      V_CODCOM, V_CODCONG, V_NOMARCH, 
      V_FLGACRED, V_FLGCOSUCO, V_FLGASIG, 
      V_DESCDOC, V_FLGUSUASIG, V_CODPER, 
      V_TIPDOCWEB, V_REGWEB, V_FLGANEXO, 
      V_NUMPROLEY, V_ANOPROLEY, N_CODTRAM, 
      N_FLGTREX, V_ANOCORTE, N_FLGASOCIA
      )
    values (#{vNumanoreg,jdbcType=VARCHAR}, #{nNumdep,jdbcType=DECIMAL}, #{nNumtipodoc,jdbcType=DECIMAL}, 
      #{vNumreg,jdbcType=VARCHAR}, #{nTippriori,jdbcType=DECIMAL}, SYSDATE, 
      #{vNumticket,jdbcType=VARCHAR}, #{vNumanoexp,jdbcType=VARCHAR}, #{nNumdepexp,jdbcType=DECIMAL}, 
      #{vNumexpref,jdbcType=VARCHAR}, #{vNumanoregref,jdbcType=VARCHAR}, #{nNumdepref,jdbcType=DECIMAL}, 
      #{nNumtipodocref,jdbcType=DECIMAL}, #{vNumregref,jdbcType=VARCHAR}, #{nNumitemref,jdbcType=DECIMAL}, 
      #{nNumenvioref,jdbcType=DECIMAL}, #{vTiporigen,jdbcType=VARCHAR}, #{vCodentidad,jdbcType=VARCHAR}, 
      #{nCodcenlab,jdbcType=DECIMAL}, SYSDATE, #{nTipodoc,jdbcType=DECIMAL}, 
      #{vNumdoc,jdbcType=VARCHAR}, #{dFecdoc,jdbcType=DATE}, #{vNumdocref,jdbcType=VARCHAR}, 
      #{nNumdepdest,jdbcType=DECIMAL}, #{nNumgrupo,jdbcType=DECIMAL}, #{vCodtupa,jdbcType=VARCHAR}, 
      #{vCodaccionante,jdbcType=VARCHAR}, #{vCodpersonal,jdbcType=VARCHAR}, #{nNumfolios,jdbcType=DECIMAL}, 
      #{vDesasunto,jdbcType=VARCHAR}, #{nFlganulado,jdbcType=DECIMAL}, #{nFlgcorresp,jdbcType=DECIMAL}, 
      #{nFlggenera,jdbcType=DECIMAL}, #{nFlgenviado,jdbcType=DECIMAL}, #{vCodcorte,jdbcType=VARCHAR}, 
      #{vObservacion,jdbcType=VARCHAR}, #{vDestasas,jdbcType=VARCHAR}, #{vNomusureg,jdbcType=VARCHAR}, 
      SYSDATE, #{vNomusumod,jdbcType=VARCHAR}, SYSDATE, 
      #{vFlgproant,jdbcType=VARCHAR}, #{vNomusuario,jdbcType=VARCHAR}, #{vCoddireccion,jdbcType=VARCHAR}, 
      #{vDirorg,jdbcType=VARCHAR}, #{nFlgtipotra,jdbcType=DECIMAL}, #{vCodperdest,jdbcType=VARCHAR}, 
      #{nFlgatendido,jdbcType=DECIMAL}, #{nFlghistorico,jdbcType=DECIMAL}, #{nFlgpendtupa,jdbcType=DECIMAL}, 
      #{nFlgcongreso,jdbcType=DECIMAL}, #{dFecatendido,jdbcType=DATE}, #{dFechistorico,jdbcType=DATE}, 
      #{nNumevioref,jdbcType=DECIMAL}, #{dFecregula,jdbcType=DATE}, #{vAsuntodetallado,jdbcType=VARCHAR}, 
      #{vNumhoja,jdbcType=VARCHAR}, #{vAniohoja,jdbcType=DECIMAL}, #{vFlgcom,jdbcType=VARCHAR}, 
      #{vCodcom,jdbcType=VARCHAR}, #{vCodcong,jdbcType=VARCHAR}, #{vNomarch,jdbcType=VARCHAR}, 
      #{vFlgacred,jdbcType=VARCHAR}, #{vFlgcosuco,jdbcType=CHAR}, #{vFlgasig,jdbcType=VARCHAR}, 
      #{vDescdoc,jdbcType=VARCHAR}, #{vFlgusuasig,jdbcType=VARCHAR}, #{vCodper,jdbcType=VARCHAR}, 
      #{vTipdocweb,jdbcType=VARCHAR}, #{vRegweb,jdbcType=VARCHAR}, #{vFlganexo,jdbcType=VARCHAR}, 
      #{vNumproley,jdbcType=VARCHAR}, #{vAnoproley,jdbcType=VARCHAR}, #{nCodtram,jdbcType=DECIMAL}, 
      #{nFlgtrex,jdbcType=DECIMAL}, #{vAnocorte,jdbcType=VARCHAR}, #{nFlgasocia,jdbcType=DECIMAL}
      )
	  
----

<insert id="insertSelective" parameterType="pe.gob.sunafil.tramiteext.persistence.model.TdmvdRegxcorte" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Wed Jul 06 14:31:38 COT 2016.
    -->
    insert into TRAMITE.TDMVD_REGXCORTE
    <trim prefix="(" suffix=")" suffixOverrides="," >
      <if test="vNumanoreg != null" >
        V_NUMANOREG,
      </if>
      <if test="nNumdep != null" >
        N_NUMDEP,
      </if>
      <if test="nNumtipodoc != null" >
        N_NUMTIPODOC,
      </if>
      <if test="vNumreg != null" >
        V_NUMREG,
      </if>
      <if test="nNumitem != null" >
        N_NUMITEM,
      </if>
      <if test="nNumenvio != null" >
        N_NUMENVIO,
      </if>
      <if test="dFecrecmp != null" >
        D_FECRECMP,
      </if>
      <if test="nNumdeprmp != null" >
        N_NUMDEPRMP,
      </if>
      <if test="vCodcorte != null" >
        V_CODCORTE,
      </if>
      <if test="vAnocorte != null" >
        V_ANOCORTE,
      </if>
      <if test="vNomusureg != null" >
        V_NOMUSUREG,
      </if>
      <if test="dFecreg != null" >
        D_FECREG,
      </if>
      <if test="vHostreg != null" >
        V_HOSTREG,
      </if>
      <if test="vNomusumod != null" >
        V_NOMUSUMOD,
      </if>
      <if test="dFecmod != null" >
        D_FECMOD,
      </if>
      <if test="vHostmod != null" >
        V_HOSTMOD,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides="," >
      <if test="vNumanoreg != null" >
        #{vNumanoreg,jdbcType=VARCHAR},
      </if>
      <if test="nNumdep != null" >
        #{nNumdep,jdbcType=DECIMAL},
      </if>
      <if test="nNumtipodoc != null" >
        #{nNumtipodoc,jdbcType=DECIMAL},
      </if>
      <if test="vNumreg != null" >
        #{vNumreg,jdbcType=VARCHAR},
      </if>
      <if test="nNumitem != null" >
        #{nNumitem,jdbcType=DECIMAL},
      </if>
      <if test="nNumenvio != null" >
        #{nNumenvio,jdbcType=DECIMAL},
      </if>
      <if test="dFecrecmp != null" >
        SYSDATE,
      </if>
      <if test="nNumdeprmp != null" >
        #{nNumdeprmp,jdbcType=DECIMAL},
      </if>
      <if test="vCodcorte != null" >
        #{vCodcorte,jdbcType=VARCHAR},
      </if>
      <if test="vAnocorte != null" >
        #{vAnocorte,jdbcType=VARCHAR},
      </if>
      <if test="vNomusureg != null" >
        #{vNomusureg,jdbcType=VARCHAR},
      </if>
      <if test="dFecreg != null" >
        SYSDATE,
      </if>
      <if test="vHostreg != null" >
        #{vHostreg,jdbcType=VARCHAR},
      </if>
      <if test="vNomusumod != null" >
        #{vNomusumod,jdbcType=VARCHAR},
      </if>
      <if test="dFecmod != null" >
        #{dFecmod,jdbcType=DATE},
      </if>
      <if test="vHostmod != null" >
        #{vHostmod,jdbcType=VARCHAR},
      </if>
    </trim>
  </insert>	  
		
		
COMENTAR LINEAS 12 Y 13 DE TRIGGER "TG_I_TDMVC_REGISTRO_BEFORE"		



//diseño denuncia virtual
--1.- validar que solo sea numérico en DNI
--2.- validar que solo sea numérico el Código Verificador
--3.- validar q el ruc solo sea numerico
--3.- Estimado(a) VICTOR DINO FLORES BELIZARIO favor de ingresar la siguiente información: poner en negrita
--4.- Aumentar el tamaño de la caja del correo electrónico
--5.- El título del paso 3 debe ser Registrar Solicitud de Actuación Inspectiva
--6.- Alinear los campos
--7.- ampliar el tamaño del campo cargo
--8.- Copiar el diseño de la pantalla de confirmación de libro de reclamaciones
//end diseño denuncia virtual








<p:commandButton value="Imprimir" icon="icon-print" rendered="#{registrarBean.esGrabar}" action="#{registrarBean.imprimir}" onclick="this.form.target = '_blank'" ajax="false" />

public void mostrarReporte()
public void runReportGenerator()

FacesMessage.SEVERITY_INFO
FacesMessage.SEVERITY_ERROR
FacesMessage.SEVERITY_FATAL
FacesMessage.SEVERITY_WARN

https://drive.google.com/file/d/0B_W2LRWzA6IAWEU3SkdaQk9QcTg/view?usp=sharing
https://goo.gl/eXfhdC

https://drive.google.com/file/d/0B_W2LRWzA6IAczBQYTdrRGFRZzA/view?usp=sharing


--poner estilo de confirmar de libro reclamaciones
--modificar word y convertir a pdf



http://localhost:8080/si.denunciasVirtuales/levantaReserva?nombre=8CLIaDFQ/BHKkFLaVvQWSLAzFsIRYTT61jFivvIiOiw=



http://m.dx.com/p/3d-cool-2-0-t-style-chrome-alloy-car-decoration-sticker-silver-red-160794?169
http://m.dx.com/p/decorative-cool-3d-shark-style-aluminum-alloy-badge-emblem-sticker-for-car-104381?498
http://m.dx.com/p/stylish-diy-letter-style-zinc-alloy-car-sticker-red-silver-2-pcs-223221?107
PIR
http://m.dx.com/p/ir-infrared-motion-detection-sensor-module-dc-5v-20v-139624?134


--sacar copia de la maquina virtual de la bd llegando
http://webtrack.dhlglobalmail.com/
WATCHES RX827077583DE
TSHIRT  RX827079505DE
USB     RX827080446DE

--query para comprobar subida de archivo pdf
select T.v_Descdoc, T.* from tdmvc_registro t WHERE V_CODENTIDAD='43942930' AND V_NUMANOREG='2016' AND N_FLGTREX=0
ORDER BY D_FECEMISION ASC

--traer un campo mas de nombre de archivo en vst_bandejatrex y mostrar nuevo icono de descargar pdf solo si el campo es dif de null
--hacer funcionalidad descarga pdf similar a descargar trama 
editar y subsanar en una misma trx

***CAMPOS A MODIFICAR AL EDITAR
SOLO CARGAR DIRECCION Y 3 COMBOS UBIGEO
TIPO DOCUMENTO DE DOCUMENTO
CHECK REQUISITOS EN CASO SER TUPA
NRO FOLIOS
ASUNTO
OBSERVACIONES
PRIORIDAD
ACTUALIZAR ESTADO DE REGISTRO EN CASO DE SER TUPA Y ESTEN TODOS LOS CHECKS REQ

***CAMPOS A MODIFICAR AL SUBSANAR
SOLO CARGAR DIRECCION Y 3 COMBOS UBIGEO
CHECK REQUISITOS EN CASO SER TUPA
ACTUALIZAR ESTADO DEL REGISTRO

--JOB ::: correr todos los días
CREATE OR REPLACE PROCEDURE SPR_TO_NO_PRESENTADO IS
CURSOR C_REGISTROS_NP IS
select T.* from tdmvc_registro t WHERE D_FECEMISION BETWEEN SYSDATE-3 AND SYSDATE-2 AND N_FLGTREX=1
ORDER BY D_FECEMISION ASC;

BEGIN
      FOR REGISTRO IN C_REGISTROS_NP LOOP
      UPDATE tdmvc_registro SET N_FLGTREX=2
      WHERE V_NUMANOREG = REGISTRO.V_NUMANOREG AND 
            N_NUMDEP = REGISTRO.N_NUMDEP AND 
            N_NUMTIPODOC = REGISTRO.N_NUMTIPODOC AND
            V_NUMREG = REGISTRO.V_NUMREG;
      END LOOP;
COMMIT;
END SPR_ACCIDENTE;



--validar los campos numericos al estilo plantilla onkeypress
BUSQUEDA RAPIDA SI HAY MAS DE UN REGISTRO Y SON DE DIFERENTES ESTADOS CREAR VENTANA SELECTORA QUE MUESTRE HR,REMITENTE,ESTADO Y BOTON PARA IR A LA BANDEJA CORRESPONDIENTE
UNICO 2016 - 0000000005    2016 - 0000000013
VARIOS 2016 - 0000000060

cooler laptop http://m.dx.com/p/double-fan-usb-powered-abs-laptop-cooling-pad-black-36cm-cable-108086?381
wallet http://m.dx.com/p/che-guevara-canvas-fabric-folding-wallet-red-231426?388


cada vez que se añada un campo a tdmvc_registro debe también ser añadido en tdmvc_registro_log y modificarse el trigger que llena la 2da tabla
eliminar data de tabla corte y editar tabla
ahora corte tendra PK compuesta de año y correlativo por año el cual pasa como fk a registro
en tdmvc_registro añadir campo v_anocorte y en tdmvc_registro_log
comentar funcion uf_corte_diario de pkg gestion_documento
sp_elimina_documento compilar de pkg gestion_documento


--generar correlativo de cargo global por año
--insertar cargo
--el generar cargo solo incluye registros en estado registrado y de la fecha actual de las dependencias seleccionadas
--actualizar campos de año_corte y cod_corte en registro

--recuperar vst_bandejastrex por el nrocorte y aniocorte despues de actualizar para iterar en jasper
--mostrar CUR y HR en jasper
--validar la seleccion de al menos una dependencia
--PARA HISTORICO CARGO usar campo observacion PARA EL NOMBRE DEL ARCHIVO PDF A SUBIR EN TDMVC_CORTE



quitar columna ubicación(actual) de la cabecera de consulta, si es que se añade en futuro hacer funcion en bd para obtener ubicacion actual en base a cur
hacer una sola vista nueva para cabecera de consulta(a diferencia de vst bandeja en esta puede haber o no corte y tupa - APLICAR LEFT JOINS)
consulta para seguimiento añadir filtro por CUR internamente
todas las fecha a sysdate

SELECT rc.v_numhoja || ' - ' || rc.v_aniohoja as "v_hoja",
        case
          when rc.n_numtipodoc = 0 then e.v_desnombre
          else d1.v_desdep
        end as "v_desdepori",             
        case                    
          when rd.v_tipdestino = 'I' AND rd.n_numperdest IS not NULL then 
               to_char(d.v_desdep ||' - '|| p1.v_desapepat ||' '|| p.v_desapemat ||' '|| p1.v_desnombres)
          when rd.v_tipdestino = 'I' AND rd.n_numperdest IS  NULL then  
               d.v_desdep   
          else e.v_desnombre||'('||e.v_direntidad||')'
        end as "v_desdepdest", 
        td.v_codtipodoc || ' - ' || rc.v_numreg || ' - ' || rc.v_numanoreg || ' - ' || d1.v_coddep "v_documento",
        F_AGRUPA_ACCIONES_NUM(rc.v_numanoreg, rc.n_numdep, rc.n_numtipodoc, rc.v_numreg, rd.n_numitem, rd.n_numenvio) v_desproveido,
        to_char(rc.D_FECEMISION, 'dd/mm/yyyy hh24:mi:ss') as "d_fecemision",
        to_char(rd.d_fecrecep, 'dd/mm/yyyy hh24:mi:ss') as "d_fecrecep",
        to_char(rc.d_fecmod, 'dd/mm/yyyy hh24:mi:ss') as "d_fecmod",
        NVL(rc.v_nomarch,'SN') as "v_nomarch",
        rd.n_numperdest as "n_numperdest",
        rd.v_flgasig as "v_flgasig",
        case
          when (d.v_desdep is not null) and (rd.v_flgasig  = 'N')  then  d.v_desdep 
          when (d.v_desdep is not null) and (rd.v_flgasig  is null)  then d.v_desdep 
          when (d.v_desdep is not null) and (rd.v_flgasig  = 'S') and length(rd.n_numperdest)!= 3 then 
               (d.v_desdep || ' - ' ||p1.v_desapepat|| ' ' ||p1.v_desapemat || ' ' ||p1.v_desnombres)
          when (d.v_desdep is null) then (e.v_desnombre)
          else d.v_desdep
        end as "v_desperdepentdes",
        case
          when (rd.n_numperori is not null)  then  
               (d1.v_desdep || ' - ' ||p.v_desapepat|| ' ' ||p.v_desapemat || ' ' ||p.v_desnombres)
          else d1.v_desdep 
        end as "v_desperdepentori",
        rd.n_numperori as "n_numperori",
        rc.v_descdoc,
        (select decode(to_char(count (*)),'0','','1') 
           from tdmvc_registro rc inner join tdmvd_registro rd 
             on rc.v_numanoreg = rd.v_numanoreg
            and rc.n_numdep = rd.n_numdep
            and rc.n_numtipodoc = rd.n_numtipodoc
            and rc.v_numreg = rd.v_numreg 
          where rc.v_numhoja =lpad('60',10,'0') --HOJA DE RUTA
            and rc.v_aniohoja = 2016 --AÑO
            and rc.v_tiporigen =  'E' --ORIGEN INTERNO
            and rd.d_fecrecep is not null) as "d_fecrecepcab",
        rc.v_nomusureg,
        rc.n_numdep,
        rc.v_tipdocweb,
        case 
          when substr(rc.v_descdoc,1,1) = 'S' then
            '1'
          when substr(rc.v_descdoc,1,1) = 'D' then
            '2'
          when substr(rc.v_descdoc,1,1) = 'R' then
            '3'
          else
            '0'
        end v_flgdocweb,
        rc.v_flganexo,  
        nvl(
            (case 
               when rd.v_motivoaten is not null then rd.v_motivoaten
               when rd.v_observacion is not null then rd.v_observacion 
               when ts.v_coment is not null then ts.v_coment 
             end),'-')
        as v_motivo
  from tdmvc_registro       rc,
       tdmvd_registro       rd,
       tdtbc_tipodoctramite td,
       tdtbc_dependencia    d,
       tdtbc_dependencia    d1,
       tdtbc_entidad        e,
       prtbc_personal       p,
       prtbc_personal       p1,
       tdmv_tupasap         ts
 where rc.v_numanoreg = rd.v_numanoreg
   and rc.n_numdep = rd.n_numdep
   and rc.n_numtipodoc = rd.n_numtipodoc
   and rc.v_numreg = rd.v_numreg
   and rc.v_numanoreg = ts.v_numanoreg(+)
   and rc.n_numdep = ts.n_numdep(+)
   and rc.n_numtipodoc = ts.n_numtipodoc(+)
   and rc.v_numreg = ts.v_numreg(+)
   and td.n_numtipodoc = rc.n_numtipodoc
   and d.n_numdep(+) = rd.n_numdepdest
   and d1.n_numdep(+) = rd.n_numdepori
   and e.v_codentidad(+) = rd.v_codentidad
   and to_char(LPAD(rd.n_numperori, 8, '0')) = p.v_codpersonal(+)
   and to_char(LPAD(rd.n_numperdest, 8, '0')) = p1.v_codpersonal(+)
   and rc.v_numhoja = lpad('60', 10, '0') --HOJA DE RUTA
   and rc.v_aniohoja = '2016' --AÑO 
   and rc.v_tiporigen = 'E' --ORIGEN INTERNO
 order by rc.d_fecemision asc, rd.n_flgcopia
 
 
 
 
create or replace view vst_consultastrex as
select
t.v_numanoreg,
t.n_numdep,
t.n_numtipodoc,
t.v_numreg,
e.v_codtipodocid,
e.v_codentidad,
e.v_desnombre,
t.V_NUMDOC,
t.V_ASUNTODETALLADO,
d.v_desdep,
t.D_FECREG,
t.v_aniohoja,
t.v_numhoja,
t.n_flgtrex,
t.n_codcenlab,
t.n_numfolios,
t.v_descdoc,
e.v_nombres,
e.v_apepat,
e.v_apemat,
t.n_codtram,
t.n_tipodoc,
t.n_numdepdest,
t.v_observacion,
t.n_tippriori,
t.n_numgrupo,
t.v_codtupa,
t.V_ANOCORTE,
t.V_CODCORTE,
c.d_feccorte,
to_char(t.D_FECREG,'dd/mm/yyyy') d_fechaformateada,
CASE WHEN t.n_flgtrex=0 THEN 'REGISTRADO' WHEN t.n_flgtrex=1 THEN 'OBSERVADO' WHEN t.n_flgtrex=2 THEN 'NO PRESENTADO' ELSE NULL END n_flgtrexformateado,
tu.v_destupa,
t.v_nomusureg
from tdmvc_registro t
LEFT JOIN tdmvc_corte c ON t.v_anocorte=c.v_anocorte and t.v_codcorte=c.v_codcorte
LEFT JOIN tdtbd_tupa tu ON t.n_numgrupo=tu.n_numgrupo and t.n_numdepdest=tu.n_numdep and t.v_codtupa=tu.v_codtupa
, tdtbc_dependencia d, tdtbc_entidad e
where t.n_numdepdest=d.n_numdep and t.v_codentidad=e.v_codentidad
ORDER BY T.D_FECREG DESC;


en reporte por procedimiento el campo ubicacion mostrar el de la ultima fecha, en caso haya dos destinos con la misma fecha mostrar dos filas
en reporte por usuario no tomar en cuenta nflgtrex

select i.n_numint, i.v_desint, t.v_nomusureg, p.v_desnombres||' '||p.v_desapepat||' '||p.v_desapemat NOMBRE, count(1) TOTAL
from tdmvc_registro t, tdtbc_dependencia d, tdtbc_intendencia i, SITB_USUARIO u, prtbc_personal p
where 
t.v_nomusureg=u.v_codusu
AND p.V_CODPERSONAL=u.v_Codpersonal
AND t.n_flgtrex in (0,1,2)
AND t.d_fecreg between TO_DATE('01/01/2016', 'dd/mm/yyyy') AND TO_DATE('19/03/2016', 'dd/mm/yyyy')
AND T.N_NUMTIPODOC='0' 
AND t.n_numdepdest=d.n_numdep
AND d.n_numint=i.n_numint 
--AND i.n_numint=1
group by i.n_numint, i.v_desint, t.v_nomusureg, p.v_desnombres||' '||p.v_desapepat||' '||p.v_desapemat, t.v_nomusureg
ORDER BY N_NUMINT ASC


create or replace view vst_siit_to_tramite as
select re.v_numregmp as v_nroHR,
       re.v_anhoregmp  as v_anioHR,
       oir.v_numordeninsp as v_nroOIC,
       oir.v_anho as v_anioOIC,
       a.v_numactinsp as v_nroActa,
       a.v_anhoacta as v_anioActa,
       INITCAP(da.v_desdep) v_desdepActa,
       ex.v_numexpsanc as v_nroExpSan,
       ex.v_anho as v_anioExpSanc,
       INITCAP(de.v_desdep) v_desdepExpSan,
       rsd.v_numresolsanc as v_nroRes1ra,
       rsd.v_anhoressanc as v_anioRes1ra,
       INITCAP(drsd.v_desdep) v_desdepRes1ra,
       rd.v_numrecape as v_nroRes2da,
       rd.v_anhorecape as v_anioRes2da,
       INITCAP(drd.v_desdep) v_desdepRes2da,
       --para las consultas
       oir.n_numdep as n_numdepOIC,
       a.n_numdep as n_numdepActa,
       ex.n_numdep as n_numdepExpSanc,
       rsd.n_numdepdes as n_numdepRes1ra,
       rd.n_numdeprecape as n_numdepRes2da


  from iltmv_registroentrada re,
       iltmv_oixregent       oir,
       iltbc_ordeninspeccion oi,
       iltbc_actainspecci    a,
       tdtbc_dependencia     da,
       iltbc_expsancionador  ex,
       tdtbc_dependencia     de,
       iltbc_resolucionsanc  rsd,
       tdtbc_dependencia     drsd,
       iltbc_recurso         rd,
       tdtbc_dependencia     drd
 where re.n_numentra = oir.v_numre(+)
   and re.n_anio = oir.v_anhore(+)
   and re.v_codzon = oir.v_codzon(+)
   and re.v_codreg = oir.v_codreg(+)
   and re.n_numdep = oir.n_numdepre(+)
   and oir.v_numordeninsp = oi.v_numordeninsp(+)
   and oir.v_anho = oi.v_anho(+)
   and oir.n_numdep = oi.n_numdep(+)
   and oi.v_numordeninsp = a.v_numordeninsp(+)
   and oi.v_anho = a.v_anho(+)
   and oi.n_numdep = a.n_numdep(+)
   and a.n_numdepdes=da.n_numdep(+)
   and a.v_numactinsp=ex.v_numactinsp(+)
   and a.v_anhoacta=ex.v_anhoacta(+)
   and a.n_numdep=ex.n_numdepact(+)
   and ex.n_numdepdes=de.n_numdep(+)
   and ex.v_numexpsanc=rsd.v_numexpsanc(+)
   and ex.v_anho=rsd.v_anho(+)
   and ex.n_numdep=rsd.n_numdep(+)
   and rsd.n_numdepdes=drsd.n_numdep(+)
   and rsd.v_numresolsanc=rd.v_numresolsanc(+)
   and rsd.v_anhoressanc=rd.v_anhoressanc(+)
   and rsd.n_numdepdes=rd.n_numdepdes(+)
   and rd.n_numdeprecape=drd.n_numdep(+)
   and re.v_numregmp is not null --todos los que tienen hoja de ruta

   --and re.v_numregmp=LPAD('12',10,'0')
   --and re.v_anhoregmp=P_V_ANIOREGMP
   ---and re.n_numdep =462--busca inssi e ilm si se da el caso
   order by oi.v_numordeninsp;
   
   
   
   
   
   
   
create or replace view vst_direccionestrex as
select t.v_codentidad, 
t.n_codcenlab, 
t.v_dircenlab, 
t.v_nomusureg, 
t.d_fecreg, 
t.v_nomusumod, 
t.d_fecmod, 
t.v_coddep,
t.v_codpro,
t.v_coddis,
r.v_desdep,
p.v_despro,
d.v_desdis
from tdtbd_centrolab t
LEFT JOIN SITB_DEPARTAMENTO r ON t.v_coddep=r.v_coddep
LEFT JOIN SITB_PROVINCIA p ON t.v_codpro=p.v_codpro and t.v_coddep=p.v_coddep
LEFT JOIN SITB_DISTRITO d ON t.v_coddis=d.v_coddis and t.v_codpro=d.v_codpro and t.v_coddep=d.v_coddep;
   
   
   

CREATE OR REPLACE VIEW VST_TRAZABILIDADTREX AS
SELECT  rc.v_numanoreg, rc.n_numdep, rc.n_numtipodoc, rc.v_numreg,
        rc.v_numhoja || ' - ' || rc.v_aniohoja as v_hoja,
        case
          when rc.n_numtipodoc = 0 then e.v_desnombre
          else d1.v_desdep
        end as v_desdepori,
        case
          when rd.v_tipdestino = 'I' AND rd.n_numperdest IS not NULL then
               to_char(d.v_desdep ||' - '|| p1.v_desapepat ||' '|| p.v_desapemat ||' '|| p1.v_desnombres)
          when rd.v_tipdestino = 'I' AND rd.n_numperdest IS  NULL then
               d.v_desdep
          else e.v_desnombre||'('||e.v_direntidad||')'
        end as v_desdepdest,
        td.v_codtipodoc || ' - ' || rc.v_numreg || ' - ' || rc.v_numanoreg || ' - ' || d1.v_coddep v_documento,
        F_AGRUPA_ACCIONES_NUM(rc.v_numanoreg, rc.n_numdep, rc.n_numtipodoc, rc.v_numreg, rd.n_numitem, rd.n_numenvio) v_desproveido,
        to_char(rc.D_FECEMISION, 'dd/mm/yyyy hh24:mi:ss') as d_fecemision,
        to_char(rd.d_fecrecep, 'dd/mm/yyyy hh24:mi:ss') as d_fecrecep,
        to_char(rc.d_fecmod, 'dd/mm/yyyy hh24:mi:ss') as d_fecmod,
        NVL(rc.v_nomarch,'SN') as v_nomarch,
        rd.n_numperdest as n_numperdest,
        rd.v_flgasig as v_flgasig,
        case
          when (d.v_desdep is not null) and (rd.v_flgasig  = 'N')  then  d.v_desdep
          when (d.v_desdep is not null) and (rd.v_flgasig  is null)  then d.v_desdep
          when (d.v_desdep is not null) and (rd.v_flgasig  = 'S') and length(rd.n_numperdest)!= 3 then
               (d.v_desdep || ' - ' ||p1.v_desapepat|| ' ' ||p1.v_desapemat || ' ' ||p1.v_desnombres)
          when (d.v_desdep is null) then (e.v_desnombre)
          else d.v_desdep
        end as v_desperdepentdes,
        case
          when (rd.n_numperori is not null)  then
               (d1.v_desdep || ' - ' ||p.v_desapepat|| ' ' ||p.v_desapemat || ' ' ||p.v_desnombres)
          else d1.v_desdep
        end as v_desperdepentori,
        rd.n_numperori as n_numperori,
        rc.v_descdoc,
        (select decode(to_char(count (*)),'0','','1')
           from tdmvc_registro rc inner join tdmvd_registro rd
             on rc.v_numanoreg = rd.v_numanoreg
            and rc.n_numdep = rd.n_numdep
            and rc.n_numtipodoc = rd.n_numtipodoc
            and rc.v_numreg = rd.v_numreg
          where --rc.v_numhoja =lpad('39',10,'0')
            --and
            --rc.v_aniohoja = 2016
            --and
            rc.v_tiporigen =  'E'
            --and rc.v_numanoreg = 2016
            --and rc.v_numreg =lpad('95',10,'0')
            and rd.d_fecrecep is not null) as d_fecrecepcab,
        rc.v_nomusureg,
        rc.v_tipdocweb,
        case
          when substr(rc.v_descdoc,1,1) = 'S' then
            '1'
          when substr(rc.v_descdoc,1,1) = 'D' then
            '2'
          when substr(rc.v_descdoc,1,1) = 'R' then
            '3'
          else
            '0'
        end v_flgdocweb,
        rc.v_flganexo,
        nvl(
            (case
               when rd.v_motivoaten is not null then rd.v_motivoaten
               when rd.v_observacion is not null then rd.v_observacion
               when ts.v_coment is not null then ts.v_coment
             end),'-')
        as v_motivo,
		decode(rd.N_FLGATENDIDO,1,'Atendido'
                        ,decode(rd.n_flgrecibido,0,'Por Recepcionar'
                                                ,decode(rd.n_flgaccion,1,'Derivado'
                                                                      ,2,'Derivado'
                                                                      ,'Por Atender')) --Puede ser Por Recepcionar, Por Atender o Derivado(n_glaccion 1 o 2)
       ) as bandeja
  from tdmvc_registro       rc,
       tdmvd_registro       rd,
       tdtbc_tipodoctramite td,
       tdtbc_dependencia    d,
       tdtbc_dependencia    d1,
       tdtbc_entidad        e,
       prtbc_personal       p,
       prtbc_personal       p1,
       tdmv_tupasap         ts
 where rc.v_numanoreg = rd.v_numanoreg
   and rc.n_numdep = rd.n_numdep
   and rc.n_numtipodoc = rd.n_numtipodoc
   and rc.v_numreg = rd.v_numreg
   and rc.v_numanoreg = ts.v_numanoreg(+)
   and rc.n_numdep = ts.n_numdep(+)
   and rc.n_numtipodoc = ts.n_numtipodoc(+)
   and rc.v_numreg = ts.v_numreg(+)
   and td.n_numtipodoc = rc.n_numtipodoc
   and d.n_numdep(+) = rd.n_numdepdest
   and d1.n_numdep(+) = rd.n_numdepori
   and e.v_codentidad(+) = rd.v_codentidad
   and to_char(LPAD(rd.n_numperori, 8, '0')) = p.v_codpersonal(+)
   and to_char(LPAD(rd.n_numperdest, 8, '0')) = p1.v_codpersonal(+)
   --and rc.v_numhoja = lpad('39', 10, '0')
   --and rc.v_aniohoja = 2016
   and rc.v_tiporigen = 'E'
   --and rc.v_numanoreg = 2016
   --and rc.v_numreg =lpad('95',10,'0')
 order by rc.d_fecemision asc, rd.n_flgcopia;

 
--consulta de ultimo reporte

SELECT i.v_desint, d.v_desdep, V.v_desnombre,V.v_numanoreg||'-'||V.v_numreg,V.D_FECREG, V.V_ASUNTODETALLADO, 
V.v_destupa, V.v_codtupa,
t.v_desdepdest,
t.d_fecmod, t.d_fecrecep,
CASE WHEN t.d_fecmod is null and t.d_fecrecep is null THEN 'ENVIADO' WHEN  t.d_fecmod is null and t.d_fecrecep is NOT null THEN 'RECEPCIONADO' WHEN t.d_fecmod is NOT null and (t.d_fecrecep is NOT null OR t.d_fecrecep is null) THEN 'MODIFICADO' ELSE '' END ESTADO,
V.v_nomusureg 
FROM vst_consultastrex V, tdtbc_dependencia d, tdtbc_intendencia i, vst_trazabilidadtrex t
WHERE V.v_codtupa IS NOT NULL
AND V.n_numdep=d.n_numdep
AND d.n_numint=i.n_numint 
AND V.v_numanoreg=t.v_numanoreg 
and V.n_numdep=t.n_numdep 
and V.n_numtipodoc=t.n_numtipodoc 
and V.v_numreg=t.v_numreg

and V.v_numanoreg=2016
and d.n_numdep=500 

---------------------------------------------------------------------------------
-----------------------IMPLEMENTACIÓN WS RENIEC PRODUCCIÓN-----------------------
---------------------------------------------------------------------------------

Guiarse de proyecto en struts
D:\Willy\misc\ws reniec no pide en struts
File list :::
AdmGestionVisitasAction.java => vendría a ser ManagedBeans
ReniecMainWebService.java => vendría a ser Despatch
WebServiceDAO.java => Implementador
mnt_registroVisita.jsp => jsf

--ws reniec remplazar jar
--añadir nuevas condiciones de respuesta de ws
modificar la consulta del ws con dni de encargada
--adecuar xml a SIMINTRA1.PKG_WSRENIEC
--modificar insert y logica de cuando el origen es pide reniec actualizar el registro
--modificando WebServiceDAO.getTrabajador(dni) linea 239
--RegistrarBean.java 1173 traer de SP, test eliminar registro de 44436285 de entidad y poner sitb_persona flgreniec en N
--completar hayRegEntidadManual=true; para RUC COMO SI YA SEA Q NO ENCUENTRE O FALLE ES NULL, EN ESTE CASO NO HAY ESTADOS DE RESPUESTA
--en flujo dni ws reniec ::: ip y usureg en hardcode cambiar

--Observación es opcional
--Al subir un archivo consultar de nuevo
--Ordenar las bandejas de mayor a menor (descendente)
--DAR FORMATO A EXCEL EN LA BANDEJA DE CONSULTAS

--1.-AL REGISTRAR LOS DOCUMENTOS y en la opción ASOCIAR por Hoja de Ruta, validar que ingrese sólo números en la hoja de ruta y año, asi mismo, no debe permitir buscar si no ha ingresado ningún criterio de búsqueda
--2.- EL APLICATIVO PERMITE GRABAR SIN NUMERO DE TUPA, ES DECIR SE SELECCIONA EL TUPA Y LUEGO POR ERROR BORRAR EL NUMERO DE TUPA TE DEJA GRABAR, VALIDAR
--3.- CUANDO SE REALIZA UNA BÚSQUEDA POR TUPA QUEDA PEGADO EL CRITERIO DE BUSQUEDA, OCASIANDO QUE CARGUE SOLO CON EL CRITERIO DE BUSQUEDA
--4.- VALIDAR QUE CODIGO DE TUPA MAXIMO 4 CARACTERES
--4.- LOS CAMPOS AÑOS ES MÁXIMO DE 4 CARACTERES Y NUMERICO
--5.- LOS CAMPOS HOJA DE RUTA ES MAXIMO DE 10 CARACTERES Y NUMERICO
--6.- LOS CAMPOS DE ASOCIAR HOJA DE RUTA DEBE ESTAR DESHABILITADO SOLO SE CARGA CON LAS OPCIONES DE BUSQUEDA DE HR O POR INSPECCIONES
--7.-EN LA BANDEJA DE CONSULTAS, Criterio: Por hoja de ruta, sólo debe permitir digitar números tanto en la hoja de ruta como en el año
--8.-EN LA BANDEJA DE CONSULTAS, Criterio: cuando es por tipo de documento y número de documento validar que cuando es DNI, el número de documento deber númerico y de 8 dígitos, cuando es RUC debe ser numérico y de 11 dígitos y cuando es Pasaporte y carnet de extranejería maximo de 15 digitos
--9.-EN LA BANDEJA DE CONSULTAS, Criterio: Por Cargo, sólo debe permitir digitar números tanto en el cargo como en el año
--10.- EN EL REPORTE POR PROCEDIMIENTO PONER EN VEZ DE CORRELATIVO CÓDIGO ÚNICO DE REGISTRO, LA HOJA DE RUTA.
--11.- EN EL REPORTE POR PROCEDIMIENTO CORREGIR EL FORMATO DE FECHA EN DD/MM/YYYY HH:MM:SS
--12.- EN EL REPORTE POR PROCEDIMIENTO de donde salio eL ESTADO DE EXPEDIENTE MODIFICADO

43942930
D:\Willy\aplicativos\$_LibroReclamaciones\WS_LIBRORECLAM


--años que tengan 4 caracteres sino no va a bd
--al seleccionar tramite dif a tupa borrar todos los campos tupa
--al seleccionar o enter tupa borrar listChoice
--QUE NO PERMITA SELECCIONAR LAS ASOC POR I SIN HOJA DE RUTA
--MOSTRAR TIPODOc Y NRO DOC CONCATENADO EN BANDEJAS
--FOLIOS, maximo 5 caracteres

--Cuando cambia el tipo de documento se debe borrar el numero de documento, apellido paterno, materno, nombre, o razón social y/o dirección
--Mensaje dice Ingrese una organización remitente, debe decir Ingrese la razón social del remitente
--en el módulo busqueda que se limpie los criterios de busqueda
--al dar clic a HR, I se debe limpiar la ventanita
--busqueda rapida validar que ingrese un número de HR
control check box list al dar clic para cargar que se limpie la cajita de busqueda
recarga despues de subir pdf a cargo

detecta cargos sin documentos
select t.*, t.rowid from tdmvc_corte t where to_number(t.v_codcorte) not in (select distinct to_number(r.v_codcorte) from tdmvc_registro r where r.v_codcorte is not null)

cuando haya cargos con cero doc no insertar en tabla corte y mostra mensaje


http://www.prozis.com/blog/en/beef-protein-vs-whey-protein-better/
http://seannal.com/articles/supplementation/truth-about-beef-protein-isolate-powder.php
--alert whey aminos increases nitrogen in body, also as creatine, this is the reason why whey doesn't contain creatine, whey increases kidney and liver stress and beef with creatine only kidney
http://www.livestrong.com/article/468424-whey-protein-products-containing-creatine-side-effects/
https://www.quora.com/Sports-Nutrition-What-is-the-difference-between-whey-protein-and-creatine
http://www.soberrecovery.com/forums/fitness-health-nutrition/182102-so-whey-protein-useless-without-creatine-do-i-even-need-either.html
http://www.fitday.com/fitness-articles/nutrition/vitamins-minerals/can-you-combine-creatine-and-protein-powder.html




Revisar el lunes la actualización de datos de valentina essalud en
http://ww4.essalud.gob.pe:7777/acredita/


---------------------------------------------------------------------------------
---------------------------SISTEMA DE DENUNCIA VIRTUAL---------------------------
---------------------------------------------------------------------------------

SUNAFIL/IRE-LA LIBERTAD ::: 13
SUNAFIL/IRE-ANCASH-HUARAZ ::: 02
SUNAFIL/IRE-LORETO ::: 16
SUNAFIL/IRE-ANCASH-CHIMBOTE ::: 02
SUNAFIL/IRE-ICA ::: 11
SUNAFIL/IRE-CAJAMARCA ::: 06
SUNAFIL/IRE-MOQUEGUA ::: 18
SUNAFIL/ILM ::: 15
SUNAFIL/IRE-HUANUCO ::: 10
SUNAFIL/IRE-TUMBES ::: 24

--añadir cnx a SIIT para validar ubigeo en el paso 2 y para levantamiento de reserva de identidad
añadir iltbc_unidad a erwin diagram
añadir campo despido arbitrario en solicitud

ruc 20551964940

CREATE SEQUENCE dlmv_solicitud_seq;

GRANT SELECT ON  simintra1.sitbd_wsreniec TO DENVIRTUAL;
GRANT INSERT ON  simintra1.sitbd_wsreniec TO DENVIRTUAL;

--crear trigger para q inserte todos los tipos de documento en tbl dlmvd_docxsol con despues de insertar un registro en tbl dlmv_solicitud

create or replace trigger "TG_I_DLMV_SOLICITUD"
after
insert
on dlmv_solicitud
for each row
begin
    insert into dlmvd_docxsol
                (
                 N_CODSOL, N_CODDOC
                )
                select :new.N_CODSOL, N_CODDOC from dltbc_documento;
end;

--tablas con grant to DENVIRTUAL del esquema tramite
tramite.tdtbc_entidad
tramite.tdtbd_centrolab
tramite.tdtbc_tramite
tramite.tdtbc_correlativo
tramite.tdmvc_hojaruta
tramite.tdtbc_intendencia
tramite.tdtbc_dependencia
tramite.tdmvc_registro


--obtener numsol anio sol crear un select max+1 sin tabla correlativo
--generar objetos de tramite con MBG
--copiar regenerated al modo trext
--en tdtbc_tramite añadir registro para DENUNCIA VIRTUAL y en el código de trámite excluir del combo tipo trámite a este nuevo registro
--dar permisos a denvirtual al esquema tramite para que inserte en tdmvc_registro y demás
--obtener numhoja aniohoja despues de insertar en tramite
--ncodsol y v_email existiran en la vista del siit para levantar reserva





SE AÑADIERON DOS CAMPOS (N_NUMDEPUTD y V_UBIGEO(referenciado de SIIT.iltbc_unidad)) EN LA TABLA TRAMITE.TDTBC_INTENDENCIA, tomar en cuenta DEP y PRO para encontrar dependencia origen y destino

-- Create table
create table TDTBC_INTENDENCIA
(
  N_NUMINT    INTEGER not null,
  V_DESINT    VARCHAR2(500),
  N_FLGACT    INTEGER,
  N_NUMDEPUTD INTEGER,
  V_UBIGEO    VARCHAR2(4)
)
tablespace MPD_DATA01
  pctfree 10
  initrans 1
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );
-- Add comments to the table 
comment on table TDTBC_INTENDENCIA
  is 'TABALA QUE ALMACENAS LAS INTEDENCIAS REGIONALES';
-- Add comments to the columns 
comment on column TDTBC_INTENDENCIA.N_NUMINT
  is 'CODIGO DE LA INTENDENCIA';
comment on column TDTBC_INTENDENCIA.V_DESINT
  is 'DESCRIPCION DE LA INTENDENCIA';
comment on column TDTBC_INTENDENCIA.N_FLGACT
  is '1- ACTIVO, 0 -INACTIVO';
comment on column TDTBC_INTENDENCIA.N_NUMDEPUTD
  is 'CODIGO DE DEPENDENCIA DE LA UTD';
comment on column TDTBC_INTENDENCIA.V_UBIGEO
  is 'INDICA EL CODIGO DE DEPARTAMENTO Y PROVINCIA EN DONDE ESTA UNA INTENDENCIA REGIONAL Y OFICINA ZONAL(MISMO CAMPO DEL SIIT iltbc_unidad)';
-- Create/Recreate primary, unique and foreign key constraints 
alter table TDTBC_INTENDENCIA
  add constraint PK_INTENDENCIA primary key (N_NUMINT)
  using index 
  tablespace MPD_DATA01
  pctfree 10
  initrans 2
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );


@Regenerated
  
En DlmvSolicitudExample.java  
public Criteria andCorrelativoPorAnio(String value) {
        	StringBuffer sb = new StringBuffer("V_NUMSOL in (select max(to_number(V_NUMSOL)) from dlmv_solicitud where v_anhosol="+value+")");    	  
        	addCriterion(sb.toString());
        	return (Criteria) this;
    	}  
		
en TdmvcHojarutaExample al final de protected abstract static class GeneratedCriteria copiar siempre despues de generar

public Criteria andCorrelativoPorAnio(Short value) {
    	  StringBuffer sb = new StringBuffer("v_codhoja in (select max(to_number(v_codhoja)) from tramite.tdmvc_hojaruta where v_aniohoja="+value+")");    	  
    	  addCriterion(sb.toString());
    	  return (Criteria) this;
    	}		
		
en TdmvcRegistroMapper.xml

<insert id="insertSelective" parameterType="pe.gob.sunafil.tramiteext.persistence.model.TdmvcRegistro" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri Apr 15 16:36:02 COT 2016.
    -->
    insert into TRAMITE.TDMVC_REGISTRO
    <trim prefix="(" suffix=")" suffixOverrides="," >
      <if test="vNumanoreg != null" >
        V_NUMANOREG,
      </if>
      <if test="nNumdep != null" >
        N_NUMDEP,
      </if>
      <if test="nNumtipodoc != null" >
        N_NUMTIPODOC,
      </if>
      <if test="vNumreg != null" >
        V_NUMREG,
      </if>
      <if test="nTippriori != null" >
        N_TIPPRIORI,
      </if>
      <if test="dFecemision != null" >
        D_FECEMISION,
      </if>
      <if test="vNumticket != null" >
        V_NUMTICKET,
      </if>
      <if test="vNumanoexp != null" >
        V_NUMANOEXP,
      </if>
      <if test="nNumdepexp != null" >
        N_NUMDEPEXP,
      </if>
      <if test="vNumexpref != null" >
        V_NUMEXPREF,
      </if>
      <if test="vNumanoregref != null" >
        V_NUMANOREGREF,
      </if>
      <if test="nNumdepref != null" >
        N_NUMDEPREF,
      </if>
      <if test="nNumtipodocref != null" >
        N_NUMTIPODOCREF,
      </if>
      <if test="vNumregref != null" >
        V_NUMREGREF,
      </if>
      <if test="nNumitemref != null" >
        N_NUMITEMREF,
      </if>
      <if test="nNumenvioref != null" >
        N_NUMENVIOREF,
      </if>
      <if test="vTiporigen != null" >
        V_TIPORIGEN,
      </if>
      <if test="vCodentidad != null" >
        V_CODENTIDAD,
      </if>
      <if test="nCodcenlab != null" >
        N_CODCENLAB,
      </if>
      <if test="dFecrecep != null" >
        D_FECRECEP,
      </if>
      <if test="nTipodoc != null" >
        N_TIPODOC,
      </if>
      <if test="vNumdoc != null" >
        V_NUMDOC,
      </if>
      <if test="dFecdoc != null" >
        D_FECDOC,
      </if>
      <if test="vNumdocref != null" >
        V_NUMDOCREF,
      </if>
      <if test="nNumdepdest != null" >
        N_NUMDEPDEST,
      </if>
      <if test="nNumgrupo != null" >
        N_NUMGRUPO,
      </if>
      <if test="vCodtupa != null" >
        V_CODTUPA,
      </if>
      <if test="vCodaccionante != null" >
        V_CODACCIONANTE,
      </if>
      <if test="vCodpersonal != null" >
        V_CODPERSONAL,
      </if>
      <if test="nNumfolios != null" >
        N_NUMFOLIOS,
      </if>
      <if test="vDesasunto != null" >
        V_DESASUNTO,
      </if>
      <if test="nFlganulado != null" >
        N_FLGANULADO,
      </if>
      <if test="nFlgcorresp != null" >
        N_FLGCORRESP,
      </if>
      <if test="nFlggenera != null" >
        N_FLGGENERA,
      </if>
      <if test="nFlgenviado != null" >
        N_FLGENVIADO,
      </if>
      <if test="vCodcorte != null" >
        V_CODCORTE,
      </if>
      <if test="vObservacion != null" >
        V_OBSERVACION,
      </if>
      <if test="vDestasas != null" >
        V_DESTASAS,
      </if>
      <if test="vNomusureg != null" >
        V_NOMUSUREG,
      </if>
      <if test="dFecreg != null" >
        D_FECREG,
      </if>
      <if test="vNomusumod != null" >
        V_NOMUSUMOD,
      </if>
      <if test="dFecmod != null" >
        D_FECMOD,
      </if>
      <if test="vFlgproant != null" >
        V_FLGPROANT,
      </if>
      <if test="vNomusuario != null" >
        V_NOMUSUARIO,
      </if>
      <if test="vCoddireccion != null" >
        V_CODDIRECCION,
      </if>
      <if test="vDirorg != null" >
        V_DIRORG,
      </if>
      <if test="nFlgtipotra != null" >
        N_FLGTIPOTRA,
      </if>
      <if test="vCodperdest != null" >
        V_CODPERDEST,
      </if>
      <if test="nFlgatendido != null" >
        N_FLGATENDIDO,
      </if>
      <if test="nFlghistorico != null" >
        N_FLGHISTORICO,
      </if>
      <if test="nFlgpendtupa != null" >
        N_FLGPENDTUPA,
      </if>
      <if test="nFlgcongreso != null" >
        N_FLGCONGRESO,
      </if>
      <if test="dFecatendido != null" >
        D_FECATENDIDO,
      </if>
      <if test="dFechistorico != null" >
        D_FECHISTORICO,
      </if>
      <if test="nNumevioref != null" >
        N_NUMEVIOREF,
      </if>
      <if test="dFecregula != null" >
        D_FECREGULA,
      </if>
      <if test="vAsuntodetallado != null" >
        V_ASUNTODETALLADO,
      </if>
      <if test="vNumhoja != null" >
        V_NUMHOJA,
      </if>
      <if test="vAniohoja != null" >
        V_ANIOHOJA,
      </if>
      <if test="vFlgcom != null" >
        V_FLGCOM,
      </if>
      <if test="vCodcom != null" >
        V_CODCOM,
      </if>
      <if test="vCodcong != null" >
        V_CODCONG,
      </if>
      <if test="vNomarch != null" >
        V_NOMARCH,
      </if>
      <if test="vFlgacred != null" >
        V_FLGACRED,
      </if>
      <if test="vFlgcosuco != null" >
        V_FLGCOSUCO,
      </if>
      <if test="vFlgasig != null" >
        V_FLGASIG,
      </if>
      <if test="vDescdoc != null" >
        V_DESCDOC,
      </if>
      <if test="vFlgusuasig != null" >
        V_FLGUSUASIG,
      </if>
      <if test="vCodper != null" >
        V_CODPER,
      </if>
      <if test="vTipdocweb != null" >
        V_TIPDOCWEB,
      </if>
      <if test="vRegweb != null" >
        V_REGWEB,
      </if>
      <if test="vFlganexo != null" >
        V_FLGANEXO,
      </if>
      <if test="vNumproley != null" >
        V_NUMPROLEY,
      </if>
      <if test="vAnoproley != null" >
        V_ANOPROLEY,
      </if>
      <if test="nCodtram != null" >
        N_CODTRAM,
      </if>
      <if test="nFlgtrex != null" >
        N_FLGTREX,
      </if>
      <if test="vAnocorte != null" >
        V_ANOCORTE,
      </if>
      <if test="nFlgasocia != null" >
        N_FLGASOCIA,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides="," >
      <if test="vNumanoreg != null" >
        #{vNumanoreg,jdbcType=VARCHAR},
      </if>
      <if test="nNumdep != null" >
        #{nNumdep,jdbcType=DECIMAL},
      </if>
      <if test="nNumtipodoc != null" >
        #{nNumtipodoc,jdbcType=DECIMAL},
      </if>
      <if test="vNumreg != null" >
        #{vNumreg,jdbcType=VARCHAR},
      </if>
      <if test="nTippriori != null" >
        #{nTippriori,jdbcType=DECIMAL},
      </if>
      <if test="dFecemision != null" >
        #{dFecemision,jdbcType=DATE},
      </if>
      <if test="vNumticket != null" >
        #{vNumticket,jdbcType=VARCHAR},
      </if>
      <if test="vNumanoexp != null" >
        #{vNumanoexp,jdbcType=VARCHAR},
      </if>
      <if test="nNumdepexp != null" >
        #{nNumdepexp,jdbcType=DECIMAL},
      </if>
      <if test="vNumexpref != null" >
        #{vNumexpref,jdbcType=VARCHAR},
      </if>
      <if test="vNumanoregref != null" >
        #{vNumanoregref,jdbcType=VARCHAR},
      </if>
      <if test="nNumdepref != null" >
        #{nNumdepref,jdbcType=DECIMAL},
      </if>
      <if test="nNumtipodocref != null" >
        #{nNumtipodocref,jdbcType=DECIMAL},
      </if>
      <if test="vNumregref != null" >
        #{vNumregref,jdbcType=VARCHAR},
      </if>
      <if test="nNumitemref != null" >
        #{nNumitemref,jdbcType=DECIMAL},
      </if>
      <if test="nNumenvioref != null" >
        #{nNumenvioref,jdbcType=DECIMAL},
      </if>
      <if test="vTiporigen != null" >
        #{vTiporigen,jdbcType=VARCHAR},
      </if>
      <if test="vCodentidad != null" >
        #{vCodentidad,jdbcType=VARCHAR},
      </if>
      <if test="nCodcenlab != null" >
        #{nCodcenlab,jdbcType=DECIMAL},
      </if>
      <if test="dFecrecep != null" >
        #{dFecrecep,jdbcType=DATE},
      </if>
      <if test="nTipodoc != null" >
        #{nTipodoc,jdbcType=DECIMAL},
      </if>
      <if test="vNumdoc != null" >
        #{vNumdoc,jdbcType=VARCHAR},
      </if>
      <if test="dFecdoc != null" >
        #{dFecdoc,jdbcType=DATE},
      </if>
      <if test="vNumdocref != null" >
        #{vNumdocref,jdbcType=VARCHAR},
      </if>
      <if test="nNumdepdest != null" >
        #{nNumdepdest,jdbcType=DECIMAL},
      </if>
      <if test="nNumgrupo != null" >
        #{nNumgrupo,jdbcType=DECIMAL},
      </if>
      <if test="vCodtupa != null" >
        #{vCodtupa,jdbcType=VARCHAR},
      </if>
      <if test="vCodaccionante != null" >
        #{vCodaccionante,jdbcType=VARCHAR},
      </if>
      <if test="vCodpersonal != null" >
        #{vCodpersonal,jdbcType=VARCHAR},
      </if>
      <if test="nNumfolios != null" >
        #{nNumfolios,jdbcType=DECIMAL},
      </if>
      <if test="vDesasunto != null" >
        #{vDesasunto,jdbcType=VARCHAR},
      </if>
      <if test="nFlganulado != null" >
        #{nFlganulado,jdbcType=DECIMAL},
      </if>
      <if test="nFlgcorresp != null" >
        #{nFlgcorresp,jdbcType=DECIMAL},
      </if>
      <if test="nFlggenera != null" >
        #{nFlggenera,jdbcType=DECIMAL},
      </if>
      <if test="nFlgenviado != null" >
        #{nFlgenviado,jdbcType=DECIMAL},
      </if>
      <if test="vCodcorte != null" >
        #{vCodcorte,jdbcType=VARCHAR},
      </if>
      <if test="vObservacion != null" >
        #{vObservacion,jdbcType=VARCHAR},
      </if>
      <if test="vDestasas != null" >
        #{vDestasas,jdbcType=VARCHAR},
      </if>
      <if test="vNomusureg != null" >
        #{vNomusureg,jdbcType=VARCHAR},
      </if>
      <if test="dFecreg != null" >
        #{dFecreg,jdbcType=DATE},
      </if>
      <if test="vNomusumod != null" >
        #{vNomusumod,jdbcType=VARCHAR},
      </if>
      <if test="dFecmod != null" >
        #{dFecmod,jdbcType=DATE},
      </if>
      <if test="vFlgproant != null" >
        #{vFlgproant,jdbcType=VARCHAR},
      </if>
      <if test="vNomusuario != null" >
        #{vNomusuario,jdbcType=VARCHAR},
      </if>
      <if test="vCoddireccion != null" >
        #{vCoddireccion,jdbcType=VARCHAR},
      </if>
      <if test="vDirorg != null" >
        #{vDirorg,jdbcType=VARCHAR},
      </if>
      <if test="nFlgtipotra != null" >
        #{nFlgtipotra,jdbcType=DECIMAL},
      </if>
      <if test="vCodperdest != null" >
        #{vCodperdest,jdbcType=VARCHAR},
      </if>
      <if test="nFlgatendido != null" >
        #{nFlgatendido,jdbcType=DECIMAL},
      </if>
      <if test="nFlghistorico != null" >
        #{nFlghistorico,jdbcType=DECIMAL},
      </if>
      <if test="nFlgpendtupa != null" >
        #{nFlgpendtupa,jdbcType=DECIMAL},
      </if>
      <if test="nFlgcongreso != null" >
        #{nFlgcongreso,jdbcType=DECIMAL},
      </if>
      <if test="dFecatendido != null" >
        #{dFecatendido,jdbcType=DATE},
      </if>
      <if test="dFechistorico != null" >
        #{dFechistorico,jdbcType=DATE},
      </if>
      <if test="nNumevioref != null" >
        #{nNumevioref,jdbcType=DECIMAL},
      </if>
      <if test="dFecregula != null" >
        #{dFecregula,jdbcType=DATE},
      </if>
      <if test="vAsuntodetallado != null" >
        #{vAsuntodetallado,jdbcType=VARCHAR},
      </if>
      <if test="vNumhoja != null" >
        #{vNumhoja,jdbcType=VARCHAR},
      </if>
      <if test="vAniohoja != null" >
        #{vAniohoja,jdbcType=DECIMAL},
      </if>
      <if test="vFlgcom != null" >
        #{vFlgcom,jdbcType=VARCHAR},
      </if>
      <if test="vCodcom != null" >
        #{vCodcom,jdbcType=VARCHAR},
      </if>
      <if test="vCodcong != null" >
        #{vCodcong,jdbcType=VARCHAR},
      </if>
      <if test="vNomarch != null" >
        #{vNomarch,jdbcType=VARCHAR},
      </if>
      <if test="vFlgacred != null" >
        #{vFlgacred,jdbcType=VARCHAR},
      </if>
      <if test="vFlgcosuco != null" >
        #{vFlgcosuco,jdbcType=CHAR},
      </if>
      <if test="vFlgasig != null" >
        #{vFlgasig,jdbcType=VARCHAR},
      </if>
      <if test="vDescdoc != null" >
        #{vDescdoc,jdbcType=VARCHAR},
      </if>
      <if test="vFlgusuasig != null" >
        #{vFlgusuasig,jdbcType=VARCHAR},
      </if>
      <if test="vCodper != null" >
        #{vCodper,jdbcType=VARCHAR},
      </if>
      <if test="vTipdocweb != null" >
        #{vTipdocweb,jdbcType=VARCHAR},
      </if>
      <if test="vRegweb != null" >
        #{vRegweb,jdbcType=VARCHAR},
      </if>
      <if test="vFlganexo != null" >
        #{vFlganexo,jdbcType=VARCHAR},
      </if>
      <if test="vNumproley != null" >
        #{vNumproley,jdbcType=VARCHAR},
      </if>
      <if test="vAnoproley != null" >
        #{vAnoproley,jdbcType=VARCHAR},
      </if>
      <if test="nCodtram != null" >
        #{nCodtram,jdbcType=DECIMAL},
      </if>
      <if test="nFlgtrex != null" >
        #{nFlgtrex,jdbcType=DECIMAL},
      </if>
      <if test="vAnocorte != null" >
        #{vAnocorte,jdbcType=VARCHAR},
      </if>
      <if test="nFlgasocia != null" >
        #{nFlgasocia,jdbcType=DECIMAL},
      </if>
    </trim>
  </insert>
  
  
  snfl
  --despues de armar el jasper con los parameter map pasar a richar para q cree la tabla en esquema siit
  --dar formato a correo para solicitante
  --en el ultimo paso insertar tambien en esquema siit en nueva tabla iltbc_soldenvirtual y en otra tabla con dep intendencia
  --validar fechaing<fechaces y que fechaces no sea mas antigua a 5 años
  --bug enter invalid value after input ruc
  
  
  
  
  
MAYO 2016 

cuarto 900

boris 400

+ 0 +












--1.- Dice : Estimado trabajador, el RUC ingresado no existe, favor de validar..Error, Debe Decir: Estimado trabajador, el RUC ingresado debe ser de 11 dígitos, favor de verificar
--2.- A todos campos poner lo siguiente (*) menos a teléfono fijo, croquis y otros documentos, En la parte final de las página poner una leyenda que diga lo siguiente	(*) Datos Obligatorios
--3.- telefono fijo maximo 11 dígitos
--4.- Validar teléfono celular de 09 dígitos
--5.- Validar el ingreso correcto de correo electrónico
--6.- Al dar clic a Salir, que le pregunte lo siguiente: Estimado Trabajador, está seguro de Salir del Aplicativo de Denuncia Virtual?
--7.- poner tooltip al lado de RUC



--0.- Estimado trabajador, favor de presentar su solicitud de inspección en la mesa de partes de la sede central de la SUNAFIL. Estimado trabajador, favor de presentar su solicitud de inspección en la mesa de partes de la Dirección Regional de Trabajo de (Región Seleccionada) .
--1.- Su solicitud ha sido enviada de manera satisfactoria, a continuación se muestra el número de hoja de ruta y solicitud de inspección generados, los cuales le servirán para poder realizar el seguimiento respectivo. Su solicitud ha sido enviada de manera satisfactoria, a continuación se muestra el número de hoja de ruta, el cual le servirá para realizar el seguimiento respectivo en la página Web de la Sunafil,  opción Consulta tu Tramite o a través del siguiente  link  http://appweb.trabajo.gob.pe/si.consultaWebSIIT/inicio
--2.- Cuando le da clic al botón grabar que salgue la imagen de loader
--3.- El color de los asteriscos de obligatorio debe ser de rojo
--4.- En motivo de la denuncia poner como texto al costado de la caja lo siguiente: Máximo 1000 caracteres y validar que esa caja soporte 1000 caracteres





--1.- Recuperar la Razón Social, así no sea competencia e sunafil
--2.- Centro de Trabajo: POR  Localización de Centro de Trabajo
--3.- Tooltip para correo y telefóno
--4.- Su solicitud ha sido enviada de manera satisfactoria generándose la hoja de ruta N° 0000000170-2016-SUNAFIL, la cual le servirá para realizar el seguimiento respectivo en la página Web de la Sunafil a través de la opción Consulta tu Tramite o en el siguiente link: http://appweb.trabajo.gob.pe/si.consultaWebSIIT/
--5.- poner lo mismo en la parte final del correo
--6.- Poner en el reporte e email el nombre de la Intendencia
--7.- Quitar * rojos a campos read only y cambiar por labels
--modificar descripcion de intendencia por vista VST_INTENDEN_REGIONALES cruzar por primer campo con iltbc_unidad de siit

10432511176

------------------------
--OBSERVACIONES SYLVIA--
------------------------

--1.- Poner en Horizontal la impresión de cargos
--2.- Todos los campos en mayuscula
--3.- Ver pk se cayo en el JBOSS
--4.- En la dirección de Acta de Observada y Acta de Archivamiento poner en la dirección el Departamento, Provincia y Distrito.
--5.- Poner el Acta Observada y Acta de Archivamiento el número de Hoja de ruta y eliminar Código Unico de Registro, osea reemplazar.
--6.- No funciona el actualizar(modo subsanar para actualizar demas campos).
--7.-Debe permitir modificar la dependencia, cuando no es TUPA
--8.-Validar que permita la funcionalidada modificar o actualizar sólo cuando exista un cargo de envío, caso contrario le emita el siguiente mensaje: Estimado Usuario, no se puede modificar debido a que se ha generado un cargo de envío.
--9.-En la hoja de ruta, que se pinta en ves del número de RMP, el tipo y número de documento, vamos a conversar con Richard
--10.-la Prioriad es opcional
--11.- Búsqueda por Razón Social en Nuevo Registro - hacer mediante pop up tipo tupa pero validar q busque cuando ingrese al menos 5 letras , ABENGOA O COSAPI
--12.- Cuando es Tupa, Bloquear Tipo y Número de documento
--13.- Cuando Sylvia haga pruebas vamos a correr el SP para que se mueva a la bandeja de archivados
--14.- Validar los requisitos del tupa 53 y 57.

playground
http://aminalhazwani.com/
http://www.bivald.com/
http://tympanus.net/codrops/2015/11/10/interactive-room-display/
http://tympanus.net/codrops/2016/04/13/interactive-3d-mall-map/
http://tympanus.net/codrops/2012/08/08/circle-hover-effects-with-css-transitions/
http://tympanus.net/codrops/2012/06/05/fullscreen-slit-slider-with-jquery-and-css3/
http://tympanus.net/codrops/2016/03/02/creative-svg-letter-animations/

EDITAR LOS CAMPOS TEXTO DE BD DE TUPA ACTUAL Y CONVERTIR TODO A MAYUSCULA
UNION DE DOS CONEXIONES PENDIENTE

--EJECUTAR TODOS LOS DÍAS TREX
begin
  -- Call the procedure
  spr_to_no_presentado;
end;
COMMIT;


ronco motors dirección nicolas arriola 2278 san luis x mercado frutas
magneto 200 5780
magneto 250 aun en preventa
maruja murellani


//consulta original hoja de ruta richin

select * from (
     SELECT * FROM(
        SELECT 
                rc.v_numhoja||' - '||rc.v_aniohoja||'  '||decode(rc.v_tiporigen,'I','INT','E','') as v_hoja,
                td.v_codtipodoc || ' - ' || rc.v_numreg || ' - ' || rc.v_numanoreg || ' - ' || 
		 case when to_char(rd.d_fectramite,'yyyymmdd') > '20100822' then d1.v_coddep else d1.v_coddepant end as v_documento,
                rc.v_desasunto as v_asunto,
                to_char(rd.d_fectramite, 'dd/mm/yyyy hh24:mi:ss') as d_fecemision,
                decode(rc.n_tippriori,'0','NORMAL','1','URGENTE','2','MUY URGENTE') as v_prioridad,
                decode(to_char(rd.n_flgcopia),'0','O','1','C') as n_copia,
                
                case when to_char(rd.d_fectramite,'yyyymmdd') > '20100822' then d1.v_desdep else d1.v_desdepant end as v_desdepori,
                case 
                when d.v_desdep is not null then 
			case when to_char(rd.d_fectramite,'yyyymmdd') > '20100822' then d.v_desdep else d.v_desdepant end
                else e.v_desnombre 
                end
                as v_desdepdest,   
                
                nvl(F_AGRUPA_ACCIONES_NUM(rc.v_numanoreg, rc.n_numdep, rc.n_numtipodoc, rc.v_numreg, rd.n_numitem, rd.n_numenvio),' ') as v_desproveido,
                to_char(rc.n_numfolios) as n_folios,
                
	       UF_DOCUMENTO_ACCION_NOMBRE v_adesproveido,
               UF_DOCUMENTO_ACCION_NOMBRE1 v_adesproveido1,
	 	DECODE ( (SELECT COUNT(*) FROM TDMV_TUPASAP TS WHERE TS.V_NUMANOREG = RC.V_NUMANOREG AND 
		TS.N_NUMDEP = RC.N_NUMDEP AND TS.N_NUMTIPODOC = RC.N_NUMTIPODOC AND TS.V_NUMREG = RC.V_NUMREG), 1, 'S A P', 0, ' ') AS FLGSAP,

                rownum,
                1 as num, DECODE(RC.N_FLGTREX, 0, '', 1, 'OBSERVADO: EL DOCUMENTO TIENE REQUISITOS TUPA INCUMPLIDOS', 2, 'NO PRESENTADO: EL DOCUMENTO SE ENCUENTRA EN ESTADO NO PRESENTADO', '') AS FLGTREX        
                                
        from tdmvc_registro       rc,
             tdmvd_registro       rd,
             tdtbc_tipodoctramite td,
             tdtbc_dependencia    d,
             tdtbc_dependencia    d1,             
             tdtbc_entidad e
        where rc.v_numreg = lpad(#{PV_NUMREG},10,'0')
	      and rc.n_numdep = #{PN_NUMDEP}
                and rc.v_numanoreg = #{PV_NUMANOREG}
                and rc.n_numtipodoc = #{PN_NUMTIPODOC}
                and  rc.v_numanoreg = rd.v_numanoreg
                and rc.n_numdep = rd.n_numdep
                and rc.n_numtipodoc = rd.n_numtipodoc
                and rc.v_numreg = rd.v_numreg
                and td.n_numtipodoc = rc.n_numtipodoc
                and d.n_numdep(+) = rd.n_numdepdest
                and d1.n_numdep(+) = rc.n_numdep
                and e.v_codentidad(+) = rd.v_codentidad        
        order by rd.d_fectramite asc, rd.n_flgcopia 
        
        )
        union
        
        select 
               ' ',
               ' ',
               ' ',
               '',
               ' ',
               ' ',
               ' ',
               ' ',
               ' ',
               ' ',
               UF_DOCUMENTO_ACCION_NOMBRE v_adesproveido,
               UF_DOCUMENTO_ACCION_NOMBRE1 v_adesproveido1,
		' ',
               level,
               999,
	     ''	
        from dual 
        connect by level <![CDATA[ <= ]]> 5)
        order by num asc, to_date(d_fecemision,'dd/mm/yyyy hh24:mi:ss') asc, n_copia
		
		
--boton limpiar HR
--hora por inicio de sesión
--revisar pasaporte y carne de extranjeria

revisar dx tracking serpost
http://webtrack.dhlglobalmail.com/
RX806812018DE
RX806827074DE --llego 07/06

al hacer pase a prod limpiar data de tabla tdtbc_entidad
fya1 mail


//OS NOTES
BL_TARIFA.SP_LISTAR_COMPARADOR_DET(ids);
BE_TARIFA = listaRespuesta.ElementAt(0);
SP PKG_COMPARATIVO.SP_LISTAR_COMPARADOR_DET
field CAVALCANVID
BD VISTA V_COMPARADOR_TARIFA COM, COM.CAVALCANVID


//mine
BL_TARIFA.getListarCabTarifa(BE_DET_TARIFA, ref listEmp)
SP PKG_COMPARATIVO.SP_LISTAR_COMPARADOR
field CAVALCANVID
BD VISTA V_COMPARADOR_TARIFA COM, COM.CAVALCANVID

PREPARAR CAMBIOS EN SCRIPT DE TREX Y DENV(SOLO ESQUEMA TRAMITE, NO DENVIRTUAL) LINEA 1361 notas


--cambios front busqueda y vincular hr en nuevo
--cambios back end busqueda y vincular hr en nuevo
cambios reporte back end consulta en base a nro de corte se vera igual y si es despues del corte por definir

JUNIO
BBVA PRESTAMO 731.01 VENCE 02/06 PAGARE 731.01
BBVA TARJETA. PAGO MINIMO SOLES 2,154.06 TOTAL 5,155.60. 
			  PAGO MINIMO DOLARES 19.01 TOTAL 288.52 VENCE 06/06 PAGARE 2200 SOLES Y 20 DOLARES(70 SOLES)
CUARTO 550

-3001 SIN TOMAR EN CUENTA CUARTO

CASH  +3,356.71

para pase tramite externo PKG_REPORTES.SPR_OBTENER_LISTA

PROCEDURE SPR_OBTENER_LISTA( P_V_NUMHOJA IN tdmvc_registro.v_numhoja%TYPE,
                            P_V_ANIOHOJA       IN   tdmvc_registro.v_aniohoja%TYPE,
                            P_V_TIPORIGEN       IN   tdmvc_registro.v_tiporigen%TYPE,
                                 cursorOut  OUT micursor) AS
  BEGIN
    OPEN cursorOut FOR

    select
    V_HOJA,
    V_DOCUMENTO,
    V_ASUNTO,
    D_FECEMISION,
    V_PRIORIDAD,
    N_COPIA,
    V_DESDEPORI,
    V_DESDEPDEST,
    V_DESPROVEIDO,
    N_FOLIOS,
    V_ADESPROVEIDO,
    V_ADESPROVEIDO1,
    FLGSAP,
    ROWNUM,
    NUM
     from (
     SELECT * FROM(
        SELECT  rc.v_numhoja||' - '||rc.v_aniohoja||
        
        CASE WHEN (
                                (TO_NUMBER(rc.v_numhoja) <= 170 AND TO_NUMBER(rc.v_aniohoja) <= 2016) OR
		         	                  (TO_NUMBER(rc.v_numhoja) > 170 AND TO_NUMBER(rc.v_aniohoja) < 2016)
                   ) THEN ' - '||decode(rc.v_tiporigen,'I','INT','E','EXT')
        ELSE ' ' END       
         as v_hoja,
                case
                when rc.n_numtipodoc='0' and rc.v_tiporigen='E' then
                td1.v_destipodoc|| ' - ' ||rc.v_numdoc  
                else
                td.v_codtipodoc || ' - ' || rc.v_numreg || ' - ' || rc.v_numanoreg || ' - ' || d1.v_coddep
                end  as v_documento,
                rc.v_desasunto as v_asunto,
                to_char(rd.d_fectramite, 'dd/mm/yyyy hh24:mi:ss') as d_fecemision,
                decode(rc.n_tippriori,'0','NORMAL','1','URGENTE','2','MUY URGENTE') as v_prioridad,
                decode(to_char(rd.n_flgcopia),'0','O','1','C') as n_copia,
/*
                d1.v_desdep as v_desdepori,
                case
                when d.v_desdep is not null then d.v_desdep
                else e.v_desnombre
                end
                as v_desdepdest,
*/
                       ----
                       case
                                when (rd.n_numperori is not null)
                                then (case when to_char(rd.d_fectramite,'yyyymmdd') > '20100825'
                                and d1.n_numdep not in ('352','360','359','357','355','354','356','361','363','353',
                                    '362','358','347','351','349','350','348','180','181','322',
                                    '331','317','341','306','320','313','310','311','307','318',
                                    '315','309','314','312','345','343','319','316','308','344')
                                    then d1.v_desdep
                                    when to_char(rd.d_fectramite,'yyyymmdd') > '20110922'
                and d1.n_numdep in ('352','360','359','357','355','354','356','361','363','353',
                                    '362','358','347','351','349','350','348','180','181','322',
                                    '331','317','341','306','320','313','310','311','307','318',
                                    '315','309','314','312','345','343','319','316','308','344') then d1.v_desdep
                       else d1.v_desdepant end|| ' - ' ||p.v_desapepat|| ' ' ||p.v_desapemat || ' ' ||p.v_desnombres)
                       else
                       (case when to_char(rd.d_fectramite,'yyyymmdd') > '20100825'
                       and d1.n_numdep not in ('352','360','359','357','355','354','356','361','363','353',
                                    '362','358','347','351','349','350','348','180','181','322',
                                    '331','317','341','306','320','313','310','311','307','318',
                                    '315','309','314','312','345','343','319','316','308','344')
                       then d1.v_desdep
                             when to_char(rd.d_fectramite,'yyyymmdd') > '20110922'
                and d1.n_numdep in ('352','360','359','357','355','354','356','361','363','353',
                                    '362','358','347','351','349','350','348','180','181','322',
                                    '331','317','341','306','320','313','310','311','307','318',
                                    '315','309','314','312','345','343','319','316','308','344') then d1.v_desdep
                       else d1.v_desdepant end)
                       end
                       as v_desdepori,

                       case
                       when (d.v_desdep is null) then (e.v_desnombre)
                       when (d.v_desdep is not null) and (rd.v_flgasig  = 'N')  then case when to_char(rd.d_fectramite,'yyyymmdd') > '20100825' then d.v_desdep else d.v_desdepant end
                       when (d.v_desdep is not null) and (rd.v_flgasig  is null)  then case when to_char(rd.d_fectramite,'yyyymmdd') > '20100825' then d.v_desdep else d.v_desdepant end
                       when (d.v_desdep is not null) and (rd.v_flgasig  = 'S') and length(rd.n_numperdest)!= 3 then
                                        (case when to_char(rd.d_fectramite,'yyyymmdd') > '20100825'
                                        and d.n_numdep not in ('352','360','359','357','355','354','356','361','363','353',
                                    '362','358','347','351','349','350','348','180','181','322',
                                    '331','317','341','306','320','313','310','311','307','318',
                                    '315','309','314','312','345','343','319','316','308','344')
                                        then d.v_desdep
                                              when to_char(rd.d_fectramite,'yyyymmdd') > '20110922'
                and d.n_numdep in ('352','360','359','357','355','354','356','361','363','353',
                                    '362','358','347','351','349','350','348','180','181','322',
                                    '331','317','341','306','320','313','310','311','307','318',
                                    '315','309','314','312','345','343','319','316','308','344') then d.v_desdep
                                        else d.v_desdepant end || ' - ' ||p1.v_desapepat|| ' ' ||p1.v_desapemat || ' ' ||p1.v_desnombres)

                       else case when to_char(rd.d_fectramite,'yyyymmdd') > '20100825'
                            and d.n_numdep not in ('352','360','359','357','355','354','356','361','363','353',
                                    '362','358','347','351','349','350','348','180','181','322',
                                    '331','317','341','306','320','313','310','311','307','318',
                                    '315','309','314','312','345','343','319','316','308','344') then d.v_desdep
                                 when to_char(rd.d_fectramite,'yyyymmdd') > '20110922'
                and d.n_numdep in ('352','360','359','357','355','354','356','361','363','353',
                                    '362','358','347','351','349','350','348','180','181','322',
                                    '331','317','341','306','320','313','310','311','307','318',
                                    '315','309','314','312','345','343','319','316','308','344') then d.v_desdep
                       else d.v_desdepant end
                       end
                       as v_desdepdest,
                       ----

                nvl(F_AGRUPA_ACCIONES_NUM(rc.v_numanoreg, rc.n_numdep, rc.n_numtipodoc, rc.v_numreg, rd.n_numitem, rd.n_numenvio),' ') as v_desproveido,
                to_char(rc.n_numfolios) as n_folios,

         UF_DOCUMENTO_ACCION_NOMBRE v_adesproveido,
               UF_DOCUMENTO_ACCION_NOMBRE1 v_adesproveido1,
     DECODE ( NVL((SELECT TP.V_FLGSAP FROM TDTBD_TUPA TP WHERE TP.N_NUMGRUPO = RC.N_NUMGRUPO AND
    TP.N_NUMDEP = RC.N_NUMDEPDEST AND TP.V_CODTUPA = RC.V_CODTUPA),'N'), 'S', 'S A P', 'N', ' ') AS FLGSAP,

                rownum,
                1 as num

        from tdmvc_registro       rc,
             tdmvd_registro       rd,
             tdtbc_tipodoctramite td,
             tdtbc_tipodoctramite td1,
             tdtbc_dependencia    d,
             tdtbc_dependencia    d1,
             tdtbc_entidad e
             ----
             ,prtbc_personal p
             ,prtbc_personal p1
             ----
        where rc.v_numhoja = lpad(P_V_NUMHOJA ,10,'0')
                and rc.v_aniohoja = P_V_ANIOHOJA
                and rc.v_tiporigen =P_V_TIPORIGEN
                and  rc.v_numanoreg = rd.v_numanoreg
                and rc.n_numdep = rd.n_numdep
                and rc.n_numtipodoc = rd.n_numtipodoc
                and rc.v_numreg = rd.v_numreg
                and td.n_numtipodoc = rc.n_numtipodoc
                and rc.n_tipodoc=td1.n_numtipodoc(+)
                and d.n_numdep(+) = rd.n_numdepdest
                and d1.n_numdep(+) = rc.n_numdep
                and e.v_codentidad(+) = rd.v_codentidad
                ----
                and to_char(LPAD(rd.n_numperori,8,'0'))=p.v_codpersonal(+)
                and to_char(LPAD(rd.n_numperdest,8,'0'))=p1.v_codpersonal(+)
                ----
        order by rd.d_fectramite asc, rd.n_flgcopia
        )
        union
        select
               ' ',
               ' ',
               ' ',
               '',
               ' ',
               ' ',
               ' ',
               ' ',
               ' ',
               ' ',
               UF_DOCUMENTO_ACCION_NOMBRE v_adesproveido,
               UF_DOCUMENTO_ACCION_NOMBRE1 v_adesproveido1,
    ' ',
               level,
               999
        from dual connect by level<=5
   )

   order by num asc, to_date(d_fecemision,'dd/mm/yyyy hh24:mi:ss') asc, n_copia ;
 END SPR_OBTENER_LISTA;
 
 MANUAL
 
 http://10.1.50.39/si.tramite/
 http://10.1.50.39:8080/si.tramiteext/
 msdelgado ablas
 
 LG G5
 HTC P10
 
 consulta trazabilidad comparar
 hora de cargo
 
 
 
 traza antigua
 /*SELECT rc.v_numhoja || ' - ' || rc.v_aniohoja as "v_hoja",
        case
          when rc.n_numtipodoc = 0 then e.v_desnombre
          else d1.v_desdep
        end as "v_desdepori",             
        case                    
          when rd.v_tipdestino = 'I' AND rd.n_numperdest IS not NULL then 
               to_char(d.v_desdep ||' - '|| p1.v_desapepat ||' '|| p.v_desapemat ||' '|| p1.v_desnombres)
          when rd.v_tipdestino = 'I' AND rd.n_numperdest IS  NULL then  
               d.v_desdep   
          else e.v_desnombre||'('||e.v_direntidad||')'
        end as "v_desdepdest", 
        td.v_codtipodoc || ' - ' || rc.v_numreg || ' - ' || rc.v_numanoreg || ' - ' || d1.v_coddep "v_documento",
        F_AGRUPA_ACCIONES_NUM(rc.v_numanoreg, rc.n_numdep, rc.n_numtipodoc, rc.v_numreg, rd.n_numitem, rd.n_numenvio) v_desproveido,
        to_char(rc.D_FECEMISION, 'dd/mm/yyyy hh24:mi:ss') as "d_fecemision",
        to_char(rd.d_fecrecep, 'dd/mm/yyyy hh24:mi:ss') as "d_fecrecep",
        to_char(rc.d_fecmod, 'dd/mm/yyyy hh24:mi:ss') as "d_fecmod",
        NVL(rc.v_nomarch,'SN') as "v_nomarch",
        rd.n_numperdest as "n_numperdest",
        rd.v_flgasig as "v_flgasig",
        case
          when (d.v_desdep is not null) and (rd.v_flgasig  = 'N')  then  d.v_desdep 
          when (d.v_desdep is not null) and (rd.v_flgasig  is null)  then d.v_desdep 
          when (d.v_desdep is not null) and (rd.v_flgasig  = 'S') and length(rd.n_numperdest)!= 3 then 
               (d.v_desdep || ' - ' ||p1.v_desapepat|| ' ' ||p1.v_desapemat || ' ' ||p1.v_desnombres)
          when (d.v_desdep is null) then (e.v_desnombre)
          else d.v_desdep
        end as "v_desperdepentdes",
        case
          when (rd.n_numperori is not null)  then  
               (d1.v_desdep || ' - ' ||p.v_desapepat|| ' ' ||p.v_desapemat || ' ' ||p.v_desnombres)
          else d1.v_desdep 
        end as "v_desperdepentori",
        rd.n_numperori as "n_numperori",
        rc.v_descdoc,
        (select decode(to_char(count (*)),'0','','1') 
           from tdmvc_registro rc inner join tdmvd_registro rd 
             on rc.v_numanoreg = rd.v_numanoreg
            and rc.n_numdep = rd.n_numdep
            and rc.n_numtipodoc = rd.n_numtipodoc
            and rc.v_numreg = rd.v_numreg 
          where rc.v_numhoja =lpad(#{PARAM_HRNRO},10,'0') 
            and rc.v_aniohoja = #{PARAM_HRANIO} 
            and rc.v_tiporigen =  'E' 
            and rc.v_numanoreg = #{PARAM_CURANIO}
            and rc.v_numreg =lpad(#{PARAM_CURNRO},10,'0')
            and rd.d_fecrecep is not null) as "d_fecrecepcab",
        rc.v_nomusureg,
        rc.n_numdep,
        rc.v_tipdocweb,
        case 
          when substr(rc.v_descdoc,1,1) = 'S' then
            '1'
          when substr(rc.v_descdoc,1,1) = 'D' then
            '2'
          when substr(rc.v_descdoc,1,1) = 'R' then
            '3'
          else
            '0'
        end v_flgdocweb,
        rc.v_flganexo,  
        nvl(
            (case 
               when rd.v_motivoaten is not null then rd.v_motivoaten
               when rd.v_observacion is not null then rd.v_observacion 
               when ts.v_coment is not null then ts.v_coment 
             end),'-')
        as v_motivo
  from tdmvc_registro       rc,
       tdmvd_registro       rd,
       tdtbc_tipodoctramite td,
       tdtbc_dependencia    d,
       tdtbc_dependencia    d1,
       tdtbc_entidad        e,
       prtbc_personal       p,
       prtbc_personal       p1,
       tdmv_tupasap         ts
 where rc.v_numanoreg = rd.v_numanoreg
   and rc.n_numdep = rd.n_numdep
   and rc.n_numtipodoc = rd.n_numtipodoc
   and rc.v_numreg = rd.v_numreg
   and rc.v_numanoreg = ts.v_numanoreg(+)
   and rc.n_numdep = ts.n_numdep(+)
   and rc.n_numtipodoc = ts.n_numtipodoc(+)
   and rc.v_numreg = ts.v_numreg(+)
   and td.n_numtipodoc = rc.n_numtipodoc
   and d.n_numdep(+) = rd.n_numdepdest
   and d1.n_numdep(+) = rd.n_numdepori
   and e.v_codentidad(+) = rd.v_codentidad
   and to_char(LPAD(rd.n_numperori, 8, '0')) = p.v_codpersonal(+)
   and to_char(LPAD(rd.n_numperdest, 8, '0')) = p1.v_codpersonal(+)
   and rc.v_numhoja = lpad(#{PARAM_HRNRO}, 10, '0') 
   and rc.v_aniohoja = #{PARAM_HRANIO} 
   and rc.v_tiporigen = 'E' 
   and rc.v_numanoreg = #{PARAM_CURANIO}
   and rc.v_numreg =lpad(#{PARAM_CURNRO},10,'0')
 order by rc.d_fecemision asc, rd.n_flgcopia*/
 
------------------------------------------------------------------- 
 en prodsuna
 
 hacer count entidad y join entidad y registro inconsistencias
 
 select count(*) from tdtbc_entidad 
 result ::: 677909
 
 --a eliminar
 
 select *--count(tt.v_codentidad) 
 from tdtbc_entidad tt, tdmvc_registro t
 where tt.v_codentidad=t.v_codentidad(+)
 and t.v_numanoreg is null
 
 select *--count(tt.v_codentidad) 
 from tdtbc_entidad tt, tdmvc_registro t
 where tt.v_codentidad=t.v_codentidad(+)
 and t.v_numanoreg is not null
 
 
 select count(*), tt.v_codtipodocid--count(tt.v_codentidad) 
 from tdtbc_entidad tt, tdmvc_registro t
 where tt.v_codentidad=t.v_codentidad(+)
 and t.v_numanoreg is not null
 group by tt.v_codtipodocid
 
 
select count(*) from tdtbc_entidad tt


select count(*) from tdtbc_entidad tt
where tt.v_codtipodocid in ('02')

select count(*) from tdtbc_entidad tt
where tt.v_codtipodocid in ('03')



---anotaciones pase---

SIMINTRA1.SITB_TDOCIDE en esquema ya en bd ya
TDTBC_TRAMITE en esquema ya en bd ya
TDTBC_TIPODOCTRAMITE en esquema ya en bd ya
TDTBC_INTENDENCIA en esquema ya en bd ya
TDTBC_DEPENDENCIA en esquema ya en bd ya
ya GRANT EXECUTE ON SIMINTRA1.P_ACCESO TO TRAMITE; y añadir campo de intendencia
ya tdtbc_grupotupa en esquema ya pero data no
YA migrar info de tabla TDTBD_REQTUPA
ya añadir un registro de grupotupa 19 para 2016?
ya TDTBD_CENTROLAB ya en bd
ya TDMVC_REGISTRO en bd
ya TDMVC_REGISTRO_LOG en bd
ya recompilo package GESTION_DOCUMENTO en bd
ya falta view vst_bandejastrex en bd
ya TDMVC_CORTE en esquema ya
YA View vst_consultastrex en bd
YA falta view vst_direccionestrex en bd
YA fatta view VST_TRAZABILIDADTREX en bd
YA tdbc_dependenciasiit en esquema ya en bd ya
YA falta COMENTAR LINEAS 12 Y 13 DE TRIGGER "TG_I_TDMVC_REGISTRO_BEFORE"	
YA falta PROCEDURE SPR_TO_NO_PRESENTADO para job en bd
YA comentar funcion uf_corte_diario de pkg gestion_documento
YA sp_elimina_documento compilar de pkg gestion_documento
ya SIMINTRA1.PKG_WSRENIEC actualizar en bd r
ya revisar tabla interna SITB_PERSONA alterada YA ESTA


determinar nro de corte y modificar interno clase historico.java y pkg_reportes por nro de corte para interno

select DISTINCT V_NUMHOJA,V_ANIOHOJA from tdmvc_registro t
where n_numdep = 500 AND V_ANIOHOJA=2016 AND T.V_TIPORIGEN='E'
ORDER BY TO_NUMBER(T.V_NUMHOJA) DESC

---end anotaciones pase---



--1 --2 --3 --4 --5 --6 --7 --8 --9
d 10k en 10k
nro corte en producción 20183

SELECT /*+ PARALLEL(TDTBC_ENTIDAD) */ COUNT(*) FROM TDTBC_ENTIDAD  E


DELETE /*+ PARALLEL(TDTBC_ENTIDAD) */ FROM TDTBC_ENTIDAD  E
WHERE NOT EXISTS
 ( 
   SELECT 
     V.V_CODENTIDAD
     FROM 
     (
     select  DISTINCT a.V_CODENTIDAD
     from tdmvc_registro a
     UNION
      select DISTINCT b.V_CODACCIONANTE
     from tdmvc_registro b 
     UNION
      select DISTINCT c.v_Codentidad
     from tdmvD_registro c 
     )
     V
     WHERE V.V_CODENTIDAD = E.v_Codentidad
 )
 AND E.V_CODENTIDAD LIKE '4%'
 AND ROWNUM<=17000; --10K A ELIMINAR
 
 
OBS PROD

UPDATE DE REGISTRO NO AFECTE A D_FECREG
MOSTRAR FECHA ACTUAL AL LADO DE HR EN FORM JSF AFTER INSERT

--deploy prod notes--
app.properties cambiar sistema
resources.properties rutas de generación
web.xml comment log4j
3 mybatis-config change to production enviroment
--

EN TDMVC REGISTRO mapper updateByPrimaryKeySelective
<if test="dFecmod != null" >
        D_FECMOD = SYSDATE,
      </if>
	  
EN TDMVC CORTE mapper insert	  
<insert id="insert" parameterType="pe.gob.sunafil.tramiteext.persistence.model.TdmvcCorte" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri Apr 15 16:36:02 COT 2016.
    -->
    insert into TRAMITE.TDMVC_CORTE (V_CODCORTE, V_ANOCORTE, D_FECCORTE, 
      N_NUMDEPORI, N_CANTIDAD, N_FLGANULADO, 
      V_OBSERVACION, V_NOMUSUREG, D_FECREG, 
      V_NOMUSUMOD, D_FECMOD)
    values (#{vCodcorte,jdbcType=VARCHAR}, #{vAnocorte,jdbcType=VARCHAR}, #{dFeccorte,jdbcType=DATE}, 
      #{nNumdepori,jdbcType=DECIMAL}, #{nCantidad,jdbcType=DECIMAL}, #{nFlganulado,jdbcType=DECIMAL},  
      #{vObservacion,jdbcType=VARCHAR}, #{vNomusureg,jdbcType=VARCHAR}, SYSDATE, 
      #{vNomusumod,jdbcType=VARCHAR}, SYSDATE)
  </insert>	  
  
update 1
--incluir en pase fecha de generación de cargo
--update cargo fecha gen en bd prod
--group by dep dest, order de tramite
	  
update 2
--añadir fecha de generación de cargo
--HORA DE CADA TDMC_REGISTRO EN CARGO
--quitar seleccione de prioridad en modo insert y edit
--abrir asociacion por HR a nivel nacional

update 3
--limitar adjuntos
--menu dinamico

update 4
--cambiar msg limite por "Debe seleccionar un archivo de un tamaño máximo de 1MB"
--cargo solo fecha de generación de cargo y usuario de distribución el generador de cargo no quien imprime, en la fecha superior la fecha de impresion
--validacion fecha a partir del corte > 20183
--fecha de inicio de sesión quitar
--añadir link de cerrar sesión en la parte derecha superior	
--TODA LAS BANDEJAS VALIDAR CON LO SIGUIENTE SI HACEN BUSQUEDA POR RANGO DE FECHAS DEBE SER POR AMBAS (DESDE HASTA)
--verificar , Se queda pegado Historico cargo la consulta
--hacer update de menu historico cargo en bd prodsuna

update 5
--antes de pase descomentar validacion de hoja de ruta unificada
--cambio de asociacion por HR como trazabilidad

update 6
--se quito SAP de HR
--se quito TUPA para dependencias distintas a 500 hasta configurar dependencias destino para regiones [posiblemente nueva tabla intermedia entre grupotupa e intendencia]

update 7
--reporte consolidado
--bandeja de IR [cambio llegar hasta nueva tabla TRAMITE.TDMVD_REGXCORTE]
--gen cargo con IR [cambio llegar hasta nueva tabla TRAMITE.TDMVD_REGXCORTE]



perfil director edita todos los campos de registro
definir asociación o bandeja para asociar o recep hr de provincias?


link de siit 
http://inspecciones.mintra.gob.pe:8080/inspecciones/index.do
449 uandrade numdep
464 mcotera numdep

[27 2015 memorandum 46 ejemplo busq IR]
21779


--new bd

add menu & asign to profile Director, Operador
Intendencia Regional
#{regionalBean.busqueda}

AÑADIR NUEVA TABLA

after that compile invalid objects

pendiente en ultimo recurso separa en dos consultas funciones getRegistrosCargo y updateRegistrosCargo
si le hizo update pero no lo muestra, testear obtener registrosporcargo
falta poner en el reporte en evez de entidad la dependencia origen cuando sea interno pues no se ingresa entidad

----TEST
select t.*, t.rowid from tdmvc_registro t
where t.v_codcorte=21

select d.*, d.rowid from tdmvd_registro d
where d.V_NUMANOREG=2015
  and d.N_NUMDEP=491
  and d.N_NUMTIPODOC=1 
  and d.V_NUMREG='0000000046'
  
SELECT * FROM vst_bandejastrex   T 
WHERE T.V_CODCORTE=21 AND T.V_ANOCORTE=2016


select t.*, t.rowid from tdmvc_registro t
where t.n_numdeprmp is not null



select t.* from vst_bandejastrex t
where t.n_numdeprmp=500 
and t.n_flgtrex=0 
and t.v_anocorte is null
and t.v_codcorte is null
----END TEST

add menu & asign to profile Director
Consolidado
#{reporteBean.consolidado}

--impacto nuevo

para la vista bandejas trex 
	-para E detalle considerar
		filtrar por n_numitem 1
	-para I
		automaticamente los q lleguen hasta nueva tabla pues puede haber mas de 1 destino

*pasos pendientes
--hacer trigger para insertar nueva tabla cuando es E y cuando es I insertar al recepcionar con bandeja IR
--regenerated pues fallara sin los nuevos campos erroneos en cabecera
--modificar consulta de trazabilidad regional
--modificar accion recepcionar por individual
--modificar bandeja de recepcion regional añadir campos fecha y usuario de recepción
--modificar logica de updateRegistrosCargo por updateRegxCorte, se comento contenido provisionalmente
--modificar generacion de cargo
--modificar historico cargo
--modificar bandeja de consultas por cargo
craer script para linear los antiguos cargos con la nueva tabla [TRAMITE.TDMVD_REGXCORTE]

añadir nueva tabla TRAMITE.TDMVD_REGXCORTE

TRIGGER

create or replace trigger "TG_I_REGXCORTE"
after
insert
on tdmvd_registro
for each row
begin
if :new.N_NUMITEM = 1 AND :new.V_TIPORIGEN='E' AND :new.N_NUMTIPODOC=0 THEN
    insert into tdmvd_regxcorte
                (
                 V_NUMANOREG,
                 N_NUMDEP,
                 N_NUMTIPODOC,
                 V_NUMREG,
                 N_NUMITEM,
                 N_NUMENVIO,
                 D_FECRECMP,
                 N_NUMDEPRMP,
                 V_CODCORTE,
                 V_ANOCORTE,
                 V_NOMUSUREG,
                 D_FECREG
                )
                select :new.V_NUMANOREG,
                       :new.N_NUMDEP,
                       :new.N_NUMTIPODOC,
                       :new.V_NUMREG,
                       :new.N_NUMITEM,
                       :new.N_NUMENVIO,
                        null,
                        null,
                        null,
                        null,
                        :new.V_NOMUSUREG,
                        SYSDATE
                       from dual;
END IF;
END;

------------------------------------------------------------------


create or replace view vst_bandejastrex as
select
t.v_numanoreg,
t.n_numdep,
t.n_numtipodoc,
t.v_numreg,
e.v_codtipodocid,
e.v_codentidad,
e.v_desnombre,
t.V_NUMDOC,
t.V_ASUNTODETALLADO,
d.v_desdep,
t.D_FECREG,
t.v_aniohoja,
t.v_numhoja,
t.n_flgtrex,
t.n_codcenlab,
t.n_numfolios,
t.v_descdoc,
e.v_nombres,
e.v_apepat,
e.v_apemat,
t.n_codtram,
t.n_tipodoc,
t.n_numdepdest,
t.v_observacion,
t.n_tippriori,
t.n_numgrupo,
t.v_codtupa,
rxc.V_ANOCORTE,
rxc.V_CODCORTE,
t.v_nomusureg,
tdt.v_destipodoc,
tra.v_destram,
rxc.n_numdeprmp,
rxc.d_fecrecmp,
td.V_NUMANOREG pkd1,
td.N_NUMDEP pkd2,
td.N_NUMTIPODOC pkd3,
td.V_NUMREG pkd4,
td.N_NUMITEM pkd5,
td.N_NUMENVIO pkd6
from tdmvd_registro td
left join tdmvd_regxcorte rxc on td.V_NUMANOREG=rxc.V_NUMANOREG and
                                  td.N_NUMDEP=rxc.N_NUMDEP and
                                  td.N_NUMTIPODOC=rxc.N_NUMTIPODOC and
                                  td.V_NUMREG=rxc.V_NUMREG and
                                  td.N_NUMITEM=rxc.N_NUMITEM and
                                  td.N_NUMENVIO=rxc.N_NUMENVIO and
                                  td.n_numitem=1 and
                                  rxc.n_numdeprmp is null and rxc.d_fecrecmp is null,
tdmvc_registro t
left join tdtbc_tipodoctramite tdt on t.n_tipodoc=tdt.n_numtipodoc
left join tdtbc_tramite tra on t.n_codtram=tra.n_codtram
left join tdtbc_dependencia d on t.n_numdepdest=d.n_numdep
left join tdtbc_entidad e on t.v_codentidad=e.v_codentidad
where t.v_tiporigen='E'
  and td.V_NUMANOREG=t.V_NUMANOREG
  and td.N_NUMDEP=t.N_NUMDEP
  and td.N_NUMTIPODOC=t.N_NUMTIPODOC
  and td.V_NUMREG=t.V_NUMREG
  and t.n_codtram<>8
--ORDER BY   TO_NUMBER(t.V_NUMANOREG) desc, TO_NUMBER(t.v_numreg) desc

UNION

select
t.v_numanoreg,
t.n_numdep,
t.n_numtipodoc,
t.v_numreg,
e.v_codtipodocid,
e.v_codentidad,
d0.v_desdep v_desnombre, --e.v_desnombre,
d1.v_coddep V_NUMDOC,--t.V_NUMDOC,
t.V_ASUNTODETALLADO,
d.v_desdep,
t.D_FECREG,
t.v_aniohoja,
t.v_numhoja,
t.n_flgtrex,
t.n_codcenlab,
t.n_numfolios,
t.v_descdoc,
d0.v_desdep v_nombres, --e.v_nombres,
'-' v_apepat, --e.v_apepat,
'-' v_apemat, --e.v_apemat,
t.n_codtram,
t.n_tipodoc,
td.n_numdepdest,
t.v_observacion,
t.n_tippriori,
t.n_numgrupo,
t.v_codtupa,
rxc.V_ANOCORTE,
rxc.V_CODCORTE,
t.v_nomusureg,
tdt0.v_codtipodoc || ' - ' || t.v_numreg || ' - ' || t.v_numanoreg v_destipodoc, --tdt.v_destipodoc,
tra.v_destram,
rxc.n_numdeprmp,
rxc.d_fecrecmp,
td.V_NUMANOREG pkd1,
td.N_NUMDEP pkd2,
td.N_NUMTIPODOC pkd3,
td.V_NUMREG pkd4,
td.N_NUMITEM pkd5,
td.N_NUMENVIO pkd6
from tdmvd_registro td
left join tdmvd_regxcorte rxc on td.V_NUMANOREG=rxc.V_NUMANOREG and
                                  td.N_NUMDEP=rxc.N_NUMDEP and
                                  td.N_NUMTIPODOC=rxc.N_NUMTIPODOC and
                                  td.V_NUMREG=rxc.V_NUMREG and
                                  td.N_NUMITEM=rxc.N_NUMITEM and
                                  td.N_NUMENVIO=rxc.N_NUMENVIO and
                                  rxc.n_numdeprmp is not null and rxc.d_fecrecmp is not null
left join tdtbc_dependencia d on td.n_numdepdest=d.n_numdep
left join tdtbc_dependencia d1 on td.n_numdepori=d1.n_numdep,
tdmvc_registro t
left join tdtbc_tipodoctramite tdt on t.n_tipodoc=tdt.n_numtipodoc
left join tdtbc_tipodoctramite tdt0 on t.n_numtipodoc=tdt0.n_numtipodoc
left join tdtbc_tramite tra on t.n_codtram=tra.n_codtram
left join tdtbc_dependencia d0 on t.n_numdep=d0.n_numdep
left join tdtbc_entidad e on t.v_codentidad=e.v_codentidad
where t.v_tiporigen in ('I','E') and td.V_TIPORIGEN='I'
  and td.V_NUMANOREG=t.V_NUMANOREG
  and td.N_NUMDEP=t.N_NUMDEP
  and td.N_NUMTIPODOC=t.N_NUMTIPODOC
  and td.V_NUMREG=t.V_NUMREG
--ORDER BY   TO_NUMBER(t.V_NUMANOREG) desc, TO_NUMBER(t.v_numreg) desc;
;


----------

create or replace view vst_consultastrex as
select
t.v_numanoreg,
t.n_numdep,
t.n_numtipodoc,
t.v_numreg,
e.v_codtipodocid,
e.v_codentidad,
NVL(e.v_desnombre, d0.v_desdep) v_desnombre,
t.V_NUMDOC,
t.V_ASUNTODETALLADO,
NVL(d.v_desdep, d1.v_desdep) v_desdep,
t.D_FECREG,
t.v_aniohoja,
t.v_numhoja,
t.n_flgtrex,
t.n_codcenlab,
t.n_numfolios,
t.v_descdoc,
e.v_nombres,
e.v_apepat,
e.v_apemat,
t.n_codtram,
t.n_tipodoc,
t.n_numdepdest,
t.v_observacion,
t.n_tippriori,
t.n_numgrupo,
t.v_codtupa,
rxc.V_ANOCORTE,
rxc.V_CODCORTE,
c.d_feccorte,
to_char(t.D_FECREG,'dd/mm/yyyy') d_fechaformateada,
CASE WHEN t.n_flgtrex=0 THEN 'REGISTRADO' WHEN t.n_flgtrex=1 THEN 'OBSERVADO' WHEN t.n_flgtrex=2 THEN 'NO PRESENTADO' ELSE NULL END n_flgtrexformateado,
tu.v_destupa,
t.v_nomusureg
from tdmvc_registro t
LEFT JOIN tdtbd_tupa tu ON t.n_numgrupo=tu.n_numgrupo and t.n_numdepdest=tu.n_numdep and t.v_codtupa=tu.v_codtupa
LEFT JOIN tdtbc_dependencia d ON t.n_numdepdest=d.n_numdep
left join tdtbc_dependencia d0 on t.n_numdep=d0.n_numdep
LEFT JOIN tdtbc_entidad e ON t.v_codentidad=e.v_codentidad,
tdmvd_registro td
left join tdtbc_dependencia d1 on td.n_numdepdest=d1.n_numdep
left join tdmvd_regxcorte rxc on td.V_NUMANOREG=rxc.V_NUMANOREG and
                                  td.N_NUMDEP=rxc.N_NUMDEP and
                                  td.N_NUMTIPODOC=rxc.N_NUMTIPODOC and
                                  td.V_NUMREG=rxc.V_NUMREG and
                                  td.N_NUMITEM=rxc.N_NUMITEM and
                                  td.N_NUMENVIO=rxc.N_NUMENVIO
LEFT JOIN tdmvc_corte c ON rxc.v_anocorte=c.v_anocorte and rxc.v_codcorte=c.v_codcorte
WHERE
  td.V_NUMANOREG=t.V_NUMANOREG
    and td.N_NUMDEP=t.N_NUMDEP
    and td.N_NUMTIPODOC=t.N_NUMTIPODOC
    and td.V_NUMREG=t.V_NUMREG
ORDER BY T.D_FECREG DESC;


para añadir nuevo usuario de trámite interno añadir registro en dos tablas
select t.*, t.rowid from tdtbc_perxdep t
select t.*, t.rowid from simintra1.sitb_usuxperfil t
where v_codusu IN ('YAQUINO','SVASQUEZ')
YAQUINO	001	014	E	AAAWAsAAFAAAAIXABp

--en editar tambien recuperar la entidad en la variable entidadSeleccionada y sus direcciones en direccionesEntSeleccionada
--en guardar considerar perfil para update sigue como antiguo de entidadSeleccionada y a dirección, if hayDirecciones=true guardar direcion nueva

update 8
--extornar documento para el perfil director siempre y cuando no haya cargo, en caso haya cargo colocar msg recepcionado con cargo en vez de boton extornar
--spr to npr con feriados

update 9
--habilitar edición para el perfil administrador y director

update 10
--habilitar configuración de TUPA en intendencias regionales



--se añadió campo intendencia en [tdtbd_tupa] y se creó el FK
--regenerar MBG de [tdtbd_tupa]
--cambiar dos eventos que setean dependenciaSeleccionada: al enter y en la seleccion de la lista de tupas, enviar como parametro codigo de intendencia y nro de tupa
--activaTupa evento al buscar tupa enter
--selectTupa evento al seleccionar un tupa de la lista de tupas disponibles
-- evento al filtrar un tupa de la lista de tupas disponibles
--RegistrarBean() evento al cargar la lista de tupas disponibles por defecto
--replicar on edit para tupa
--habilitar tipo tupa en regiones de producción

update 11
--bandeja documentos externos creados por STDI, con origen I,E en la cabecera y origen I en el detalle

gd bbva
bridget.berrocal@bbva.com

update 12
--order by por nro de tupa en tabla registrar

icono en tramas

revisar opcion de compra de deuda e interes

--TESTSUNA CON DATA Y OBJETOS DE PRODUCCIÓN AL 19/07/2016 SE ACTUALIZO OBJETOS FALTANTES SEGUN HOJAS DE PASE
--DESASUNA CON DATA Y OBJETOS DE PRODUCCIÓN AL 24/06/2016 PENDIENTE ACTUALIZAR OBJ A PARTIR DE ACTA DE PASE 4 Y CREACIÓN DE LOS MENUS FALTANTES(DOC INTERNOS Y RPT CONSOLIDADO) EN SIMINTRA1 CON SI.SEGURIDAD
PENDIENTE PASAR ESQUEMA SIIT DE ORALOCAL HACIA TESTSUNA Y DESASUNA

select t.*, t.rowid from tdmvc_registro t
where v_numanoreg=2016 and n_numdep=500 and v_anocorte is not null
order by d_fecreg desc

update 13
--enlazar manual de usuario


COMPRA DEUDA

PRESTAMO CONSUMO
TASA INTERES 16.5 EFECTIVA ANUAL
IMPORTE ORIGINAL 19,710.05 CAPITAL PENDIENTE 15,818.43

TARJETA PLATINUM LIMITE 19K DISPONIBLE 10,854.94
DEUDA TOTAL TARJETA SOLES 7,060.80
DEUDA TOTAL TARJETA DOLARES 262.90

TOTAL APROX 15819+8145=23964


actualizar cv en CT y enviar 
http://www.computrabajo.com.pe/ofertas-de-trabajo/oferta-de-trabajo-de-analista-funcional-experiencia-en-rup-obligatorio-en-san-borja-2FE8C227FD81CF1A?utm_source=Email&utm_campaign=auto_cand_alertacargosdiaria&utm_medium=auto_cand_alertacargosdiaria

fly gps sin root


--HOMOLOGACION DE DENUNCIA VIRTUAL EN DESA Y TEST
copiar data de simintra1.sitb_tipomoneda 
añadir dos nuevos campos de tdtbc_intendencia

--tablas con grant to DENVIRTUAL del esquema tramite
tramite.tdtbc_entidad
tramite.tdtbd_centrolab
tramite.tdtbc_tramite
tramite.tdtbc_correlativo
tramite.tdmvc_hojaruta
tramite.tdtbc_intendencia
tramite.tdtbc_dependencia
tramite.tdmvc_registro


--eliminar
select t.*, t.rowid from tdmvc_registro t
where t.v_numhoja='0000030454' and t.v_aniohoja=2016
and V_NUMANOREG=2016 and N_NUMDEP=500 and N_NUMTIPODOC=0 and V_NUMREG='0000026606'

select t.*, t.rowid from tdmvd_registro t
where V_NUMANOREG=2016 and N_NUMDEP=500 and N_NUMTIPODOC=0 and V_NUMREG='0000026606'

select t.*, t.rowid from tdmvd_regxcorte t
where V_NUMANOREG=2016 and N_NUMDEP=500 and N_NUMTIPODOC=0 and V_NUMREG='0000026606'


ORA-02396



pruebas de rest
0000021447 - 2016
0000021448 - 2016
0000021452 - 2016

--consulta cargo pendientes de otro dia
SELECT t.*, t.rowid FROM TDMVD_REGXCORTE t
WHERE 
(N_NUMDEP=500 AND V_CODCORTE IS NULL AND V_CODCORTE IS NULL AND TO_CHAR(D_FECREG,'DDMMYYYY')='15082016')
OR
(N_NUMDEPRMP=500 AND V_CODCORTE IS NULL AND V_CODCORTE IS NULL AND TO_CHAR(D_FECRECMP,'DDMMYYYY')='15082016')


--busqueda de hr por nro y tipo doc para recepcion de docs internos
select t.*, t.rowid
 from tramite.tdmvd_regtramite t
where t.v_numanoreg = '2016'
  and t.n_numdep = 457
  and t.n_numtipodoc = 57
  and t.v_numreg = '0000000480';

-- 2° Eliminar de:
select t.*, t.rowid
 from tramite.tdmvd_registro t
where t.v_numanoreg = '2016'
  and t.n_numdep = 457
  and t.n_numtipodoc = 57
  and t.v_numreg = '0000000480';

--3° Eliminar de:
select t.*, t.rowid
 from tramite.tdmvc_registro t
where t.v_numanoreg = '2016'
  and t.n_numdep = 457
  and t.n_numtipodoc = 57
  and t.v_numreg = '0000000480';
  
  
--4° Eliminar de:
select t.*, t.rowid
 from tramite.Tdmvd_Regreqtupa t
where t.v_numanoreg = '2016'
  and t.n_numdep = 457
  and t.n_numtipodoc = 57
  and t.v_numreg = '0000000480';
  
  
select t.*, t.rowid from tdtbc_tipodoctramite t  
select * from tdtbc_dependencia t  
hoja 64


//si.gestionPersonal
cambiar package domain tramiteext por gestionrrhh
mantenimiento personal
leer archivo dat
no se conectara a siit, trabajar con una sola conexion a tramite actualmente


update 14
--registro manual con campo V_FLGRENIEC
--validar intendencia destino en documentos internos sea igual a intendencia de usuario logueado



bbva tarjeta
202.42 soles

bcp tarjeta
1,183.82 soles


select v_aniohoja anho, v_numhoja hoja, 'MINISTERIO DE TRABAJO Y PROMOCION DEL EMPLEO' origen, 'SUNAFIL-DESPACHO DE SUPERINTENDENTE' destino, v_asuntodetallado asunto, d_fecreg fecha
from tdmvc_registro t
where n_numdepdest=449
and v_numanoreg=2015
and v_codentidad='20131023414'
order by d_fecreg desc



hacer vista personal q incluya nombre_dependencia, cod_intendencia, nombre_intendencia


create or replace view vst_personalrrhh as
select 
p.v_codpersonal, 
p.v_codtipo, 
p.v_desapepat, 
p.v_desapemat, 
p.v_desnombres, 
p.v_codescala, 
p.v_descarniv, 
p.n_numdep, 
p.n_flgactivo, 
p.v_nomusureg, 
p.d_fecreg, 
p.v_nomusumod, 
p.d_fecmod, 
p.v_correoe, 
p.v_codescalaremun, 
p.v_codcargo, 
p.v_flgrestupa, 
p.v_flgalert, 
p.v_flgcong, 
p.v_flgarch, 
p.v_flgbndasig, 
p.v_codtipodocid, 
p.d_fecnac,

d.v_desdep,
i.n_numint,
i.v_desint,
CASE WHEN t.v_desturno is null then 'SIN TURNO' else t.v_desturno end v_desturno
from tdtbc_dependencia d, tdtbc_intendencia i, 
prtbc_personal p
left join rrhhsys.rhmvc_perturno pt
on p.v_codpersonal=pt.v_codpersonal and pt.v_flgact='S'
left join rrhhsys.rhtbc_turno t
on t.n_codturno=pt.n_codturno
where p.n_numdep=d.n_numdep and d.n_numint=i.n_numint;
	  
grant select on tramite.vst_personalrrhh to RRHHSYS;	 


ECHAVEZR 

create or replace view vst_turnopersonalrrhh as
select 
pt.d_fecinicio, 
pt.d_fecfin, t.v_desturno, 
pt.v_flgact, t.v_flgnomarca, 
p.v_codpersonal, pt.n_codperturno, 
CASE WHEN pt.v_flgact='S' THEN 'ACTIVO' ELSE 'INACTIVO' END ESTADO,
pt.n_codturno
from 
rrhhsys.rhtbc_turno t,
rrhhsys.rhmvc_perturno pt,
prtbc_personal p
where
p.v_codpersonal=pt.v_codpersonal and
t.n_codturno=pt.n_codturno;


@regenerated

EN RhmvcPerturnoExample.java

public Criteria andCorrelativoActual() {
      	  StringBuffer sb = new StringBuffer("N_CODPERTURNO in (select max(N_CODPERTURNO) from RRHHSYS.RHMVC_PERTURNO)");    	  
      	  addCriterion(sb.toString());
      	  return (Criteria) this;
      	}
		
public Criteria andMinDatePorPersona(String value) {
        	  StringBuffer sb = new StringBuffer("D_FECINICIO in (select min(D_FECINICIO) from RRHHSYS.RHMVC_PERTURNO where v_codpersonal='"+value+"')");    	  
        	  addCriterion(sb.toString());
        	  return (Criteria) this;
        	}
        
public Criteria andMaxDatePorPersona(String value) {
      	  StringBuffer sb = new StringBuffer("D_FECFIN in (select max(D_FECFIN) from RRHHSYS.RHMVC_PERTURNO where v_codpersonal='"+value+"')");    	  
      	  addCriterion(sb.toString());
      	  return (Criteria) this;
      	}		

EN RhtbdPersonalExample.java
		
public Criteria andCorrelativoPorPersona(String value) {
      	  StringBuffer sb = new StringBuffer("N_CORPER in (select max(N_CORPER) from RRHHSYS.rhtbd_personal where v_codpersonal='"+value+"')");    	  
      	  addCriterion(sb.toString());
      	  return (Criteria) this;
      	}		
		
public Criteria andMinDatePorPersona(String value) {
      	  StringBuffer sb = new StringBuffer("D_FECINI in (select min(D_FECINI) from RRHHSYS.rhtbd_personal where v_codpersonal='"+value+"')");    	  
      	  addCriterion(sb.toString());
      	  return (Criteria) this;
      	}		

En RhmvcMarcacionExample.java		
		
public Criteria andCorrelativoActual() {
        	  StringBuffer sb = new StringBuffer("N_CODMARCACION in (select max(N_CODMARCACION) from RRHHSYS.RHMVC_MARCACION)");    	  
        	  addCriterion(sb.toString());
        	  return (Criteria) this;
        	}		
		
		
create or replace view vst_detpersonalrrhh as
select
pd.v_codpersonal,
d.n_numdep,
d.v_desdep,
i.n_numint,
i.v_desint,
tp.v_codtipo,
tp.v_destipo,
cp.v_codcargo,
cp.v_nomcargo,
ep.v_codescala,
ep.v_nomescala,
pd.v_flgact,
CASE WHEN pd.v_flgact='S' THEN 'ACTIVO' ELSE 'INACTIVO' END ESTADO,
pd.v_flgprin,
CASE WHEN pd.v_flgprin='S' THEN 'ACTIVO' ELSE 'INACTIVO' END ESTADOP,
pd.n_corper,
pd.d_fecini,
pd.d_fecfin
from rrhhsys.rhtbd_personal pd, 
     tdtbc_dependencia d, 
     tdtbc_intendencia i,
     tramite.prtbc_tipopers tp,a
     simintra1.sitb_percargo cp,
     simintra1.sitb_escalaremun ep
where pd.n_numdep=d.n_numdep
      and d.n_numint=i.n_numint
      and tp.v_codtipo=pd.v_codtipo
      and cp.v_codcargo=pd.v_codcargo
      and ep.v_codescala=pd.v_codescala;		


	  
grant select on RRHHSYS.RHMVC_PERTURNO to TRAMITE with grant option;
grant select on RRHHSYS.rhtbc_turno to TRAMITE with grant option;

grant select on rrhhsys.rhmvc_marcacion to TRAMITE with grant option;
grant select on rrhhsys.rhtbc_tipomarcacion to TRAMITE with grant option;
grant select on rrhhsys.rhtbc_origen to TRAMITE with grant option;




create or replace view vst_marcacionrrhh as
select
      i.n_numint,
      i.v_desint,
      p.n_numdep,
      d.v_desdep,
      p.v_codtipodocid,
      p.v_codpersonal,
      p.v_desapepat,
      p.v_desapemat,
      p.v_desnombres,
      p.v_codtipo,
      tp.v_destipo tipopersona,
      m.d_fecha,
      to_char(m.d_fecha,'DD/MM/YYYY') d_fechastr,
      m.n_hora,
      m.n_minuto,
      m.n_segundo,
      m.n_codtipo,
      tm.v_destipo,
      m.n_codorigen,
      tor.v_desorigen,
      m.n_codmarcacion,
      m.v_motjus,
      m.n_codtipjus,
      tj.v_destipjus
from prtbc_personal p, tdtbc_dependencia d, tdtbc_intendencia i, prtbc_tipopers tp, simintra1.sitb_tdocide td,
     rrhhsys.rhmvc_marcacion m, rrhhsys.rhtbc_tipomarcacion tm, rrhhsys.rhtbc_origen tor, rrhhsys.rhtbc_tipojus tj
where p.n_numdep=d.n_numdep
      and d.n_numint=i.n_numint
      and p.v_codtipo=tp.v_codtipo
      and p.v_codtipodocid=td.v_codtdocide
      and p.v_codpersonal=m.v_codpersonal
      and m.n_codtipo=tm.n_codtipo
      and m.n_codorigen=tor.n_codorigen
      and m.n_codtipjus=tj.n_codtipjus(+)
  ORDER BY p.v_codpersonal,m.d_fecha,m.n_hora,m.n_minuto,m.n_segundo;





create or replace function FNC_ASISTIO(vv_codpersonal in VARCHAR2,dd_fecha in date ) return number is
  vn_cont number;
begin
select count(*) INTO vn_cont from rrhhsys.rhmvc_marcacion where v_codpersonal = vv_codpersonal and D_FECHA=dd_fecha;
  return vn_cont;
end 
FNC_ASISTIO;



create or replace function FNC_TARDO(vv_codpersonal in VARCHAR2,dd_fecha in date ) return number is
  vn_cont number;
begin
select count(*) INTO vn_cont from rrhhsys.rhmvc_marcacion
where
v_codpersonal = vv_codpersonal and
D_FECHA=dd_fecha and
N_CODTIPO=1 and
TO_NUMBER(N_HORA||''||LPAD(N_MINUTO||'', 2, '0'))>840;
  return vn_cont;
end
FNC_TARDO;


create or replace function FNC_TARDO_HORA(vv_codpersonal in VARCHAR2,dd_fecha in date ) return VARCHAR2 is
  vn_cont VARCHAR2(10);
begin
select N_HORA||':'||N_MINUTO INTO vn_cont from rrhhsys.rhmvc_marcacion
where
v_codpersonal = vv_codpersonal and
D_FECHA=dd_fecha and
N_CODTIPO=1 and
TO_NUMBER(N_HORA||''||LPAD(N_MINUTO||'', 2, '0'))>840
AND ROWNUM<=1
ORDER BY TO_NUMBER(N_HORA||''||LPAD(N_MINUTO||'', 2, '0')) ASC;
  return vn_cont;
end
FNC_TARDO_HORA;





create or replace function FNC_SALE_TEMPRANO(vv_codpersonal in VARCHAR2,dd_fecha in date ) return number is
  vn_cont number;
begin
select count(*) INTO vn_cont from rrhhsys.rhmvc_marcacion
where
v_codpersonal = vv_codpersonal and
D_FECHA=dd_fecha and
N_CODTIPO=2 and
TO_NUMBER(N_HORA||''||LPAD(N_MINUTO||'', 2, '0'))<1730;
  return vn_cont;
end
FNC_SALE_TEMPRANO;






create or replace function FNC_SALE_TEMPRANO_HORA(vv_codpersonal in VARCHAR2,dd_fecha in date ) return VARCHAR2 is
  vn_cont VARCHAR2(10);
begin
select N_HORA||':'||N_MINUTO INTO vn_cont from rrhhsys.rhmvc_marcacion
where
v_codpersonal = vv_codpersonal and
D_FECHA=dd_fecha and
N_CODTIPO=2 and
TO_NUMBER(N_HORA||''||LPAD(N_MINUTO||'', 2, '0'))<1730
AND ROWNUM<=1
ORDER BY TO_NUMBER(N_HORA||''||LPAD(N_MINUTO||'', 2, '0')) ASC;
  return vn_cont;
end
FNC_SALE_TEMPRANO_HORA;




create or replace function FNC_NRODEP_X_PERSONAL(vv_codpersonal in VARCHAR2) return number is
  vn_cont number;
begin
select count(*) INTO vn_cont from rrhhsys.rhtbd_personal where v_codpersonal = vv_codpersonal and v_flgact='S';

  return vn_cont;
end
FNC_NRODEP_X_PERSONAL;





create or replace function FNC_TIPO_FALTANTE(vv_codpersonal in VARCHAR2,dd_fecha in date ) return VARCHAR2 is
  vn_cont VARCHAR2(7);
begin
select case when n_codtipo=1 then 'SALIDA' else 'ENTRADA' end into vn_cont from rrhhsys.rhmvc_marcacion
where
v_codpersonal = vv_codpersonal and
D_FECHA=dd_fecha
AND ROWNUM<=1
ORDER BY N_HORA ASC;
  return vn_cont;
end
FNC_TIPO_FALTANTE;






http://favicon.ico.amxmex.rok.tv.wokaoproxy.appspot.com/



DETERMINAR SI ES E O S SEGUN LA SIGUIENTE LOGICA:
Expresion, dada una fecha, retorna un entero (1 para Lunes, 2 para Martes, ..., 7 para Domingo):

SELECT 1 + TRUNC (SYSDATE)
  - TRUNC (SYSDATE, 'IW')
  FROM DUAL
  
DONDE SYSDATE SEA SUSTITUIDO POR to_date(<FECHA_MARCACION>,'DDMMYYYY')  

1. PRIMERO OBTENER EL TURNO ACTIVO DE LA PERSONA (SI NO TIENE TURNO ACTIVO NO INSERTAR MARCACION Y AÑADIR A LOG "EL PERSONAL NO TIENE TURNO ACTIVO")

2. LUEGO OBTENER EL rhtbc_turnodia EN BASE AL TURNO Y N_CODTURNODIA(NRO DE DIA DE LA SEMANA DE LA MARCACIÓN LEIDA: VALOR ENTRE 1-7) 
	DE ACUERDO A ESO EVALUAR:(SI NO TIENE rhtbc_turnodia 
	en EN BASE AL TURNO Y N_CODTURNODIA NO INSERTAR MARCACION Y AÑADIR A LOG "EL PERSONAL NO TIENE LA CONFIGURACION DE ASISTENCIA PARA EL DIA [LUNES, MARTES, ETC]...")	

3. EVALUAR A NIVEL DE HORA ENTRADA Y HORA DE SALIDA DE LA CONFIGURACIÓN EXISTENTE EN rhtbc_turnodia PARA DETERMINAR SI GUARDAR TIPO_MARCACION 'E' ó 'S':

	SI rhtbc_turnodia.N_HORAINI ES EN LA MAÑANA
		LA MARCACION ES >=00:00 AM Y <= 12:30 PM(MEDIO DIA) SE ASUMIRA ENTRADA 'E'
	SI rhtbc_turnodia.N_HORAFIN ES EN LA TARDE
		LA MARCACION ES > 12:30 PM(MEDIO DIA) Y <= 23:59 SE ASUMIRA SALIDA 'S'
	
	SI rhtbc_turnodia.N_HORAFIN ES EN LA TARDE
		LA MARCACION ES > 12:30 PM(MEDIO DIA) Y <= 23:59 SE ASUMIRA ENTRADA	'E'
	SI rhtbc_turnodia.N_HORAINI ES EN LA MAÑANA
		LA MARCACION ES >=00:00 AM Y <= 12:30 PM(MEDIO DIA) SE ASUMIRA SALIDA 'S'
	


	
pendientes

--1.- Agrandar el motivo de la justificación
--2.- Cuando hay onomástico, debe permitir el ingreso de un nuevo registro(boton + en personalMarcacion busqueda de personal con autocompletar y un control de fecha, alinsertar que ingrese dos registros E y S)
--3.- Implementar un reporte sin marcaciones(hacer por java mediante apache POI)
--4.- Implementar logica de carga de marcaciones segun los apuntes de ultima reunión(modificación de carga de marcaciones segun casuistica)
--5.- ASIGNAR A ANGELO REPORTE DE MARCACIONES DEL JEFE, PRIMERO Q HEREDE LA N_NUMDEP DEL LOGUEADO Y LUEGO QUE VALIDE SI ES JEFE, SI NO ES JEFE QUE NO MUESTRE DATA Y EMITA UN MSJ UD NO ES JEFE, considerar v_codjefe de tabla dependencia
--6.- TRASLADAR MENU Y ROLES A LA BASE DE DATOS(PRIMERO DEFINIR ROLES: ADMINISTRADOR OGTIC,RRHH RECRUIT, RRHH MARCACION, JEFE DE DEPENDENCIA, TRABAJADOR)
--7.- AÑADIR CONFIG EN SIMINTRA1.P_SEGURIDAD_LISTADOS.SP_LST_PERFILES PARA REPLICAR LOS PERFILES DE LIMA EN PROVINCIAS

on update file revisar TE - D_FECREG





--noviembre
CASH 1,485

BBVA Último día de pago 07/11/2016

Soles	min S/ 348.48	total S/ 1,833.15 PAGARE 1400 SOLES
Dólares min US$ 2.12	total US$ 2.12 PAGARE 8 SOLES


BCP Último día de pago 16/11/2016

soles 1,403.82

----


select DIA_DE_MES.fecha from
(
select to_date('01.11.2016','dd.mm.yyyy')+level-1 fecha
 from dual 
 connect by level <= TO_CHAR(LAST_DAY(to_date('01.11.2016','dd.mm.yyyy')),'DD')
) DIA_DE_MES
WHERE DIA_DE_MES.fecha NOT IN (select to_date(T.D_FECHA,'dd.mm.yyyy') from rhmvc_marcacion t)
order by 1 asc


----

select 
TO_CHAR(DIA_DE_MES.fecha,'MM') MES,
TO_CHAR(DIA_DE_MES.fecha,'YYYY') ANIO,
DIA_DE_MES.fecha, 
p.v_codpersonal, 
FNC_ASISTIO(p.v_codpersonal, DIA_DE_MES.fecha) ASISTIO,
P.V_DESAPEPAT||' '||P.V_DESAPEMAT||' '||P.V_DESNOMBRES NOMBRES,
P.N_NUMDEP,
D.V_DESDEP,
D.N_NUMINT,
I.V_DESINT,
p.v_codtipodocid,
td.v_desabr,
td.v_destdocide 
from
(
select to_date('01.11.2016','dd.mm.yyyy')+level-1 fecha
 from dual 
 connect by level <= TO_CHAR(LAST_DAY(to_date('01.11.2016','dd.mm.yyyy')),'DD')
) DIA_DE_MES, 
prtbc_personal p, 
SIMINTRA1.SITB_FERIADOS F,
TDTBC_DEPENDENCIA D,
TDTBC_INTENDENCIA I,
simintra1.sitb_tdocide td
WHERE 
DIA_DE_MES.fecha NOT IN (select to_date(T.D_FECHA,'dd.mm.yyyy') from rrhhsys.rhmvc_marcacion t)
and p.v_codpersonal in ('44436285','44436286') AND FNC_ASISTIO(p.v_codpersonal, DIA_DE_MES.fecha)=0
AND DIA_DE_MES.fecha=F.D_FECFER(+)
AND F.D_FECFER IS NULL
AND P.N_NUMDEP=D.N_NUMDEP
AND D.N_NUMINT=I.N_NUMINT
and p.v_codtipodocid=td.v_codtdocide
order by p.v_codpersonal asc,DIA_DE_MES.fecha asc

----


pendientes

--En carga hacer la diferenciación de marcación repetida cuando ya existe en la BD, El mensaje es el siguiente: Marcación ya existe en la Base de Datos
--En el módulo de Marcaciones Ordenar por DNI, Fecha y Hora
--Un Reporte de No Marcaciones (Sólo aplica para CAS, y esto se refiere a que no haya marcado ya sea la entra o salida)
--JUSTIFICACIÓN EN BLOQUE, Orden: Personal, Tipo de Justificación, Check de Justificación en Bloque, tipo de marcacion, FEcha o Rango de Fechas (Fecha Inicio y Fecha Fin) y Motivo CUANDO ES EN BLOQUE POR DEFECTO SALE SETEADO TIPO DE MARCACIÓN ; TODO EL DIA PEDIR UN RANGO DE FECHA
exceptuar los feriados con la tabla feriado de la justificacion(tanto en bloque como por día)
--VALIDAR QUE INGRESE UN CRITERIO DE BUSQUEDA
--llenar años de reportes en forma dinamica
--actualizar war de tramite externo fecha de cargo
--actualizar war de tramas por anio de PGFAxxxx[AÑO][MES][DÍA].ING
--filtrar por fechas en momento de carga para reducir tiempo de espera
--3. En detalle no debería ir TIPO DE PERSONAL, sino RÉGIMEN LABORAL y en las opciones: D. Leg. N° 1057, D. Leg. N° 728
--4. En la opción NUEVO PERSONAL considerar la posibilidad de crear un nuevo CARGO, para que no tenga ir al punto tres (otra ventana).

--job para insertar justificación automatica masiva por intendencia en feriado regional
--copiar motivo al seleccionar en momento de justificar
--mantenimiento de feriado
--en vez de -1 no marca salida en turno día
--tomar en cuenta limite de 60 minutos de tardanza mensual pero a nivel de turno
--poner logica de reporte de salida temprana como tardanza
--modificar xml de reporte de inasistencias considerando tipo de justificacion sin goce
--consultar hora limite de salida
--PONER SYSDATE persistencia EN TABLAS DISTINTAS A RHMVC_MARCACIONES: carga masiva, err carga masiva, feriado, personal, det personal
--GUIARME DE VST_MINUTOSTARDEXMESXPER, VST_RPT_PRE_TARDANZAS PARA MODIFICAR SALIDA TEMPRANA
--en produccion fn_motivo_justificacion, nueva tabla rhtbc_depenrrhh y su registro, vst_marcacionrrhh, aumentar campo adicional en tabla feriado y pasar sp de job y vista de feriados, añadir nuevo campo a rhtbc_tipojus y actualizar funciones, DESACTIVAR TRIGER BEFORE INSERT Y UPDATE DE PRTBC_PERSONAL
--quitar validacion de fecha de inicio de personal
--validar eliminar turnodia
ver reporte de mis asistencias de otra persona para perfil MARCACION
al variar dependencia en modo jefe se resetea las fechas, probar quitando ajax de dependencia con viñeta
instalar a gestion personal a SIAD y a SIRES


formularios impacto: nuevo y editar
--regenerar persistencia tdtbc_tipodoctramite con nuevo campo
--modificar lista de tdtbc_tipodoctramite cuando sea tramite sea distinta a tupa y congresal y poner condicion n_flgcon <> 1
--cuando escoga congresal setear secretaria general(N_NUMDEP 451) como dependencia destino y poner el lista de tdtbc_tipodoctramite condicion n_flgcon = 1
--añadir combos independientes comision y congresista cuando elija documento congresal

--incluir calculo de fecha por fila y totales
--regenerar y guardar nuevos campos de cabecera hv
cambiar a guardar progresivo por página teniendo en cuenta el estado pendiente al insertar en primera pagina y actualizar a Enviado en ultimo paso

preguntas
se debe hacer update al pasar de nuevo por pagina 1?
se debe guardar las tablas directo en bd y ya no solo en cache?

WORKSPACES:
D:\Willy\aplicativos\$_LibroReclamaciones\WS_LIBRORECLAM ES PRODUCCION
D:\Willy\PAPELETA ES MAQUETA PARA ETAPA DE PAPELETA

ESTADOS DE PAPELETA

PENDIENTE DE APROBACIÓN
APROBADA
RECHAZADA

MOTIVO PODRIA USARSE LA TABLA RHTBC_TIPOJUS CON UN NUEVO FLAG QUE INDIQUE QUE ES SOLO PERMISO O ES SOLO LICENCIA


tramas
modulo externo std
denuncia virtual
identificacion de inspectores
gestion de rrrhh




albatros
typhoon
lic4no
warhawk




LOOP
administrador de archivos cheetah
cambiador de voz con efectos
bumeran
facebook
ingress
instagram
linkedin
fb msn
outlook
snapchat
telegram
whatsapp
youcamperfect





NOMBRE BITEL
APN BITEL
pROXY 0.0.0.0
PUERTO 0
USUARIO NO DEF
PASS NO DEF
SERVIDOR NO DEF
MMSC NO DEF
PROXY MMS NO DEF
PUERTO MMS NO DEF
MCC 716
MNC 15
TIPO AUT NINGUNO
TIPO APN DEFAULT
PROTOCOLO APN IPV4
PROTOCOLO APN ROAM IPV4
PORTADOR SIN ESPECIFICAR


CAMBIOS EN TRAMITE Hora

create or replace view vst_bandejastrex as
select
t.v_numanoreg,
t.n_numdep,
t.n_numtipodoc,
t.v_numreg,
e.v_codtipodocid,
e.v_codentidad,
e.v_desnombre,
t.V_NUMDOC,
t.V_ASUNTODETALLADO,
d.v_desdep,
t.D_FECREG,
t.v_aniohoja,
t.v_numhoja,
t.n_flgtrex,
t.n_codcenlab,
t.n_numfolios,
t.v_descdoc,
e.v_nombres,
e.v_apepat,
e.v_apemat,
t.n_codtram,
t.n_tipodoc,
t.n_numdepdest,
t.v_observacion,
t.n_tippriori,
t.n_numgrupo,
t.v_codtupa,
rxc.V_ANOCORTE,
rxc.V_CODCORTE,
t.v_nomusureg,
tdt.v_destipodoc,
tra.v_destram,
rxc.n_numdeprmp,
rxc.d_fecrecmp,
td.V_NUMANOREG pkd1,
td.N_NUMDEP pkd2,
td.N_NUMTIPODOC pkd3,
td.V_NUMREG pkd4,
td.N_NUMITEM pkd5,
td.N_NUMENVIO pkd6,
to_char(t.D_FECREG,'DD/MM/YYYY HH24:MI') DFECREGMASK
from tdmvd_registro td
left join tdmvd_regxcorte rxc on td.V_NUMANOREG=rxc.V_NUMANOREG and
                                  td.N_NUMDEP=rxc.N_NUMDEP and
                                  td.N_NUMTIPODOC=rxc.N_NUMTIPODOC and
                                  td.V_NUMREG=rxc.V_NUMREG and
                                  td.N_NUMITEM=rxc.N_NUMITEM and
                                  td.N_NUMENVIO=rxc.N_NUMENVIO and
                                  td.n_numitem=1 and
                                  rxc.n_numdeprmp is null and rxc.d_fecrecmp is null,
tdmvc_registro t
left join tdtbc_tipodoctramite tdt on t.n_tipodoc=tdt.n_numtipodoc
left join tdtbc_tramite tra on t.n_codtram=tra.n_codtram
left join tdtbc_dependencia d on t.n_numdepdest=d.n_numdep
left join tdtbc_entidad e on t.v_codentidad=e.v_codentidad
where t.v_tiporigen='E'
  and td.V_NUMANOREG=t.V_NUMANOREG
  and td.N_NUMDEP=t.N_NUMDEP
  and td.N_NUMTIPODOC=t.N_NUMTIPODOC
  and td.V_NUMREG=t.V_NUMREG
  and t.n_codtram<>8
--ORDER BY   TO_NUMBER(t.V_NUMANOREG) desc, TO_NUMBER(t.v_numreg) desc

UNION

select
t.v_numanoreg,
t.n_numdep,
t.n_numtipodoc,
t.v_numreg,
e.v_codtipodocid,
e.v_codentidad,
d0.v_desdep v_desnombre, --e.v_desnombre,
d1.v_coddep V_NUMDOC,--t.V_NUMDOC,
t.V_ASUNTODETALLADO,
d.v_desdep,
t.D_FECREG,
t.v_aniohoja,
t.v_numhoja,
t.n_flgtrex,
t.n_codcenlab,
t.n_numfolios,
t.v_descdoc,
d0.v_desdep v_nombres, --e.v_nombres,
'-' v_apepat, --e.v_apepat,
'-' v_apemat, --e.v_apemat,
t.n_codtram,
t.n_tipodoc,
td.n_numdepdest,
t.v_observacion,
t.n_tippriori,
t.n_numgrupo,
t.v_codtupa,
rxc.V_ANOCORTE,
rxc.V_CODCORTE,
t.v_nomusureg,
tdt0.v_codtipodoc || ' - ' || t.v_numreg || ' - ' || t.v_numanoreg v_destipodoc, --tdt.v_destipodoc,
tra.v_destram,
rxc.n_numdeprmp,
rxc.d_fecrecmp,
td.V_NUMANOREG pkd1,
td.N_NUMDEP pkd2,
td.N_NUMTIPODOC pkd3,
td.V_NUMREG pkd4,
td.N_NUMITEM pkd5,
td.N_NUMENVIO pkd6,
to_char(t.D_FECREG,'DD/MM/YYYY HH24:MI') DFECREGMASK
from tdmvd_registro td
left join tdmvd_regxcorte rxc on td.V_NUMANOREG=rxc.V_NUMANOREG and
                                  td.N_NUMDEP=rxc.N_NUMDEP and
                                  td.N_NUMTIPODOC=rxc.N_NUMTIPODOC and
                                  td.V_NUMREG=rxc.V_NUMREG and
                                  td.N_NUMITEM=rxc.N_NUMITEM and
                                  td.N_NUMENVIO=rxc.N_NUMENVIO and
                                  rxc.n_numdeprmp is not null and rxc.d_fecrecmp is not null
left join tdtbc_dependencia d on td.n_numdepdest=d.n_numdep
left join tdtbc_dependencia d1 on td.n_numdepori=d1.n_numdep,
tdmvc_registro t
left join tdtbc_tipodoctramite tdt on t.n_tipodoc=tdt.n_numtipodoc
left join tdtbc_tipodoctramite tdt0 on t.n_numtipodoc=tdt0.n_numtipodoc
left join tdtbc_tramite tra on t.n_codtram=tra.n_codtram
left join tdtbc_dependencia d0 on t.n_numdep=d0.n_numdep
left join tdtbc_entidad e on t.v_codentidad=e.v_codentidad
where t.v_tiporigen in ('I','E') and td.V_TIPORIGEN='I'
  and td.V_NUMANOREG=t.V_NUMANOREG
  and td.N_NUMDEP=t.N_NUMDEP
  and td.N_NUMTIPODOC=t.N_NUMTIPODOC
  and td.V_NUMREG=t.V_NUMREG
--ORDER BY   TO_NUMBER(t.V_NUMANOREG) desc, TO_NUMBER(t.v_numreg) desc;
;




ENERO

bbva
minimo 1,934.70	total	S/ 2,860.04 pagare 1950

bcp
38,40 pagare 38.40

cuarto aun no
550

efectivo
2,191.54

queda 202




select to_date('01012017','DDMMYYYY') + rownum -1 
 from all_objects 
 where rownum <= to_date('10022017','DDMMYYYY')-to_date('01012017','DDMMYYYY')+1 
 
 

select t.v_codpersonal, 
       t.d_fecha, 
       --fn_concat_entrada(t.v_codpersonal,t.d_fecha),
       --fn_concat_salida(t.v_codpersonal,t.d_fecha),
       --fn_sobretiempo(t.v_codpersonal,t.d_fecha),
       'turno' turno,
       'obs' observacion
from rhmvc_marcacion t
where
v_codpersonal='40489176' and
d_fecha >= to_date('01012017', 'DDMMYYYY') AND d_fecha <= to_date('10012017', 'DDMMYYYY')





CREATE OR REPLACE FUNCTION fn_concat_entrada (vv_codpersonal in VARCHAR2,dd_fecha in date)
  RETURN VARCHAR2
IS
  l_text  VARCHAR2(32767) := NULL;
BEGIN
  FOR cur_rec IN (select LPAD(N_HORA||'', 2, '0') || ':' || LPAD(N_MINUTO||'', 2, '0') ENTRADA from rrhhsys.rhmvc_marcacion
where
v_codpersonal = vv_codpersonal and
D_FECHA=dd_fecha and
N_CODTIPO=1) LOOP
    l_text := l_text || ',' || cur_rec.ENTRADA;
  END LOOP;
  RETURN LTRIM(l_text, ',');
END;


CREATE OR REPLACE FUNCTION fn_concat_salida (vv_codpersonal in VARCHAR2,dd_fecha in date)
  RETURN VARCHAR2
IS
  l_text  VARCHAR2(32767) := NULL;
BEGIN
  FOR cur_rec IN (select LPAD(N_HORA||'', 2, '0') || ':' || LPAD(N_MINUTO||'', 2, '0') SALIDA from rrhhsys.rhmvc_marcacion
where
v_codpersonal = vv_codpersonal and
D_FECHA=dd_fecha and
N_CODTIPO=2) LOOP
    l_text := l_text || ',' || cur_rec.SALIDA;
  END LOOP;
  RETURN LTRIM(l_text, ',');
END;

create or replace function fn_turno_x_fecha(vv_codpersonal in VARCHAR2,dd_fecha in date ) return VARCHAR2 is
  vn_cont VARCHAR2(50);
begin
select v_desturno INTO vn_cont 
from 
rrhhsys.rhmvc_perturno pt,
rrhhsys.rhtbc_turno t
where
pt.v_codpersonal=vv_codpersonal and
t.n_codturno=pt.n_codturno and
((dd_fecha>=pt.d_fecinicio and pt.v_flgact='S') or (dd_fecha>=pt.d_fecinicio and dd_fecha<=pt.d_fecfin and pt.v_flgact='N' ))
ORDER BY pt.n_codperturno desc;
  return vn_cont;
end
fn_turno_x_fecha;




create or replace function fn_sobretiempo(vv_codpersonal in VARCHAR2,dd_fecha in date ) return VARCHAR2 
IS
CODTURNO NUMBER(4);
NRODEDIA NUMBER;
HSALIDATDIA NUMBER;
ULTSALIDA NUMBER;
begin
select t.n_codturno INTO CODTURNO 
from 
rrhhsys.rhmvc_perturno pt,
rrhhsys.rhtbc_turno t
where
pt.v_codpersonal=vv_codpersonal and
t.n_codturno=pt.n_codturno and
((dd_fecha>=pt.d_fecinicio and pt.v_flgact='S') or (dd_fecha>=pt.d_fecinicio and dd_fecha<=pt.d_fecfin and pt.v_flgact='N' ))
ORDER BY pt.n_codperturno desc;

SELECT 
		1 + TRUNC (dd_fecha)
		  - TRUNC (dd_fecha, 'IW') INTO NRODEDIA
		  FROM DUAL;
      
select to_number(n_hora||','||LPAD(n_minuto||'', 2, '0')) INTO ULTSALIDA from rrhhsys.rhmvc_marcacion
where
v_codpersonal = vv_codpersonal and
D_FECHA=dd_fecha and
N_CODTIPO=2;      
      
SELECT to_number(td.n_horafin||','||LPAD(td.n_minutofin||'', 2, '0')) into HSALIDATDIA
from 
rrhhsys.rhtbc_turnodia td
where td.n_codturno=CODTURNO and td.n_codturnodia=NRODEDIA;

  return ''||(FLOOR(ULTSALIDA-HSALIDATDIA));
end
fn_sobretiempo;




CREATE OR REPLACE FUNCTION fn_motivo_justificacion (vv_codpersonal in VARCHAR2,dd_fecha in date)
  RETURN VARCHAR2
IS
  l_text  VARCHAR2(32767) := NULL;
BEGIN
  FOR cur_rec IN (select distinct V_MOTJUS MOTIVO from rrhhsys.rhmvc_marcacion
where
v_codpersonal = vv_codpersonal and
D_FECHA=dd_fecha and
N_CODORIGEN=2) LOOP
    l_text := l_text || ',' || cur_rec.MOTIVO;
  END LOOP;
  RETURN LTRIM(l_text, ',');
END;




select '40489176' V_CODPERSONAL, 
       TO_CHAR(DIAS.CURRENT_DIA,'DD/MM/YYYY') CURRENT_DIA, 
       NVL(fn_concat_entrada('40489176',DIAS.CURRENT_DIA),' ') ENTRADAS,
       NVL(fn_concat_salida('40489176',DIAS.CURRENT_DIA),' ') SALIDAS,
       CASE WHEN fn_concat_salida('40489176',DIAS.CURRENT_DIA) IS NOT NULL THEN
       fn_sobretiempo('40489176',DIAS.CURRENT_DIA) ELSE '0' END SOBRETIEMPO,
       NVL(fn_turno_x_fecha('40489176',DIAS.CURRENT_DIA),'SIN TURNO') TURNO,
       NVL(fn_motivo_justificacion('40489176',DIAS.CURRENT_DIA),' ') observacion
from 
(select to_date('01012017','DDMMYYYY') + rownum -1 CURRENT_DIA 
 from all_objects 
 where rownum <= to_date('10022017','DDMMYYYY')-to_date('01012017','DDMMYYYY')+1) DIAS
 WHERE (fn_concat_entrada('40489176',DIAS.CURRENT_DIA) IS NOT NULL OR fn_concat_salida('40489176',DIAS.CURRENT_DIA) IS NOT NULL)
 
 
 
 
insert into rhtbd_personal
 (v_codpersonal, n_corper, n_numdep, v_codcargo, v_codescala, v_codtipo, v_flgprin, v_flgact, d_fecini, d_fecfin, v_codusureg, d_fecreg, v_hostreg, v_codusumod, d_fecmod, v_hostmod, v_numcon, v_anocon)


select t.v_codpersonal, 
1, 
t.n_numdep, 
t.v_codcargo, 
t.v_codescala, 
case when t.v_codtipo='4' then t.v_codtipo else '7' end, 
'S', 
'S', 
null, 
null, 
'RRHHSYS',
sysdate, 
null, 
null,
null, 
NULL, 
NULL,
null
from prtbc_personal t,
tdtbc_dependencia d, tdtbc_intendencia i
where t.n_numdep=d.n_numdep and d.n_numint=i.n_numint



create or replace view vst_feriadorrhh as
select 
f.n_numint, f.v_anio, f.v_codfer, f.d_fecfer, f.v_flgrec, f.v_codusureg, f.d_fecreg, f.v_hostreg, f.v_flgregmar, f.v_motfer, i.v_desint 
from rhtbc_ferxint f, tdtbc_intendencia i
where f.n_numint=i.n_numint
order by d_fecfer,n_numint;










-------------



select V_NUMHOJA||'-'||V_ANIOHOJA HR, V_DESNOMBRE REMITENTE, V_DESDEP DESTINO, D_FECHAFORMATEADA FECHA, N_FLGTREXFORMATEADO ESTADO, V_ASUNTODETALLADO ASUNTO   from vst_consultastrex t
where
V_ASUNTODETALLADO LIKE '%QUEJA%'
 AND
 TO_Date(TO_CHAR(D_FECREG,'DDMMYYYY'),'DDMMYYYY')>=TO_Date('01012017','DDMMYYYY') AND
 TO_Date(TO_CHAR(D_FECREG,'DDMMYYYY'),'DDMMYYYY')<=TO_Date('28022017','DDMMYYYY')
 AND N_NUMTIPODOC=0 AND N_NUMDEP=500
 
 
 
 
 
--PRTBC_PERSONAL(NUEVOS CAMPOS)
--RHTBD_PERSONAL(NUEVOS CAMPOS)
--RHTBD_DESTAQUE(NUEVA TABLA)
--RHTBC_SINDICATO(NUEVA TABLA)
--RHTBD_PERXSINDICATO(NUEVA TABLA)
--SITB_PROFESION(SIMINTRA1)
--RHTBD_PERXPROFESION(NUEVA TABLA)
--SITB_ENTFINANCIERA(SIMINTRA1)
--RHTBD_PERXENTFINANCIERA(NUEVA TABLA)
--SITB_SEGURO(SIMINTRA1)
--RHTBD_PERXSEGURO(NUEVA TABLA)
--SITB_REGPENSIONARIO(SIMINTRA1)
--RHTBD_PERXREGPENSIONARIO(NUEVA TABLA)
--RHTBD_PERDIRECCION(NUEVA TABLA)
--SITB_ZONA(SIMINTRA1)
--SITB_TIPVIA(SIMINTRA1)
--SITB_ESTADOCIVIL(SIMINTRA1)
--SITB_DISTRITO(SIMINTRA1)

--HORA ENTRADA Y SALIDA ORDENADA EN FORMA ASCENDENTE EN LA MISMA FILA
--CUANDO LAS DOS MARCACIONES DEL DIA SEAN JUSTIFICACIONES NO MOSTRAR NI HORA DE SALIDA NI DE ENTRADA
--INCLUIR FALTAS COMO FILAS EN PDF Y EN LA OBSERVACION PONER FALTA
--ULTIMO WHERE DE MIS MARCACIONES CAMBIO:
WHERE (fn_concat_entrada(#{PARAM_NRODOC},DIAS.CURRENT_DIA) IS NOT NULL OR fn_concat_salida(#{PARAM_NRODOC},DIAS.CURRENT_DIA) IS NOT NULL)

create or replace view vst_sindicato as
select ds.n_corpersin,
       ds.v_codpersonal,
       ds.n_codsindic,
       ds.d_fecini,
       ds.d_fecfin,
       ds.v_descargo,
       ds.v_flgact,
       ds.v_codusureg,
       ds.d_fecreg,
       ds.v_hostreg,
       ds.v_codusumod,
       ds.d_fecmod,
       ds.v_hostmod,

       s.v_dessindic
       
  from rhtbd_perxsindicato ds, rhtbc_sindicato s
  where s.n_codsindic=ds.n_codsindic;
  
  
create or replace view vst_profesion as
select dp.n_corperpro,
       dp.v_codpersonal,
       dp.v_codprof,
       dp.v_codusureg,
       dp.d_fecreg,
       dp.v_hostreg,
       dp.v_codusumod,
       dp.d_fecmod,
       dp.v_hostmod,
       
       p.v_desprof, 
       p.n_flgsunmin, 
       p.v_codggprof, 
       p.v_flginei
  from rhtbd_perxprofesion dp, simintra1.sitb_profesion p
  where p.v_codprof=dp.v_codprof;

  
create or replace view vst_entfinanciera as
select de.n_corperentfin,
       de.v_codpersonal,
       de.n_codentfin,
       de.v_numcuenta,
       de.v_codcci,
       de.d_fecini,
       de.d_fecfin,
       de.v_flgact,
       de.v_codusureg,
       de.d_fecreg,
       de.v_hostreg,
       de.v_codusumod,
       de.d_fecmod,
       de.v_hostmod,
       
       e.v_desentfin
  from rhtbd_perxentfinanciera de, simintra1.sitb_entfinanciera e
  where e.n_codentfin=de.n_codentfin;


create or replace view vst_seguro as
select ds.n_corperseg,
       ds.v_codpersonal,
       ds.n_codseguro,
       ds.d_fecini,
       ds.d_fecfin,
       ds.v_flgact,
       ds.v_codusureg,
       ds.d_fecreg,
       ds.v_hostreg,
       ds.v_codusumod,
       ds.d_fecmod,
       ds.v_hostmod,
       
       s.v_desseguro
  from rhtbd_perxseguro ds, simintra1.sitb_seguro s
  where s.n_codseguro=ds.n_codseguro;

create or replace view vst_regpensionario as
select dr.n_corperregpen,
       dr.v_codpersonal,
       dr.n_codregpen,
       dr.d_fecini,
       dr.d_fecfin,
       dr.v_flgact,
       dr.v_codusureg,
       dr.d_fecreg,
       dr.v_hostreg,
       dr.v_codusumod,
       dr.d_fecmod,
       dr.v_hostmod,
       
       r.v_desregpen
  from rhtbd_perxregpensionario dr, simintra1.sitb_regpensionario r
  where r.n_codregpen=dr.n_codregpen;  
  
  
create or replace view vst_direcciones as
select dd.n_corperdir,
       dd.v_codpersonal,
       dd.v_coddep,
       dd.v_codpro,
       dd.v_coddis,
       dd.v_codzon,
       dd.v_deszona,
       dd.v_codtvia,
       dd.v_direccion,
       dd.v_codusureg,
       dd.d_fecreg,
       dd.v_hostreg,
       dd.v_codusumod,
       dd.d_fecmod,
       dd.v_hostmod,

       dep.v_desdep||' / '|| pro.v_despro ||' / '||d.v_desdis v_desdis,

       z.v_deszon,

       t.v_destvia

  from rhtbd_perdireccion dd, simintra1.sitb_distrito d, simintra1.sitb_zona z, simintra1.sitb_tipvia t, simintra1.Sitb_Departamento dep, simintra1.sitb_provincia pro
  where d.v_coddep=dd.v_coddep and d.v_codpro=dd.v_codpro and dd.v_coddis=d.v_coddis
  
        and dep.v_coddep=dd.v_coddep
        
        and pro.v_codpro=dd.v_codpro and pro.v_coddep=dd.v_coddep      
        
        and z.v_codzona=dd.v_codzon
        and t.v_codtvia=dd.v_codtvia;


		
		
		
		
		
		
a)Desarrollo de Aplicativo de Postulaciones CAS Virtual
b)Desarrollo de Aplicativo de Denuncias Virtuales
c)Desarrollo y Mantenimiento de Aplicativo de Trámite Externo
d)Desarrollo y Mantenimiento de Aplicativo Generador de Tramas de Banco de la Nación
e)Desarrollo de Módulo de Bandeja Congresal (Módulo Externo)
f)Desarrolo del Módulo de Marcaciones del Aplicativo de Gestión de RRHH
g)Diseño de Interfaces de Módulo de Papeleta Virtual del Aplicativo de Gestion de RRHH
h)Desarrolo de Aplicativo de Levantamiento de Reserva de Identidad
i)Soporte a los usuarios de Trámite Externo
j)Soporte a los usuarios de Generador de Tramas
k)Desarrollo Móvil
l)Desarrollo de Arquitectura Web
m)Apoyo en pases a producción de aplicativos WEB en servidor JBOSS
n)Apoyo en pases a producción de objetos de base de datos ORACLE
o)Levantamiento de información de nuevos requerimientos
p)Soporte a los usuarios en la elaboración de reportes de base de datos	
	
	
	
	
	
	
--1.- Implementar el cargo del Sindicato a nivel de combo
--2.- Mostrar la Edad del Dependiente
--3.- Validar de manera obligatoria el ingreso de la Fecha Fin de una Resolución
--4.-Mostrar la opción de Destaque sólo cuando el Régimen Laboral es 728
--5.- Incorporar las Direcciones Regionales(se debe añadir un item ficticio en lista de intendencias en duro con value negativo y recuperar las dependencias con flg mtpe en S)
--6.- Incorporar la clasificación, que sólo debe aplicar para el Régimen Laboral 728(generar tabla RHTBC_CLASCAR y regenerar detalle de personal y vista det personal)
--7. Cambiar el nombre del Sindicato SIUT por SUIT


	